"use strict";function insertComment(e,t){for(var r=0;r<t.length;r++)e.data.parent_id===t[r].data.name?t[r].data.replies&&""!==t[r].data.replies?t[r].data.replies.data.children.push(e):t[r].data.replies={data:{children:[e]}}:e.data.name===t[r].data.parent_id?(e.data.replies={data:{children:[t[r]]}},t.splice(r,1),t.push(e)):t[r].data.replies&&""!==t[r].data.replies&&(t[r].data.replies.children=insertComment(e,t[r].data.replies.data.children));return t}var rpApp=angular.module("rpApp",["ngRoute","ngMaterial","ngAnimate","ngSanitize","linkify","angularMoment","RecursionHelper","ng-mfb","rpServices","rpUtilServices","rpImgurUtilServices","rpResourceServices","rpFilters","rpDirectives","rpMediaDirectives","rpControllers","rpPostControllers","rpUserControllers","rpMessageControllers","rpArticleControllers","rpCommentControllers","rpMediaControllers","rpProgressControllers","rpCaptchaControllers","rpSettingsControllers","rpSearchControllers","rpShareControllers","rpSubmitControllers","rpScoreControllers","rpReplyFormControllers","rpDeleteControllers","rpSaveControllers","rpGildControllers","rpEditFormControllers","rpLinkControllers","rpTabsControllers","masonry"]);rpApp.constant("angularMomentConfig",{preprocess:"unix",timezone:"utc"}),rpApp.config(["$routeProvider","$locationProvider",function(e,t){e.when("/submitLink",{templateUrl:"partials/rpSubmitLink"}).when("/submitText",{templateUrl:"partials/rpSubmitText"}).when("/:sub/search",{templateUrl:"partials/rpSearch",controller:"rpSearchCtrl"}).when("/search",{templateUrl:"partials/rpSearch",controller:"rpSearchCtrl"}).when("/settings",{templateUrl:"partials/rpSettings",controller:"rpSettingsCtrl"}).when("/message",{templateUrl:"partials/rpMessage",controller:"rpMessageCtrl"}).when("/message/compose",{templateUrl:"partials/rpMessageCompose",controller:"rpMessageComposeCtrl"}).when("/message/:where",{templateUrl:"partials/rpMessage",controller:"rpMessageCtrl"}).when("/u/:username",{templateUrl:"partials/rpUser",controller:"rpUserCtrl"}).when("/u/:username/:where",{templateUrl:"partials/rpUser",controller:"rpUserCtrl"}).when("/user/:username",{templateUrl:"partials/rpUser",controller:"rpUserCtrl"}).when("/user/:username/:where",{templateUrl:"partials/rpUser",controller:"rpUserCtrl"}).when("/r/:subreddit/comments/:article/:slug/:comment",{templateUrl:"partials/rpArticleCard",controller:"rpArticleCtrl"}).when("/r/:subreddit/comments/:article/:comment",{templateUrl:"partials/rpArticleCard",controller:"rpArticleCtrl"}).when("/r/:subreddit/comments/:article",{templateUrl:"partials/rpArticleCard",controller:"rpArticleCtrl"}).when("/r/:sub/:sort",{templateUrl:"partials/rpPosts",controller:"rpPostsCtrl"}).when("/error/:errorcode",{templateUrl:"partials/rpRouteError"}).when("/error",{templateUrl:"partials/rpRouteError"}).when("/facebookComplete",{templateUrl:"partials/rpFacebookComplete"}).when("/r/:sub",{templateUrl:"partials/rpPosts",controller:"rpPostsCtrl"}).when("/:sort",{templateUrl:"partials/rpPosts",controller:"rpPostsCtrl"}).when("/",{templateUrl:"partials/rpPosts",controller:"rpPostsCtrl"}).otherwise({templateUrl:"partials/rpRouteError"}),t.html5Mode(!0)}]),rpApp.config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("deep-orange").accentPalette("deep-orange",{"default":"500"}),e.theme("indigo").primaryPalette("indigo").accentPalette("indigo",{"default":"500"}),e.theme("blue").primaryPalette("blue").accentPalette("blue",{"default":"500"}),e.theme("red").primaryPalette("red").accentPalette("red",{"default":"500"}),e.theme("purple").primaryPalette("purple").accentPalette("purple",{"default":"500"}),e.theme("pink").primaryPalette("pink").accentPalette("pink",{"default":"500"}),e.theme("green").primaryPalette("green").accentPalette("green",{"default":"500"}),e.alwaysWatchTheme(!0)}]),rpApp.run(["$route","$rootScope","$location",function(e,t,r){var i=r.path;r.path=function(o,s){if(s===!1)var n=e.current,a=t.$on("$locationChangeSuccess",function(){e.current=n,a()});return i.apply(r,[o])}}]),rpApp.run(["$rootScope",function(e){}]);var rpArticleControllers=angular.module("rpArticleControllers",[]);rpArticleControllers.controller("rpArticleTabsCtrl",["$scope","$timeout",function(e,t){e.tabClick=function(r){t(function(){e.parentCtrl.tabClick(r)},350)}}]),rpArticleControllers.controller("rpArticleButtonCtrl",["$scope","$rootScope","$filter","$mdDialog","rpSettingsUtilService","rpLocationUtilService",function(e,t,r,i,o,s){e.showArticle=function(t,n){var a,l,c,u;if(e.post)a=e.isComment?r("rp_name_to_id36")(e.post.data.link_id):e.post.data.id,l=e.post.data.subreddit,c=e.isComment?e.post.data.id:"",u="#"+e.post.data.name;else if(e.message){var p=/^\/r\/([\w]+)\/comments\/([\w]+)\/(?:[\w]+)\/([\w]+)/,d=p.exec(e.message.data.context);d&&(l=d[1],a=d[2],c=d[3]),u="#"+e.message.data.name}if(o.settings.commentsDialog&&!t.ctrlKey)i.show({controller:"rpArticleDialogCtrl",templateUrl:"partials/rpArticleDialog",targetEvent:t,locals:{post:e.isComment?void 0:e.post,article:a,comment:n?c:"",subreddit:l},clickOutsideToClose:!0,escapeToClose:!1});else{var m="",h="/r/"+l+"/comments/"+a;n&&(h+="/"+c+"/",m="context=8"),s(t,h,m,!0,!1)}}}]),rpArticleControllers.controller("rpArticleDialogCtrl",["$scope","$rootScope","$location","$filter","$mdDialog","post","article","comment","subreddit",function(e,t,r,i,o,s,n,a,l,c){e.dialog=!0,e.post=s,e.article=n,e.comment=a,e.subreddit=l,!angular.isUndefined(e.post);var u=e.$on("$locationChangeSuccess",function(){o.hide()});e.$on("destroy",function(){u()})}]),rpArticleControllers.controller("rpArticleCtrl",["$scope","$rootScope","$routeParams","$timeout","$filter","$q","rpCommentsUtilService","rpTitleChangeService","rpPostFilterButtonUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSubscribeButtonUtilService","rpSubredditsUtilService","rpLocationUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpToolbarShadowUtilService","rpIdentityUtilService","rpAuthUtilService","rpSidebarButtonUtilService",function(e,t,r,i,o,s,n,a,l,c,u,p,d,m,h,g,f,v,S,b){function $(t){e.postLoading=!0,n(e.subreddit,e.article,e.sort,e.cid,e.context,function(r,i){r||(e.post=i.data[0].data.children[0],e.postLoading=!1,e.editing=!1,t&&t())})}function w(){e.comments=[],n(e.subreddit,e.article,e.sort,e.cid,e.context,function(r,o){t.$emit("progressComplete"),e.commentsLoading=!1,r||(e.post=e.post||o.data[0].data.children[0],i(angular.noop,0),e.threadLoading=!1,o.data[1].data.children.length>0?e.haveComments=!0:(e.haveComments=!1,e.noMorePosts=!0),e.haveComments&&(S.isAuthenticated?v.getIdentity(function(t){e.identity=t,e.isMine=e.post.data.author===e.identity.name,C(o.data[1].data.children,3)}):C(o.data[1].data.children,3)),"[deleted]"===e.post.data.author.toLowerCase()&&(e.deleted=!0))})}function C(t,r){function o(e,t){for(var r=0;r<e.length;r++){var i=e[r];i.depth=t,n(i,p),i.data.replies&&""!==i.data.replies&&i.data.replies.data.children.length>0&&o(i.data.replies.data.children,t+1),u[p]&&u[p].rendered===!1&&(u[p].rendered=!0,p++)}}function n(e,t){if(u[t]){for(var i=u[t].rootComment,o=0,s=u[t].batchSize;i.data.replies&&""!==i.data.replies&&i.data.replies.data.children.length>0&&s>o;)i=i.data.replies.data.children[0],o++;(void 0===i.data.replies||""===i.data.replies||0===i.data.replies.data.children.length)&&(i.data.replies={data:{children:[]}});var n=JSON.parse(JSON.stringify(e));n.data.replies="",i.data.replies.data.children.push(n),u[t].batchSize++}else{var a=JSON.parse(JSON.stringify(e));a.data.replies="",u[t]={rootComment:a,batchSize:0,rendered:!1}}u[t].batchSize===r&&(u[t].rendered=!0,p++)}function a(t){if(t)for(;h<u.length;h++)l(h);else{for(var r=0;g>r;r++)l(h+r);h+=g,h>=u.length&&(e.showLoadAll=!1,e.noMorePosts=!0)}}function l(e){return d=angular.bind(null,c,e),m=m.then(d)}function c(t){if(u[t]){var r=u[t].rootComment,o=r.depth;if(0===o)i(function(){e.comments.push(r)},0);else{var s=e.comments[e.comments.length-1],n=0;if(void 0!==s){for(;s.data.replies&&""!==s.data.replies&&s.data.replies.data.children.length>0&&o>n;)s=s.data.replies.data.children[s.data.replies.data.children.length-1],n++;(void 0===s.data.replies||""===s.data.replies||0===s.data.replies.data.children.length)&&(s.data.replies={data:{children:[]}}),i(function(){s.data.replies.data.children.push(r)},0)}}return i(angular.noop,0)}}var u=[],p=0;e.comments=[];var d,m=s.when(),h=0,g=3;o(t,0),a(!1),i(function(){e.showLoadAll!==!1&&(e.showLoadAll=!0)},1e3),e.morePosts=function(){a(!1)},e.loadAllComments=function(){e.showLoadAll=!1,a(!0)}}!angular.isUndefined(e.post),angular.isUndefined(e.article)&&(e.article=r.article),angular.isUndefined(e.subreddit)&&(e.subreddit=r.subreddit);var y=/^\w{7}$/;angular.isUndefined(e.comment)?r.comment&&y.test(r.comment)?e.cid=r.comment:e.cid="":e.cid=e.comment,r.context?e.context=r.context:angular.isUndefined(e.cid)?e.context=0:e.context=8,e.sort=r.sort||"confidence",e.isMine=null,e.dialog||(l.hide(),c.hide(),u.hide(),h.hide(),g.hide(),p.show(),f.hide(),b.show(),a.prepTitleChange("r/"+e.subreddit),d.setSubreddit(e.subreddit));var U=e.tabs=[{label:"best",value:"confidence"},{label:"top",value:"top"},{label:"new",value:"new"},{label:"hot",value:"hot"},{label:"controvesial",value:"controversial"},{label:"old",value:"old"},{label:"q&a",value:"qa"}];e.dialog||(t.$emit("rp_tabs_changed",U),t.$emit("rp_tabs_show"));for(var _=0;_<U.length;_++)if(e.sort===U[_].value){e.dialog?e.selectedTab=_:t.$emit("rp_tabs_selected_index_changed",_);break}e.threadLoading=!0,e.commentsLoading=!1,e.post||t.$emit("progressLoading"),w(),e.thisController=this,this.completeReplying=function(t,r){this.isReplying=!1,e.comments.unshift(t.json.data.things[0]),e.haveComments===!1&&(e.haveComments=!0)},this.completeDeleting=function(t){this.isDeleting=!1,e.deleted=!0},this.completeEditing=function(){var e=this;$(function(){e.isEditing=!1})};var k=!1;this.tabClick=function(t){k?(e.sort=t,e.commentsLoading=!0,w()):k=!0};var M=t.$on("rp_tab_click",function(t,r){e.sort=r,e.dialog||m(null,"/r/"+e.subreddit+"/comments/"+e.article,"sort="+e.sort,!1,!1),e.commentsLoading=!0,w()});e.$on("$destroy",function(){M()})}]);var rpCaptchaControllers=angular.module("rpCaptchaControllers",[]);rpCaptchaControllers.controller("rpCaptchaCtrl",["$scope","$rootScope","rpCaptchaUtilService",function(e,t,r){function i(){r.needsCaptcha(function(t,r){t||(e.needsCaptcha=r.needsCaptcha,e.needsCaptcha&&o())})}function o(){e.iden="",e.captcha="",e.showCaptchaProgress=!0,r.newCaptcha(function(t,r){t||(e.iden=r.json.data.iden,e.captchaImage="http://www.reddit.com/captcha/"+e.iden+".png",e.showCaptchaProgress=!1)})}e.needsCaptcha=!1,e.captchaImage="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",i(),e.reloadCaptcha=function(){e.showCaptchaProgress=!0,i()};var s=t.$on("successful_captcha",function(){e.showBadCaptcha=!1,e.needsCaptcha=!1}),n=t.$on("reset_captcha",function(){i()});e.$on("$destroy",function(){s(),n()})}]);var rpCommentControllers=angular.module("rpCommentControllers",[]);rpCommentControllers.controller("rpCommentCtrl",["$scope","$rootScope","$element","$compile","$filter","$timeout","rpMoreChildrenUtilService","rpIdentityUtilService","rpAuthUtilService","rpCommentsUtilService",function(e,t,r,i,o,s,n,a,l,c){function u(t){c(e.comment.data.subreddit,o("rp_name_to_id36")(e.comment.data.link_id),"hot",e.comment.data.id,0,function(r,i){r||(e.comment=i.data[1].data.children[0],e.isEditing=!1,t&&t())})}e.thisController=this,e.isDeleted=e.comment&&void 0!==e.comment.data.author&&void 0!==e.comment.data.body&&"[deleted]"===e.comment.data.author&&"[deleted]"===e.comment.data.body,e.childDepth=e.depth+1,e.isChildrenCollapsed=!1,e.isLoadingMoreChildren=!1,e.isMine=e.identity?e.comment.data.author===e.identity.name:!1,e.isFocussed=e.cid===e.comment.data.id,e.isOp=e.post?e.comment.data.author===e.post.data.author:!1,e.isComment="t1"===e.comment.kind,e.isShowMore="more"===e.comment.kind&&e.comment.data.count>0,e.isContinueThread="more"===e.comment.kind&&0===e.comment.data.count&&e.comment.data.children.length>0,e.currentComment=e.comment,e.hasChildren=function(){return void 0!==e.comment.data.replies&&""!==e.comment.data.replies&&0!==e.comment.data.replies.data.children.length},e.thisController=this,this.completeReplying=function(t,r){this.isReplying=!1,e.comment.data.replies?(e.isChildrenCollapsed===!0&&e.expandChildren(),e.comment.data.replies.data.children.unshift(t.json.data.things[0])):(e.childDepth=e.depth+1,e.comment.data.replies={data:{children:t.json.data.things}},e.hasChildren=!0)},this.completeDeleting=function(t){this.isDeleting=!1,e.isDeleted=!0},this.completeEditing=function(){var e=this;u(function(){e.isEditing=!1})},e.collapseChildren=function(){s(function(){e.isChildrenCollapsed=!0},300)},e.expandChildren=function(){s(function(){e.isChildrenCollapsed=!1},300)},e.showMore=function(){e.isLoadingMoreChildren=!0,e.sort||(e.sort="confidence"),n(e.sort,e.post.data.name,e.comment.data.children.join(","),function(t,r){if(e.isLoadingMoreChildren=!1,t);else if(r.json.data.things.length>0){var i=new Array(0);i[0]=r.json.data.things[0];for(var o=1;o<r.json.data.things.length;o++)i=insertComment(r.json.data.things[o],i),r.json.data.things[o].data.parent_id===e.comment.data.parent_id&&i.push(r.json.data.things[o]);if(e.parent.data&&e.parent.data.replies&&""!==e.parent.data.replies&&e.parent.data.replies.data.children.length>1){for(var s=0;s<e.parent.data.replies.data.children.length&&e.parent.data.replies.data.children[s].data.name!==e.comment.data.name;s++);e.parent.data.replies.data.children.splice.apply(e.parent.data.replies.data.children,[s,1].concat(i))}else e.parent.data.replies={data:{children:i}}}else e.parent.data.replies.data.children.pop()})}}]);var rpControllers=angular.module("rpControllers",[]);rpControllers.controller("rpAppCtrl",["$scope","$rootScope","$timeout","$mdSidenav","$mdMedia","rpTitleChangeService","rpAuthUtilService","rpSettingsUtilService",function(e,t,r,i,o,s,n,a){e.isDocked=!0,t.$on("settings_changed",function(){e.theme=a.settings.theme}),e.dynamicTheme="redTheme";var l=e.$on("handleTitleChange",function(t,r){e.appTitle=s.title});e.setAuthentication=function(t){e.authenticated=t,n.setAuthenticated(t)},e.sidenavIsOpen=function(){return i("left").isOpen()},e.toggleLeft=function(){i("left").toggle()},e.close=function(){i("left").close()},e.isOpenRules=function(){return i("right").isOpen()},e.toggleRules=function(){i("right").toggle()},e.suspendWatchers=function(){t.$emit("rp_suspendable_suspend")},e.restoreWatchers=function(){t.$emit("rp_suspendable_resume")},e.simpleSuspendWatchers=function(){t.$emit("rp_simple_suspendable_suspend")},e.simpleRestoreWatchers=function(){t.$emit("rp_simple_suspendable_restore")};var c=e.$on("$locationChangeSuccess",function(){i("left").isOpen()&&i("left").toggle(),i("right").isOpen()&&i("right").toggle()});e.$on("$destroy",function(){l(),c()})}]),rpControllers.controller("rpIdentitySidenavCtrl",["$scope","rpIdentityUtilService","rpAuthUtilService",function(e,t,r){e.loading=!0,t.getIdentity(function(t){e.identity=t,e.loading=!1})}]),rpControllers.controller("rpLoginSidenavCtrl",["$scope","$location",function(e,t){e.safePath=encodeURIComponent(t.path());var r=e.$on("$locationChangeSuccess",function(){e.safePath=encodeURIComponent(t.path())});e.$on("$destroy",function(){r()})}]),rpControllers.controller("rpSubredditsSidenavCtrl",["$scope","$rootScope","$timeout","$q","$mdSidenav","rpSubredditsUtilService","rpLocationUtilService","$compile",function(e,t,r,i,o,s,n,a){e.subs=[],e.isOpen=!1,e.toggleOpen=function(){r(function(){e.isOpen=!e.isOpen},150)},e.pinnedSubs=[{name:"frontpage",url:"/"},{name:"all",url:"/r/all/"},{name:"random",url:"/r/random/"},{name:"reddupco",url:"/r/reddupco"}];var l=t.$on("subreddits_updated",function(){e.subs=s.subs});e.openSubreddit=function(e,t){r(function(){n(e,t,"",!0,!1)},350)},e.$on("$destroy",function(){l()})}]),rpControllers.controller("rpToastCtrl",["$scope","$rootScope","$mdToast","toastMessage",function(e,t,r,i){e.toastMessage=i,e.closeToast=function(){r.close()}}]),rpControllers.controller("rpToolbarCtrl",["$scope","$rootScope","$log","$element","rpTitleChangeService","rpPostFilterButtonUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpSidebarButtonUtilService","rpToolbarShadowUtilService",function(e,t,r,i,o,s,n,a,l,c,u,p){e.linkTitle=!1,e.isOpen=!1,e.count=0,e.showToolbarShadow=p.showToolbarShadow;var d=/r\/[\w]+/,m=/u\/[\w]+/,h=e.$on("show_toolbar_shadow_change",function(){e.showToolbarShadow=p.showToolbarShadow}),g=e.$on("handleTitleChange",function(t,r){e.toolbarTitle=o.title,e.linkTitle=d.test(o.title)||m.test(o.title)});e.showPostFilter=s.isVisible;var f=t.$on("post_filter_button_visibility",function(){e.showPostFilter=s.isVisible});e.showUserFilter=n.isVisible;var v=t.$on("user_filter_button_visibility",function(){e.showUserFilter=n.isVisible});e.showUserSort=a.isVisible;var S=t.$on("user_sort_button_visibility",function(){e.showUserSort=a.isVisible});e.showSearchFilter=c.isVisible;var b=t.$on("search_filter_button_visibility",function(){e.showSearchFilter=c.isVisible});e.showRules=u.isVisible;var $=t.$on("rules_button_visibility",function(){e.showRules=u.isVisible});e.toggleSearchForm=function(){e.showSearchForm=!e.showSearchForm},e.showSearchForm=l.isVisible;var w=t.$on("search_form_visibility",function(){});e.$on("$destroy",function(){h(),w(),f(),v(),S(),b(),$(),g()})}]),rpControllers.controller("rpSubscribeCtrl",["$scope","$rootScope","rpSubredditsUtilService","rpSubscribeButtonUtilService",function(e,t,r,i){e.subscribed=r.subscribed,e.loadingSubscription=!1,e.toggleSubscription=function(){e.loadingSubscription=!0,r.subscribeCurrent(function(e,t){})},e.showSubscribe=i.isVisible;var o=t.$on("subscribe_visibility",function(){e.showSubscribe=i.isVisible}),s=t.$on("subscription_status_changed",function(t,r){e.loadingSubscription&&(e.loadingSubscription=!1),e.subscribed=r});e.$on("$destroy",function(){s(),o()})}]),rpControllers.controller("rpErrorCtrl",["$scope","$rootScope","$routeParams","rpSubscribeButtonUtilService","rpTitleChangeService",function(e,t,r,i,o){t.$emit("progressComplete"),i.hide(),o.prepTitleChange("oops"),e.errorCode=parseInt(r.errorcode)||404,404===e.errorCode?e.message="Did not find the page you're looking four-oh-four.":403===e.errorCode?e.message="Page is forbidden :/ Maybe you have to message the mods for permission.":e.message="Oops an error occurred."}]),rpControllers.controller("rpSidebarCtrl",["$scope","$rootScope","rpSubredditsUtilService",function(e,t,r){e.about=r.about.data;var i=t.$on("subreddits_about_updated",function(){e.about=r.about.data});e.$on("$destroy",function(){i()})}]),rpControllers.controller("rpFormattingCtrl",["$scope",function(e){e.formattingIsOpen=!1,e.toggleFormatting=function(t){e.formattingIsOpen=!e.formattingIsOpen}}]);var rpDeleteControllers=angular.module("rpDeleteControllers",[]);rpDeleteControllers.controller("rpDeleteButtonCtrl",["$scope",function(e){e.parentCtrl.isDeleting=!1,e.toggleDeleting=function(t){e.parentCtrl.isDeleting=!e.parentCtrl.isDeleting}}]),rpDeleteControllers.controller("rpDeleteFormCtrl",["$scope","rpDeleteUtilService",function(e,t){e.isDeleteInProgress=!1,e.submit=function(){e.isDeleteInProgress=!0,t(e.redditId,function(t,r){e.isDeleteInProgress=!1,t||e.parentCtrl.completeDeleting(e.redditId)})}}]);var rpEditFormControllers=angular.module("rpEditFormControllers",[]);rpEditFormControllers.controller("rpEditButtonCtrl",["$scope",function(e){e.parentCtrl.isEditing=!1,e.toggleEditing=function(){e.parentCtrl.isEditing=!e.parentCtrl.isEditing}}]),rpEditFormControllers.controller("rpEditFormCtrl",["$scope","rpEditUtilService",function(e,t){e.submit=function(){e.inputIsDisabled=!0,e.isSubmitting=!0,t(e.editText,e.redditId,function(t,r){t||e.parentCtrl.completeEditing()})}}]);var rpFilters=angular.module("rpFilters",[]);rpFilters.filter("rp_open_link_new_window",[function(){return function(e){return e?e.replace(/&lt;a/g,'&lt;a target="_blank"'):void 0}}]),rpFilters.filter("rp_youtube_time_to_seconds",[function(){return function(e){var t=/^(?:([\d]+)h)?(?:([\d]+)m)?(?:([\d]+)s)?$/i,r=t.exec(e);if(r){var i=parseInt(r[1])||0,o=parseInt(r[2])||0,s=parseInt(r[3])||0;return 60*i*60+60*o+s}return 0}}]),rpFilters.filter("rp_hijack_reddit_link",[function(){return function(e){var t=/^(?:https?:\/\/)?(?:www\.)?(?:np\.)?(?:(?:reddit\.com)|(\/?r\/)|(\/?u\/)){1,2}([\S]+)?$/i,r=t.test(e);if(r){for(var i=t.exec(e),o="",s=1;s<i.length;s++)void 0!==i[s]&&(o+=i[s]);return o}return e}}]),rpFilters.filter("rp_link_id",[function(){return function(e){if(e){var t=/^\/r\/(?:[\w]+)\/comments\/([\w]+)/i,r=t.exec(e);return r[1]}return 0}}]),rpFilters.filter("rp_is_comment",[function(){return function(e){return"t1_"===e.substr(0,3)}}]),rpFilters.filter("rp_name_to_id36",[function(){return function(e){return e.substr(3)}}]),rpFilters.filter("rp_load_comment_media",[function(){return function(e){return e.replace(/<a/g,'<a class="rp-comment-media"')}}]),rpFilters.filter("rp_open_in_tab",[function(){return function(e){return e.replace(/<a/g,'<a target="_blank"')}}]),rpFilters.filter("rp_clean_title",["$log",function(e){return function(e){return e&&(e=e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/gi," ")),e}}]),rpFilters.filter("rp_unescape_embed",["$sce",function(e){return function(t){if("undefined"!=typeof t&&""!==t){var r=angular.element("<div>"+t+"</div>").text();return e.trustAsHtml(r)}}}]),rpFilters.filter("rp_unescape_html",["$sce",function(e){return function(t){return angular.element("<div>"+e.trustAsHtml(t)+"</div>").text()}}]),rpFilters.filter("rp_trusted",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]),rpFilters.filter("rp_media_type",[function(){return function(e){var t=/^https?:\/\/(?:i\.|m\.|edge\.|www\.)*imgur\.com\/(?:r\/[\w]+\/)*(?!gallery)(?!removalrequest)(?!random)(?!memegen)([\w]{5,7}(?:[&,][\w]{5,7})*)(?:#\d+)?[sbtmlh]?(\.(?:jpe?g|gif|png|gifv|webm))?(\?.*)?$/i,r=/^https?:\/\/(?:www\.)?(?:i\.|m\.)?imgur\.com\/(?:a|gallery)\/([\w]+)(\..+)?(?:\/)?(?:#?\w*)?(?:\?\_[\w]+\=[\w]+)?$/i,i=/^https?:\/\/(?:www\.|m\.)?youtube\.com\/watch\?.*v=([\w\-]+)/i,o=/^https?:\/\/(?:www\.)?youtu\.be\/([\w\-]+)/i,s=/^https?:\/\/(?:mobile\.)?twitter\.com\/(?:#!\/)?[\w]+\/status(?:es)?\/([\d]+)/i,n=/^https?:\/\/(?:[\w]+.)?gfycat\.com\/(\w+)(?:\.gif)?/i,a=/^http:\/\/(?:www\.)?giphy\.com\/gifs\/(.*?)(\/html5)?$/i,l=/^http:\/\/(?:www\.)?(?:i\.)?giphy\.com\/([\w]+)(?:.gif)?/i,c=/^https?:\/\/(?:www\.)?(?:media[0-9]?\.)?(?:i\.)?giphy\.com\/(?:media\/)?([\w]+)(?:.gif)?/i;return t.test(e)?"imgur":r.test(e)?"imgurAlbum":i.test(e)||o.test(e)?"youtube":s.test(e)?"twitter":n.test(e)?"gfycat":a.test(e)||l.test(e)||c.test(e)?"giphy":null}}]);var rpGildControllers=angular.module("rpGildControllers",[]);rpGildControllers.controller("rpGildButtonCtrl",["$scope","rpGildUtilService","rpAuthUtilService","rpToastUtilService",function(e,t,r,i){e.gild=function(){r.isAuthenticated?t(e.redditId,function(t,r){t||e.gilded++}):i("You've got to log in to gild posts")}}]);var rpImgurUtilServices=angular.module("rpImgurUtilServices",[]);rpImgurUtilServices.factory("rpImgurPreloaderUtilService",["$q","$rootScope",function(e,t){function r(t){this.imageLocations=t,this.imageCount=this.imageLocations.length,this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.state=this.states.PENDING,this.deferred=e.defer(),this.promise=this.deferred.promise}return r.preloadImages=function(e){var t=new r(e);return t.load()},r.prototype={constructor:r,isInitiated:function(){return this.state!==this.states.PENDING},isRejected:function(){return this.state===this.states.REJECTED},isResolved:function(){return this.state===this.states.RESOLVED},load:function(){if(this.isInitiated())return this.promise;this.state=this.states.LOADING;for(var e=0;e<this.imageCount;e++)this.loadImageLocation(this.imageLocations[e]);return this.promise},handleImageError:function(e){this.errorCount++,this.isRejected()||(this.state=this.states.REJECTED,this.deferred.reject(e))},handleImageLoad:function(e){this.loadCount++,this.isRejected()||(this.deferred.notify({percent:Math.ceil(this.loadCount/this.imageCount*100),imageLocation:e}),this.loadCount===this.imageCount&&(this.state=this.states.RESOLVED,this.deferred.resolve(this.imageLocations)))},loadImageLocation:function(e){var r=this,i=$(new Image).load(function(e){t.$apply(function(){r.handleImageLoad(e.target.src),r=i=e=null})}).error(function(e){t.$apply(function(){r.handleImageError(e.target.src),r=i=e=null})}).prop("src",e)}},r}]);var rpLinkControllers=angular.module("rpLinkControllers",[]);rpLinkControllers.controller("rpLinkCtrl",["$scope","$filter","$mdDialog","rpLocationUtilService",function(e,t,r,i){e.isComment=t("rp_is_comment")(e.post.data.name),e.isMine=e.identity?e.post.data.author===e.identity.name:!1,e.thisController=this,this.completeDeleting=function(t){e.parentCtrl.completeDeleting(t)},this.completeReplying=function(t){e.postComment=t.json.data.things[0],e.post.data.num_comments++}}]);var rpMediaControllers=angular.module("rpMediaControllers",[]);rpMediaControllers.controller("rpMediaCtrl",["$scope","$timeout","rpSettingsUtilService",function(e,t,r){e.post&&(e.post.data.title.toLowerCase().indexOf("nsfw")>0&&(e.showWarning=!0,e.warningText="nsfw"),e.post.data.title.toLowerCase().indexOf("nsfl")>0&&(e.showWarning=!0,e.warningText="nsfl"),e.post.data.title.toLowerCase().indexOf("gore")>0&&(e.showWarning=!0,e.warningText="gore"),!e.warningText&&e.post.data.link_flair_text&&(e.warningText=e.post.data.link_flair_text),e.post.data.over_18&&(e.showWarning=!0,e.showWarning=r.settings.over18,e.warningText||(e.warningText="over 18"))),e.showMedia=function(){e.showWarning=!1}}]),rpMediaControllers.controller("rpMediaDefaultCtrl",["$scope","$timeout",function(e,t){".jpg"===e.url.substr(e.url.length-4)||".jpeg"===e.url.substr(e.url.length-5)||".png"===e.url.substr(e.url.length-4)||".bmp"===e.url.substr(e.url.length-4)?(e.playable=!1,e.imageUrl=e.url):".gif"===e.url.substr(e.url.length-4)||e.url.length-5===".gifv"?(e.defaultType="gif",e.gifUrl=e.url,e.playable=!0):".webm"===e.url.substr(e.url.length-5)?(e.defaultType="video",e.webmUrl=e.url,e.playable=!0):".mp4"===e.url.substr(e.url.length-4)?(e.defaultType="video",e.mp4Url=e.url,e.playable=!0):e.post&&(e.post.data.media?"video"===e.post.data.media.oembed.type&&(e.defaultType="embed",e.playable=!0):e.post.data.thumbnail&&(e.playable=!1,e.imageUrl=e.post.data.thumbnail)),e.playable&&e.post&&e.post.data.thumbnail&&(e.thumbnailUrl=e.post.data.thumbnail),e.showPlayable=!1,e.show=function(){e.showPlayable=!0},e.hide=function(){e.showPlayable=!1}}]),rpMediaControllers.controller("rpMediaGiphyCtrl",["$scope",function(e){var t,r=/^http:\/\/(?:www\.)?giphy\.com\/gifs\/(.*?)(\/html5)?$/i,i=/^http:\/\/(?:www\.)?(?:i\.)?giphy\.com\/([\w]+)(?:.gif)?/i,o=/^https?:\/\/(?:www\.)?(?:media[0-9]?\.)?(?:i\.)?giphy\.com\/(?:media\/)?([\w]+)(?:.gif)?/i;r.test(e.url)?t=r.exec(e.url):i.test(e.url)?t=i.exec(e.url):o.test(e.url)&&(t=o.exec(e.url)),e.giphyType=t[2]?"video":"image",t&&(e.thumbnailUrl="http://media.giphy.com/media/"+t[1]+"/200_s.gif","image"===e.giphyType?e.imageUrl="http://media.giphy.com/media/"+t[1]+"/giphy.gif":"video"===e.giphyType&&(e.videoUrl="http://media.giphy.com/media/"+t[1]+"/giphy.mp4")),e.show=function(){e.showGif=!0},e.hide=function(){e.showGif=!1}}]),rpMediaControllers.controller("rpMediaGfycatCtrl",["$scope",function(e){var t=/(^https?:\/\/[\w]?\.?)?gfycat\.com\/(\w+)(\.gif)?/i,r=t.exec(e.url);r[3]&&".gif"==r[3]?e.gfycatType="image":e.gfycatType="video",e.showGif=!1;var i="https://";r&&(e.dataId=r[2],e.thumbnailUrl="http://thumbs.gfycat.com/"+r[2]+"-poster.jpg","image"===e.gfycatType?e.imageUrl=i+"gfycat.com/"+r[2]+".gif":"video"===e.gfycatType&&(e.zippyVideoUrl="http://zippy.gfycat.com/"+r[2]+".webm",e.fatVideoUrl="http://fat.gfycat.com/"+r[2]+".webm",e.giantVideoUrl="http://giant.gfycat.com/"+r[2]+".webm")),e.show=function(){e.showGif=!0},e.hide=function(){e.showGif=!1}}]),rpMediaControllers.controller("rpMediaTwitterCtrl",["$scope","$sce","rpTweetResourceService",function(e,t,r){e.tweet="";var i=/^https?:\/\/(?:mobile\.)?twitter\.com\/(?:#!\/)?[\w]+\/status(?:es)?\/([\d]+)/i,o=i.exec(e.url);if(o){r.get({id:o[1]},function(r){e.tweet=t.trustAsHtml(r.html)})}}]),rpMediaControllers.controller("rpMediaYoutubeCtrl",["$scope","$sce","$filter",function(e,t,r){var i,o=/^https?:\/\/(?:www\.|m\.)?youtube\.com\/watch\?.*v=([\w\-]+)/i,s=/^https?:\/\/(?:www\.)?youtu\.be\/([\w\-]+)(\?t=[\w]+)?/i,n=/\?t\=[\w+]+/i;if(i=o.exec(e.url),i||(i=s.exec(e.url)),i){e.thumbnailUrl="https://img.youtube.com/vi/"+i[1]+"/default.jpg";var a="http://www.youtube.com/embed/"+i[1]+"?autoplay=1";if(i[2]&&n.test(i[2])){var l=r("rp_youtube_time_to_seconds")(i[2].replace("?t=",""));a+="&start="+l}e.embedUrl=t.trustAsResourceUrl(a)}e.showYoutubeVideo=!1,e.show=function(){e.showYoutubeVideo=!0},e.hide=function(){e.showYoutubeVideo=!1}}]),rpMediaControllers.controller("rpMediaImgurCtrl",["$scope",function(e){var t=/^https?:\/\/(?:i\.|m\.|edge\.|www\.)*imgur\.com\/(?:r\/[\w]+\/)*(?!gallery)(?!removalrequest)(?!random)(?!memegen)([\w]{5,7}(?:[&,][\w]{5,7})*)(?:#\d+)?[sbtmlh]?(\.(?:jpe?g|gif|png|gifv|webm))?(\?.*)?$/i,r=t.exec(e.url),i=r[2]||".jpg";".gif"==i||".gifv"==i||".webm"==i?e.imgurType="video":e.imgurType="image",r&&(e.thumbnailUrl="http://i.imgur.com/"+r[1]+"t.jpg","image"===e.imgurType?e.imageUrl=r[1]?"http://i.imgur.com/"+r[1]+i:e.url:"video"===e.imgurType&&(e.webmUrl="http://i.imgur.com/"+r[1]+".webm",e.mp4Url="http://i.imgur.com/"+r[1]+".mp4")),e.showGif=!1,e.show=function(){e.showGif=!0},e.hide=function(){e.showGif=!1}}]),rpMediaControllers.controller("rpMediaImgurAlbumCtrl",["$scope","$log","$filter","$routeParams","rpImgurAlbumResourceService","rpImgurGalleryResourceService","rpImgurPreloaderUtilService",function(e,t,r,i,o,s,n){function a(){e.currentImageUrl=e.album.data.images[u].link,e.imageDescription=e.album.data.images[u].description,e.imageDescriptionLinky=r("linky")(e.album.data.images[u].description,"_blank"),e.imageTitle=e.album.data.images[u].title,e.currentImage=u+1}function l(e,t){for(var r=0;r<t.length;r++)if(t[r].id==e)return r}function c(e){if(e&&"undefined"!==e){var t=[];e.forEach(function(e,r){t.push(e.link)}),n.preloadImages(t).then(function(e){},function(e){},function(e){})}}var u=0,p="",d=3;e.currentImage=0,e.currentImageUrl="",e.imageDescription="",e.imageTitle="";var m=/^https?:\/\/(?:i\.|m\.)?imgur\.com\/(?:a|gallery)\/([\w]+)(\..+)?(?:\/)?(?:#?\w*)?(?:\?\_[\w]+\=[\w]+)?$/i,h=m.exec(e.url),g=h[1];if(g.indexOf(",")>0){var f=[],v=g.split(",");v.forEach(function(e,t){f.push({link:"http://i.imgur.com/"+e+".jpg"})}),e.album={data:{images_count:v.length,images:f}},a(),c(e.album.data.images.slice(1,d))}else e.url.indexOf("/gallery/")>0?s.get({id:g},function(t){if(t.data.is_album)e.album=t,p&&(u=l(p,e.album.data.images)),a(),c(e.album.data.images.slice(1,d));else{var r=[];r[0]={link:t.data.link},e.album={data:{images_count:1,images:r}},a(),c(e.album.data.images.slice(1,d))}},function(e){t.log("Error retrieving Gallery data, "+g),t.log(e)}):o.get({id:g},function(t){e.album=t,p&&(u=l(p,e.album.data.images)),a(),c(e.album.data.images.slice(1,d))},function(t){var r=[];r[0]={link:"http://i.imgur.com/"+g+".jpg"},e.album={data:{images_count:1,images:r}},a(),c(e.album.data.images.slice(1,d))});e.prev=function(t){e.$emit("album_image_change"),--u<0&&(u=t-1),a()},e.next=function(t){e.$emit("album_image_change"),++u==t&&(u=0),c(e.album.data.images.slice(u+d-1,u+d)),a()}}]);var rpMediaDirectives=angular.module("rpMediaDirectives",[]);rpMediaDirectives.directive("rpMedia",function(){return{restrict:"E",templateUrl:"partials/rpMedia",scope:{url:"=",post:"="},controller:"rpMediaCtrl"}}),rpMediaDirectives.directive("rpMediaImgur",function(){
return{restrict:"E",templateUrl:"partials/rpMediaImgur",controller:"rpMediaImgurCtrl"}}),rpMediaDirectives.directive("rpMediaImgurAlbum",function(){return{restrict:"E",templateUrl:"partials/rpMediaImgurAlbum",controller:"rpMediaImgurAlbumCtrl"}}),rpMediaDirectives.directive("rpMediaYoutube",function(){return{restrict:"E",templateUrl:"partials/rpMediaYoutube",controller:"rpMediaYoutubeCtrl"}}),rpMediaDirectives.directive("rpMediaTwitter",function(){return{restrict:"E",templateUrl:"partials/rpMediaTwitter",controller:"rpMediaTwitterCtrl"}}),rpMediaDirectives.directive("rpMediaGfycat",function(){return{restrict:"E",templateUrl:"partials/rpMediaGfycat",controller:"rpMediaGfycatCtrl"}}),rpMediaDirectives.directive("rpMediaGiphy",function(){return{restrict:"E",templateUrl:"partials/rpMediaGiphy",controller:"rpMediaGiphyCtrl"}}),rpMediaDirectives.directive("rpMediaDefault",function(){return{restrict:"E",templateUrl:"partials/rpMediaDefault",controller:"rpMediaDefaultCtrl"}}),rpMediaDirectives.directive("rpMediaImgurAlbumWrapper",function(){return{restrict:"C",link:function(e,t,r){t.children("img").load(function(){t.children(".rp-media-imgur-album-progress").hide()}),e.$on("album_image_change",function(){t.children(".rp-media-imgur-album-progress").show()})}}});var rpMessageControllers=angular.module("rpMessageControllers",[]);rpMessageControllers.controller("rpMessageCtrl",["$scope","$rootScope","$routeParams","rpMessageUtilService","rpIdentityUtilService","rpTitleChangeService","rpPostFilterButtonUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSubscribeButtonUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpToolbarShadowUtilService","rpReadAllMessagesUtilService","rpLocationUtilService","rpSidebarButtonUtilService","rpSettingsUtilService","rpReadMessageUtilService",function(e,t,r,i,o,s,n,a,l,c,u,p,d,m,h,g,f,v){function S(){e.messages={},e.havePosts=!1,e.hasMail=!1,e.noMorePosts=!1,t.$emit("progressLoading"),i(w,"",$,function(r,i){if(t.$emit("progressComplete"),r);else if(e.noMorePosts=i.get.data.children.length<$,e.messages=i.get.data.children,e.havePosts=!0,"unread"===w){for(var o=[],s=0;s<e.messages.length;s++)o.push(e.messages[s].data.name);var n=o.join(", ");v(n,function(i){r||(e.hasMail=!1,t.$emit("rp_messages_read"))})}})}n.hide(),c.hide(),a.hide(),l.hide(),u.hide(),p.hide(),d.hide(),g.hide();var b=!1;e.noMorePosts=!1;var $=25;s.prepTitleChange("Messages");var w=r.where||"inbox",C=[{label:"all",value:"inbox"},{label:"unread",value:"unread"},{label:"messages",value:"messages"},{label:"comment replies",value:"comments"},{label:"post replies",value:"selfreply"},{label:"username mentions",value:"mentions"}];t.$emit("rp_tabs_changed",C),t.$emit("rp_tabs_show"),o.reloadIdentity(function(r){e.identity=r,e.hasMail=e.identity.has_mail,e.hasMail&&"unread"!==w&&(w="unread",h(null,"/message/"+w,"",!1,!0));for(var i=0;i<C.length;i++)if(w===C[i].value){t.$emit("rp_tabs_selected_index_changed",i);break}S()});var y=t.$on("rp_tab_click",function(e,t){w=t,h(null,"/message/"+w,"",!1,!1),S()});e.thisController=this,e.morePosts=function(){if(e.messages&&e.messages.length>0){var r=e.messages[e.messages.length-1].data.name;r&&!b&&(b=!0,t.$emit("progressLoading"),i(w,r,$,function(r,i){t.$emit("progressComplete"),r||(e.noMorePosts=i.get.data.children.length<25,Array.prototype.push.apply(e.messages,i.get.data.children),b=!1)}))}},e.$on("$destroy",function(){y(),t.$emit("rp_tabs_hide")})}]),rpMessageControllers.controller("rpMessageCommentCtrl",["$scope","$filter","$mdDialog","rpIdentityUtilService","rpByIdUtilService","rpLocationUtilService",function(e,t,r,i,o,s){e.identity,e.childDepth=e.depth+1,e.isReplying=!1,e.thisController=this,this.completeReplying=function(t,r){this.isReplying=!1,"t1"===e.message.kind?e.comments=t.json.data.things:"t4"===e.message.kind&&(e.message.data.replies?e.message.data.replies.data.children.push(t.json.data.things[0]):e.message.data.replies={data:{children:t.json.data.things}})}}]),rpMessageControllers.controller("rpMessageSidenavCtrl",["$scope","$rootScope","$mdDialog","rpSettingsUtilService","rpLocationUtilService","rpIdentityUtilService",function(e,t,r,i,o,s){e.isOpen=!1,e.toggleOpen=function(){e.isOpen=!e.isOpen},e.hasMail=!1,s.getIdentity(function(t){e.hasMail=t.has_mail}),e.showCompose=function(e){i.settings.composeDialog?r.show({controller:"rpMessageComposeDialogCtrl",templateUrl:"partials/rpMessageComposeDialog",targetEvent:e,clickOutsideToClose:!1,escapeToClose:!1,locals:{shareLink:null,shareTitle:null}}):o(e,"/message/compose","",!0,!1)},e.showInbox=function(e){o(e,"/message/inbox","",!0,!1)},e.showSent=function(e){o(e,"/message/sent","",!0,!1)};var n=t.$on("rp_messages_read",function(){e.hasMail=!1});e.$on("$destroy",function(){n()})}]),rpMessageControllers.controller("rpMessageComposeCtrl",["$scope","$mdDialog","rpLocationUtilService","rpSubredditsUtilService",function(e,t,r,i){null!==e.shareLink&&void 0!==e.shareLink?e.title="Share a link with a reddit user":e.title="Send a message"}]),rpMessageControllers.controller("rpMessageComposeDialogCtrl",["$scope","$location","$mdDialog","shareLink","shareTitle",function(e,t,r,i,o){e.shareLink=i||null,e.shareTitle=o||null,e.dialog=!0;var s=e.$on("$locationChangeSuccess",function(){r.hide()});e.$on("$destroy",function(){s()})}]),rpMessageControllers.controller("rpMessageComposeFormCtrl",["$scope","$rootScope","$mdDialog","rpMessageComposeUtilService","rpLocationUtilService",function(e,t,r,i,o){function s(){e.subject="",e.text="",e.to="",e.rpMessageComposeForm.$setUntouched()}e.messageSending=!1,e.showSend=!0,null!==e.shareLink&&void 0!==e.shareLink&&(e.text="Check this out, ["+e.shareTitle+"]("+e.shareLink+")"),e.closeDialog=function(t){e.dialog?(s(),r.hide()):o(t,"/","",!0,!1)},e.sendMessage=function(){e.messageSending=!0,i(e.subject,e.text,e.to,e.iden,e.captcha,function(r,i){e.messageSending=!1,r?"BAD_CAPTCHA"===r.json.errors[0][0]?(t.$emit("reset_captcha"),e.feedbackMessage="You entered the CAPTCHA incorrectly. Please try again.",e.showFeedbackAlert=!0,e.showFeedback=!0,e.showButtons=!0):(t.$emit("reset_captcha"),e.feedbackMessage=r.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedback=!0):(e.feedbackMessage="Your message was sent successfully :)",e.showFeedbackAlert=!1,e.showFeedback=!0,e.showSendAnother=!0,e.showSend=!1)})},e.sendAnother=function(){s(),t.$emit("reset_captcha"),e.showFeedback=!1,e.showSendAnother=!1,e.showSend=!0}}]);var rpPostControllers=angular.module("rpPostControllers",[]);rpPostControllers.controller("rpPostsCtrl",["$scope","$rootScope","$routeParams","$window","$filter","$timeout","$q","rpPostsUtilService","rpTitleChangeService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSubscribeButtonUtilService","rpSettingsUtilService","rpSubredditsUtilService","rpLocationUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpSidebarButtonUtilService","rpToolbarShadowUtilService","rpAuthUtilService","rpIdentityUtilService","rpPostFilterButtonUtilService",function(e,t,r,i,o,s,n,a,l,c,u,p,d,m,h,g,f,v,S,b,$,w){function C(){e.posts={},e.havePosts=!1,e.noMorePosts=!1,t.$emit("progressLoading"),a(k,e.sort,"",M,A,function(r,i){t.$emit("progressComplete"),r||(e.havePosts=!0,i.get.data.children.length<A&&(e.noMorePosts=!0),e.posts=i.get.data.children)})}function y(t,r,i){return e.posts.length>0?e.posts=Array.prototype.concat.apply(e.posts,i.slice(t,r)):e.posts=i.slice(t,r),s(angular.noop,0)}function U(e,t){for(var r,i=n.when(),o=0;o<e.length;o+=t)r=angular.bind(null,y,o,Math.min(o+t,e.length),e),i=i.then(r);return i}var _=[{label:"hot",value:"hot"},{label:"new",value:"new"},{label:"rising",value:"rising"},{label:"controversial",value:"controversial"},{label:"top",value:"top"},{label:"gilded",value:"gilded"}];t.$emit("rp_tabs_changed",_),t.$emit("rp_tabs_show"),c.hide(),u.hide(),g.hide(),f.hide(),S.hide();var k=e.subreddit=r.sub;e.sort=r.sort?r.sort:"hot";var M=r.t?r.t:"week",R=!1;e.showSub=!0;for(var T=12,A=18,P=0;P<_.length;P++)if(e.sort===_[P].value){t.$emit("rp_tabs_selected_index_changed",P),3===P||4===P?w.show():w.hide();break}k&&"all"!==k&&"random"!==k?(e.showSub=!1,l.prepTitleChange("r/"+k),m.setSubreddit(k),p.show(),v.show()):(p.hide(),v.hide(),e.showSub=!0,l.prepTitleChange("frontpage")),b.isAuthenticated&&$.getIdentity(function(t){e.identity=t}),C();var L=t.$on("t_click",function(t,r){M=r,k?h(null,"/r/"+k+"/"+e.sort,"t="+M,!1,!1):h(null,e.sort,"t="+M,!1,!1),C()});e.thisController=this,this.completeDeleting=function(t){e.posts.forEach(function(r,i){r.data.name===t&&e.posts.splice(i,1)})};var D=t.$on("rp_tab_click",function(t,r){e.posts={},e.noMorePosts=!1,e.sort=r,k?h(null,"/r/"+k+"/"+e.sort,"",!1,!1):h(null,e.sort,"",!1,!1),"top"===r||"controversial"===r?w.show():w.hide(),C()});e.morePosts=function(){if(e.posts&&e.posts.length>0){var r=e.posts[e.posts.length-1].data.name;r&&!R&&(R=!0,t.$emit("progressLoading"),a(k,e.sort,r,M,T,function(r,i){t.$emit("progressComplete"),r||(i.get.data.children.length<T&&(e.noMorePosts=!0),U(i.get.data.children,6),R=!1)}))}},e.showContext=function(e,t){h(e,"/r/"+t.data.subreddit+"/comments/"+o("rp_name_to_id36")(t.data.link_id)+"/"+t.data.id+"/","context=8",!0,!1)},e.$on("$destroy",function(){L(),D(),t.$emit("rp_tabs_hide")})}]),rpPostControllers.controller("rpPostsTimeFilterCtrl",["$scope","$rootScope","$routeParams",function(e,t,r){var i=t.$on("$routeChangeSuccess",function(){e.postTime=r.t||"week"});e.selectTime=function(e){t.$emit("t_click",e)},e.$on("$destroy",function(){i()})}]),rpPostControllers.controller("rpPostFabCtrl",["$scope","$rootScope","$mdDialog","rpAuthUtilService","rpToastUtilService","rpSettingsUtilService","rpLocationUtilService",function(e,t,r,i,o,s,n){e.fabState="closed",e.newLink=function(t){i.isAuthenticated?(s.settings.submitDialog?r.show({controller:"rpSubmitDialogCtrl",templateUrl:"partials/rpSubmitLinkDialog",targetEvent:t,locals:{subreddit:e.subreddit},clickOutsideToClose:!0,escapeToClose:!1}):n(null,"/submitLink","",!0,!1),e.fabState="closed"):(e.fabState="closed",o("You've got to log in to submit a link"))},e.newText=function(t){i.isAuthenticated?(s.settings.submitDialog?r.show({controller:"rpSubmitDialogCtrl",templateUrl:"partials/rpSubmitTextDialog",targetEvent:t,locals:{subreddit:e.subreddit},clickOutsideToClose:!0,escapeToClose:!1}):n(null,"/submitText","",!0,!1),e.fabState="closed"):(e.fabState="closed",o("You've got to log in to submit a self post"))},e.$on("$destroy",function(){})}]);var rpProgressControllers=angular.module("rpProgressControllers",[]);rpProgressControllers.controller("rpIndeterminateProgressCtrl",["$scope","$rootScope","$log","$timeout",function(e,t,r,i){e.loading=!1;var o=t.$on("progressLoading",function(t,r){e.loading=!0}),s=t.$on("progressComplete",function(t,r){e.loading=!1});t.$on("$locationChangeStart",function(){e.loading=!0}),t.$on("$locationChangeSuccess",function(){e.loading=!1}),e.$on("$destroy",function(){o(),s()})}]),rpProgressControllers.controller("rpDeterminateProgressCtrl",["$scope","$rootScope","$log","$timeout","$interval",function(e,t,r,i,o){function s(t){e.loading!==!1&&e.value<t&&(e.value=t)}function n(){var t=0,r=e.value/100;t=r>=0&&.25>r?20*Math.random()/100:r>=.25&&.65>r?10*Math.random()/100:r>=.65&&.9>r?5*Math.random()/100:0,s(e.value+100*t)}e.value=0,e.loading=!1;var a,l=t.$on("progressLoading",function(t,r){e.loading===!1&&(e.loading=!0),o(function(){e.value<100&&e.value<90&&n()},125,40,!0)}),c=t.$on("progress",function(e,t){s(t.value)}),u=t.$on("progressComplete",function(t,r){a=o(function(){e.value<100?e.value+=1:(i(function(){e.loading=!1,e.value=0},500),o.cancel(a))},75,100,!1)});e.$on("$destroy",function(){l(),c(),u()})}]);var rpReplyFormControllers=angular.module("rpReplyFormControllers",[]);rpReplyFormControllers.controller("rpReplyButtonCtrl",["$scope",function(e){e.parentCtrl.isReplying=!1,e.toggleReplying=function(){e.parentCtrl.isReplying=!e.parentCtrl.isReplying}}]),rpReplyFormControllers.controller("rpReplyFormCtrl",["$scope","rpCommentUtilService",function(e,t){e.submit=function(){t(e.redditId,e.reply,function(t,r){t||(e.reply="",e.replyForm.$setUntouched(),e.replyForm.$setPristine(),e.parentCtrl.completeReplying&&e.parentCtrl.completeReplying(r,e.post))})}}]);var rpResourceServices=angular.module("rpResourceServices",["ngResource"]);rpResourceServices.factory("rpSubredditAboutResourceService",["$resource",function(e){return e("/api/about/:sub")}]),rpResourceServices.factory("rpReadAllMessagesResourceService",["$resource",function(e){return e("/api/uauth/read_all_messages")}]),rpResourceServices.factory("rpReadMessageResourceService",["$resource",function(e){return e("/api/uauth/read_message")}]),rpResourceServices.factory("rpSubbscribeResourceService",["$resource",function(e){return e("/api/uauth/subscribe")}]),rpResourceServices.factory("rpIdentityResourceService",["$resource",function(e){return e("/api/uauth/me")}]),rpResourceServices.factory("rpByIdResourceService",["$resource",function(e){return e("/api/by_id/:name")}]),rpResourceServices.factory("rpSubredditsResourceService",["$resource",function(e){return e("/api/subreddits/:where",{where:"default",limit:50})}]),rpResourceServices.factory("rpSubredditsMineResourceService",["$resource",function(e){return e("/api/uauth/subreddits/mine/:where",{where:"subscriber",limit:50,after:""})}]),rpResourceServices.factory("rpPostsResourceService",["$resource",function(e){return e("/api/subreddit/:sub/:sort")}]),rpResourceServices.factory("rpFrontpageResourceService",["$resource",function(e){return e("/api/:sort",{sort:"hot",after:"none",t:"none",limit:"limit"})}]),rpResourceServices.factory("rpUserResourceService",["$resource",function(e){return e("/api/user/:username/:where",{username:"",where:"overview",sort:"new",after:"none",t:"none"})}]),rpResourceServices.factory("rpCommentsResourceService",["$resource",function(e){return e("/api/comments/:subreddit/:article",{sort:"confidence"})}]),rpResourceServices.factory("rpMoreChildrenResourceService",["$resource",function(e){return e("/api/morechildren",{sort:"confidence"})}]),rpResourceServices.factory("rpMessageResourceService",["$resource",function(e){return e("/api/uauth/message/:where",{after:"none"})}]),rpResourceServices.factory("rpGildResourceService",["$resource",function(e){return e("/api/uauth/gild")}]),rpResourceServices.factory("rpVoteResourceService",["$resource",function(e){return e("/api/uauth/vote/")}]),rpResourceServices.factory("rpDeleteResourceService",["$resource",function(e){return e("/api/uauth/del/")}]),rpResourceServices.factory("rpEditResourceService",["$resource",function(e){return e("/api/uauth/editusertext")}]),rpResourceServices.factory("rpSaveResourceService",["$resource",function(e){return e("/api/uauth/save/")}]),rpResourceServices.factory("rpUnsaveResourceService",["$resource",function(e){return e("/api/uauth/unsave/")}]),rpResourceServices.factory("rpCommentResourceService",["$resource",function(e){return e("/api/uauth/comment")}]),rpResourceServices.factory("rpMessageComposeResourceService",["$resource",function(e){return e("/api/uauth/compose")}]),rpResourceServices.factory("rpSubmitResourceService",["$resource",function(e){return e("/api/uauth/submit")}]),rpResourceServices.factory("rpNeedsCaptchaResourceService",["$resource",function(e){return e("/api/uauth/needs_captcha")}]),rpResourceServices.factory("rpNewCaptchaResourceService",["$resource",function(e){return e("/api/uauth/new_captcha")}]),rpResourceServices.factory("rpCaptchaResourceService",["$resource",function(e){return e("/api/uauth/captcha/:iden")}]),rpResourceServices.factory("rpSearchResourceService",["$resource",function(e){return e("/api/search/:sub",{sub:"all",sort:"relevance",after:"",before:"",restrict_sr:!0,t:"all",type:"sr",limit:24})}]),rpResourceServices.factory("rpSettingsResourceService",["$resource",function(e){return e("/settings")}]),rpResourceServices.factory("rpShareEmailResourceService",["$resource",function(e){return e("/share")}]),rpResourceServices.factory("rpImgurAlbumResourceService",["$resource",function(e){return e("https://api.imgur.com/3/album/:id",{},{get:{headers:{Authorization:"Client-ID a912803498adcd4"}}})}]),rpResourceServices.factory("rpImgurGalleryResourceService",["$resource",function(e){return e(" https://api.imgur.com/3/gallery/:id",{},{get:{headers:{Authorization:"Client-ID a912803498adcd4"}}})}]),rpResourceServices.factory("rpTweetResourceService",["$resource",function(e){return e("/twitter/status/:id")}]),rpResourceServices.factory("rpGoogleUrlResourceService",["$resource",function(e){return e("https://www.googleapis.com/urlshortener/v1/url",{key:"AIzaSyCie8StCg7EAAOECOjLa3qEMocvi7YhQfU"})}]);var rpSaveControllers=angular.module("rpSaveControllers",[]);rpSaveControllers.controller("rpSaveButtonCtrl",["$scope","rpSaveUtilService","rpAuthUtilService","rpToastUtilService",function(e,t,r,i){e.save=function(){r.isAuthenticated?(e.saved=!e.saved,t(e.redditId,e.saved,function(e,t){})):i("You've got to log in to save posts")}}]);var rpScoreControllers=angular.module("rpScoreControllers",[]);rpScoreControllers.controller("rpScoreCtrl",["$scope","rpAuthUtilService","rpToastUtilService","rpVoteUtilService",function(e,t,r,i){e.upvote=function(){if(t.isAuthenticated){var o,s=e.score,n=e.likes;switch(e.likes){case!0:o=0,e.score=e.score-1,e.likes=null;break;case!1:o=1,e.score=e.score+2,e.likes=!0;break;default:o=1,e.score=e.score+1,e.likes=!0}i(e.redditId,o,function(t,i){t&&(e.score=s,e.likes=n,r("Something went wrong trying to upvotes."))})}else r("You must log in to vote")},e.downvote=function(){if(t.isAuthenticated){var o,s=e.score,n=e.likes;switch(e.likes){case!0:o=-1,e.score=e.score-2,e.likes=!1;break;case!1:o=0,e.score=e.score+1,e.likes=null;break;default:o=-1,e.score=e.score-1,e.likes=!1}i(e.redditId,o,function(t,i){t&&(r("Something went wrong tring to downvote."),e.score=s,e.lieks=n)})}else r("You must log in to vote")}}]);var rpSearchControllers=angular.module("rpSearchControllers",[]);rpSearchControllers.controller("rpSearchSidenavCtrl",["$scope","$rootScope",function(e,t){e.isOpen=!1,e.toggleOpen=function(){e.isOpen=!e.isOpen};var r=t.$on("search_form_visibility",function(t,r){e.isOpen=r});e.$on("$destroy",function(){r()})}]),rpSearchControllers.controller("rpSearchFormCtrl",["$scope","$rootScope","$location","$routeParams","$timeout","rpSearchUtilService","rpSubredditsUtilService","rpLocationUtilService",function(e,t,r,i,o,s,n,a){function l(){e.searchSubreddits&&e.searchLinks?e.params.type="sr, link":e.searchSubreddits?e.params.type="sr":e.searchLinks&&(e.params.type="link")}function c(e){var t=angular.lowercase(e);return function(e){return 0===e.data.display_name.indexOf(t)}}e.params=s.params,n.currentSub&&""!==n.currentSub?e.params.sub=n.currentSub:e.params.sub="all","all"!==e.params.sub&&(e.params.type=e.params.formType="link");var u=/\/search.*/,p=u.test(r.path());e.focusInput=!0,e.searchSubreddits="sr"===e.params.type||"sr, link"===e.params.type,e.searchLinks="link"===e.params.type||"sr, link"===e.params.type,e.toggleSearchSubreddits=function(){e.searchSubreddits=!e.searchSubreddits,e.searchLinks||(e.searchLinks=!0),l()},e.toggleSearchLinks=function(){e.searchLinks=!e.searchLinks,e.searchSubreddits||(e.searchSubreddits=!0),l()},e.subSearch=function(){e.subs=n.subs;var t=e.params.sub?e.subs.filter(c(e.params.sub)):[];return t};var d=t.$on("search_params_changed",function(){e.params=s.params});e.submitSearchForm=function(){p=u.test(r.path()),e.subSelectedItem&&(e.params.sub=e.subSelectedItem.data.display_name),""===e.params.sub&&(n.currentSub&&""!==n.currentSub?e.params.sub=n.currentSub:e.params.sub="all"),e.params.sub&&""!==e.params.sub||(e.params.sub="all"),"all"!==e.params.sub&&"link"!==e.params.type&&(e.params.type="link"),"all"===e.params.sub?e.params.restrict_sr=!1:e.params.restrict_sr=!0,e.params.after="",o(function(){a(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!p,!1),p&&t.$emit("search_form_submitted")},250)},e.resetSearchForm=function(){},e.$on("$destroy",function(){d()})}]),rpSearchControllers.controller("rpSearchCtrl",["$scope","$rootScope","$routeParams","$location","$window","$mdDialog","$mdBottomSheet","rpSubredditsUtilService","rpSearchUtilService","rpSearchFormUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpPostFilterButtonUtilService","rpSubscribeButtonUtilService","rpSearchFilterButtonUtilService","rpByIdUtilService","rpLocationUtilService","rpSettingsUtilService","rpToolbarShadowUtilService","rpTitleChangeService","rpAuthUtilService","rpIdentityUtilService",function(e,t,r,i,o,s,n,a,l,c,u,p,d,m,h,g,f,v,S,b,$,w){function C(){if("link"===e.params.type){t.$emit("rp_tabs_changed",k),t.$emit("rp_tabs_show"),t.$emit("rp_content_scroll_enable"),e.scroll=!0;for(var r=0;r<k.length;r++)if(e.params.sort===k[r].value){t.$emit("rp_tabs_selected_index_changed",r);break}}else t.$emit("rp_tabs_hide"),t.$emit("rp_content_scroll_disable"),e.scroll=!1}u.hide(),p.hide(),d.hide(),m.hide(),e.posts={},e.links={},e.subs={},e.haveSubs=e.haveLinks=e.havePosts=!1;var y=!1;e.nothingPosts=!1,e.nothingSubs=!1,e.nothingLinks=!1,e.noMorePosts=!1;var U=24;e.params=l.params,$.isAuthenticated&&w.getIdentity(function(t){e.identity=t}),e.showSub=!0,r.q&&(e.params.q=r.q,b.prepTitleChange("search: "+e.params.q)),r.sub?e.params.sub=r.sub:a.currentSub&&(e.params.sub=a.currentSub),"all"===e.params.sub||""===e.params.sub?(r.type&&(e.params.type=r.type),e.type=e.params.formType=e.params.type):e.type=e.params.formType=e.params.type="link";var _=/[.]*(author\:)[,]*/;_.test(e.params.q)&&(e.type=e.params.type="link"),"link"!==e.params.type&&S.show(),r.restrict_sr&&(e.params.restrict_sr=r.restrict_sr),r.t&&(e.params.t=r.t),r.sort&&(e.params.sort=r.sort),r.after?e.params.after=r.after:e.params.after="",c.show();var k=[{label:"relevance",value:"relevance"},{label:"top",value:"top"},{label:"new",value:"new"},{label:"comments",value:"comments"}];C(),t.$emit("progressLoading"),"sr, link"===e.params.type?(e.params.type="sr",e.params.limit=4,l.search(function(r,i){r||(i&&i.data.children.length>0?(e.noMorePosts=i.data.children.length<e.params.limit,e.subs=i.data.children,e.haveSubs=!0):e.nothingSubs=!0,(e.haveLinks||e.nothingLinks)&&(t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))}),e.params.type="link",e.params.limit=4,l.search(function(r,i){r||(i&&i.data.children.length>0?(e.noMorePosts=i.data.children.length<e.params.limit,e.links=i.data.children,e.haveLinks=!0):e.nothingLinks=!0,(e.haveSubs||e.nothingSubs)&&(t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))}),e.params.type="sr, link"):l.search(function(r,i){t.$emit("progressComplete"),r||(i&&i.data.children.length>0?(e.noMorePosts=i.data.children.length<U,e.posts=i.data.children,e.havePosts=!0):e.nothingPosts=!0)}),e.thisController=this,this.completeDeleting=function(t){var r;"link"===e.params.type?r=e.posts:"sr, link"===e.params.type&&(r=e.links),r.forEach(function(e,i){e.data.name===t&&r.splice(i,1)})};var M=t.$on("rp_tab_click",function(r,i){e.params.sort=i,e.params.after="",f(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!0),e.posts={},e.havePosts=!1,e.noMorePosts=!1,t.$emit("progressLoading"),l.search(function(r,i){r||(e.noMorePosts=i.data.children.length<U,t.$emit("progressComplete"),e.posts=i.data.children,e.havePosts=!0)})});e.morePosts=function(){if(e.posts&&e.posts.length>0){var r=e.posts[e.posts.length-1].data.name;r&&!y&&(y=!0,e.params.after=r,f(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!0),t.$emit("progressLoading"),l.search(function(r,i){r||(e.noMorePosts=i.data.children.length<U,t.$emit("progressComplete"),Array.prototype.push.apply(e.posts,i.data.children),e.havePosts=!0,y=!1)}))}},e.searchSub=function(r,i){r.ctrlKey?f(r,"/search","q="+e.params.q+"&sub="+i.data.display_name+"&type=link&restrict_sr=true&sort=relevance&after=&t=all",!0,!0):(e.params.sub=i.data.display_name,e.type=e.params.formType=e.params.type="link",e.params.restrict_sr=!0,e.params.after="",e.params.sort="relevance",e.params.t="all",f(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!1),e.posts={},e.havePosts=!1,e.nothingPosts=!1,e.nothingSubs=!1,e.nothingLinks=!1,e.noMorePosts=!1,t.$emit("progressLoading"),S.hide(),l.search(function(r,i){r||(e.noMorePosts=i.data.children.length<U,t.$emit("progressComplete"),e.posts=i.data.children,e.havePosts=!0)}))},e.moreSubs=function(r){C(),r.ctrlKey?f(r,"/search","q="+e.params.q+"&sub=all&type=sr&restrict_sr=false&sort=relevance&after=&t=all",!0,!0):(e.params.sub="all",e.type=e.params.formType=e.params.type="sr",e.params.restrict_sr=!1,e.params.after="",e.params.sort="relevance",e.params.t="all",f(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!1),e.posts={},e.subs={},e.links={},e.havePosts=!1,e.haveLinks=!1,e.haveSubs=!1,e.noMorePosts=!1,t.$emit("progressLoading"),l.search(function(r,i){r||(e.noMorePosts=i.data.children.length<U,t.$emit("progressComplete"),e.posts=i.data.children,e.havePosts=!0)}))},e.moreLinks=function(r){C(),r.ctrlKey?f(r,"/search","q="+e.params.q+"&sub=all&type=link&restrict_sr=false&sort=relevance&after=&t=all",!0,!0):(e.params.sub="all",e.type=e.params.formType=e.params.type="link",e.params.restrict_sr=!1,e.params.after="",e.params.sort="relevance",e.params.t="all",f(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!1),e.posts={},e.subs={},e.links={},e.havePosts=!1,e.haveLinks=!1,e.haveSubs=!1,e.noMorePosts=!1,t.$emit("progressLoading"),S.hide(),l.search(function(r,i){r||(e.noMorePosts=i.data.children.length<U,t.$emit("progressComplete"),e.posts=i.data.children,e.havePosts=!0)}))},e.sharePost=function(e,t){t.bottomSheet=!0;n.show({templateUrl:"partials/rpShareBottomSheet",controller:"rpShareCtrl",targetEvent:e,parent:".rp-view",disbaleParentScroll:!0,locals:{post:t}}).then(function(){t.bottomSheet=!1})["catch"](function(){t.bottomSheet=!1})};var R=t.$on("search_time_click",function(r,i){e.posts={},e.havePosts=!1,e.noMorePosts=!1,e.params.t=i,e.params.after="",f(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!0),e.posts={},e.havePosts=!1,t.$emit("progressLoading"),l.search(function(r,i){r||(e.noMorePosts=i.data.children.length<U,t.$emit("progressComplete"),e.posts=i.data.children,e.havePosts=!0)})}),T=t.$on("search_form_submitted",function(){e.posts={},e.havePosts=!1,e.nothingPosts=!1,e.nothingSubs=!1,e.nothingLinks=!1,e.noMorePosts=!1,t.$emit("progressLoading");var r=/[.]*(author\:)[,]*/;r.test(e.params.q)&&(e.type=e.params.type="link"),e.type=e.params.type,"link"!==e.params.type?S.show():S.hide(),C(),"sr, link"===e.params.type?(e.subs={},e.haveSubs=!1,e.params.type="sr",e.params.limit=4,l.search(function(r,i){r||(i&&i.data.children.length>0?(e.subs=i.data.children,e.haveSubs=!0):e.nothingSubs=!0,(e.haveLinks||e.nothingLinks)&&(t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))}),e.links={},e.haveLinks=!1,e.params.type="link",e.params.limit=4,l.search(function(r,i){r||(i&&i.data.children.length>0?(e.links=i.data.children,e.haveLinks=!0):e.nothingLinks=!0,(e.haveSubs||e.nothingSubs)&&(t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))})):l.search(function(r,i){r||(t.$emit("progressComplete"),i&&i.data.children.length>0?(e.noMorePosts=i.data.children.length<U,e.posts=i.data.children,e.havePosts=!0,e.type=e.params.type):e.nothingPosts=!0)})});e.$on("$destroy",function(){T(),R(),M()})}]),rpSearchControllers.controller("rpSearchTimeFilterCtrl",["$scope","$rootScope","rpSearchUtilService",function(e,t,r){e.type=r.params.type,e.selectTime=function(e){t.$emit("search_time_click",e)}}]),rpSearchControllers.controller("rpSearchSubscriptionCtrl",["$scope","$rootScope","rpSubredditsUtilService",function(e,t,r){e.loadingSubscription=!1,e.subscribed=r.isSubscribed(e.post.data.display_name),e.toggleSubscription=function(){e.loadingSubscription=!0;var t=e.subscribed?"unsub":"sub";r.subscribe(t,e.post.data.name,function(t,r){t||(e.loadingSubscription=!1)})};var i=t.$on("subreddits_updated",function(){e.subscribed=r.isSubscribed(e.post.data.display_name)});e.$on("$destroy",function(){i()})}]);var rpServices=angular.module("rpServices",[]);rpServices.factory("rpTitleChangeService",["$rootScope",function(e){var t={};return t.title="frontpage",t.prepTitleChange=function(r){t.title=r,e.$broadcast("handleTitleChange")},t}]);var rpSettingsControllers=angular.module("rpSettingsControllers",[]);rpSettingsControllers.controller("rpSettingsDialogCtrl",["$scope","$rootScope","$location","$mdDialog","rpSettingsUtilService",function(e,t,r,i,o){e.isDialog=!0;var s=e.$on("$locationChangeSuccess",function(){i.hide()});e.$on("$destroy",function(){s()})}]),rpSettingsControllers.controller("rpSettingsCtrl",["$scope","$rootScope","rpSettingsUtilService","rpTitleChangeService",function(e,t,r,i){e.settings=r.getSettings(),e.themes=["default","indigo","blue","red","green","pink","purple"],e.isDialog||i.prepTitleChange("Settings"),e.settingChanged=function(){r.setSettings(e.settings)};var o=t.$on("settings_changed",function(){e.settings=r.getSettings()});e.$on("$destroy",function(){o()})}]),rpSettingsControllers.controller("rpSettingsSidenavCtrl",["$scope","$rootScope","$mdDialog","rpSettingsUtilService","rpLocationUtilService",function(e,t,r,i,o){e.showSettings=function(e){i.settings.settingsDialog?r.show({controller:"rpSettingsDialogCtrl",templateUrl:"partials/rpSettingsDialog",targetEvent:e,clickOutsideToClose:!0,escapeToClose:!0}):o(null,"/settings","",!0,!1)},e.$on("$destroy",function(){})}]);var rpShareControllers=angular.module("rpShareControllers",[]);rpShareControllers.controller("rpShareButtonCtrl",["$scope","$rootScope","$mdBottomSheet",function(e,t,r){var i=!1;e.share=function(o){parseInt(angular.element(".rp-tab-toolbar").css("top"))>=0&&(t.$emit("rp_tabs_hide",!0),i=!0),r.show({templateUrl:"partials/rpShareBottomSheet",controller:"rpShareCtrl",targetEvent:o,parent:".rp-bottom-sheet-parent",disbaleParentScroll:!0,locals:{post:e.post}}).then(function(){},function(){i&&t.$emit("rp_tabs_show",!0)})["catch"](function(){})}}]),rpShareControllers.controller("rpShareCtrl",["$scope","$window","$filter","$mdBottomSheet","$mdDialog","rpLocationUtilService","rpSettingsUtilService","rpGoogleUrlUtilService","post",function(e,t,r,i,o,s,n,a,l){var c=l?"http://www.reddup.com"+l.data.permalink:"http://www.reddup.com",u=l?l.data.title:"reddup.com",p="http://reddup.co/logo";l&&""!==l.data.thumbnail&&"self"!==l.data.thumbnail&&(p=l.data.thumbnail),e.items=[{name:"reddit user",icon:"/icons/reddit-square.svg"},{name:"email",icon:"/icons/ic_email_black_48px.svg"},{name:"facebook",icon:"/icons/facebook-box.svg"},{name:"twitter",icon:"/icons/twitter-box.svg"}],e.listItemClicked=function(e,r){switch(i.hide(),r){case 0:o.show({controller:"rpMessageComposeDialogCtrl",templateUrl:"partials/rpMessageComposeDialog",clickOutsideToClose:!1,escapeToClose:!1,locals:{shareLink:c,shareTitle:u}});break;case 1:o.show({controller:"rpShareEmailDialogCtrl",templateUrl:"partials/rpShareEmailDialog",clickOutsideToClose:!1,escapeToClose:!1,
locals:{shareLink:c,shareTitle:u}});break;case 2:var s="https://www.facebook.com/dialog/feed?app_id=868953203169873&name=";s+=encodeURIComponent(u),s+="&link=",s+=encodeURIComponent(c),s+="&redirect_uri=",s+=encodeURIComponent("http://reddup.co/facebookComplete"),s+="&picture=",s+=p,s+="&display=popup",t.open(s,"Share with facebook","height=500,width=500");break;case 3:var n;u.length+c.length<127?(n=u+", "+c+" via @reddup",t.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(n)+" via @reddup","Share with twitter","height=500,width=500")):a(c,function(e,r){if(e);else{if(u.length+r.id.length<123)n=u+", "+r.id+" via @reddup";else{var i=u.substr(0,123-r.id.length);n=i+".. "+r.id+" via @reddup"}t.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(n),"Share with twitter","height=500,width=500")}})}}}]),rpShareControllers.controller("rpShareEmailDialogCtrl",["$scope","$location","$mdDialog","shareLink","shareTitle",function(e,t,r,i,o){e.shareLink=i,e.shareTitle=o;var s=e.$on("$locationChangeSuccess",function(){r.hide()});e.$on("$destroy",function(){s()})}]),rpShareControllers.controller("rpShareEmailFormCtrl",["$scope","$mdDialog","rpShareEmailUtilService",function(e,t,r){function i(){e.to="",e.text="Check this out, ["+e.shareTitle+"]("+e.shareLink+")",e.showAnother=!1,e.showButtons=!0,e.showSubmit=!0,angular.element("#share-to").focus()}i(),e.submitForm=function(){e.showProgress=!0,e.showButtons=!1;var t="reddup shared link: "+e.shareTitle;r(e.to,e.text,t,function(t,r){t||(e.feedbackMessage="Email sent :).",e.showProgress=!1,e.showAnother=!0,e.showSubmit=!1,e.showButtons=!0)})},e.resetForm=function(){i()},e.closeDialog=function(){t.hide()}}]);var rpSubmitControllers=angular.module("rpSubmitControllers",[]);rpSubmitControllers.controller("rpSubmitDialogCtrl",["$scope","$location","$mdDialog","subreddit",function(e,t,r,i){e.isDialog=!0,i&&"all"===i||(e.subreddit=i);var o=e.$on("$locationChangeSuccess",function(){r.hide()});e.$on("$destroy",function(){o()})}]),rpSubmitControllers.controller("rpSubmitFormCtrl",["$scope","$rootScope","$interval","$mdDialog","rpSubmitUtilService","rpSubredditsUtilService","rpSidebarButtonUtilService","rpLocationUtilService",function(e,t,r,i,o,s,n,a){function l(e){var t=angular.lowercase(e);return function(e){return 0===e.data.display_name.indexOf(t)}}function c(){e.title="",e.url="",e.text="",e.sendreplies=!0,e.iden="",e.cpatcha="",u&&(e.subreddit=""),e.showSubmit=!0,e.showRatelimit=!1,e.showAnother=!1,e.showRepost=!1,e.showMessage=!1,e.showButtons=!0,e.rpSubmitNewLinkForm&&e.rpSubmitNewLinkForm.$setUntouched()}e.subreddit||(e.subreddit=s.currentSub),!e.isDialog&&e.subreddit&&n.show();var u=!1;e.subreddit||(u=!0),c();var p;e.subs=s.subs,e.subSearch=function(t){p=t;var r=t?e.subs.filter(l(t)):[];return r},e.resetForm=function(){c(),t.$emit("reset_captcha")},e.submitLink=function(i){e.showProgress=!0,e.showButtons=!1,e.showFeedback=!1;var s=e.url?"link":"self";i.target.elements.submitTitleInput.blur(),i.target.elements.submitSubredditInput&&i.target.elements.submitSubredditInput.blur(),i.target.elements.submitUrlInput&&i.target.elements.submitUrlInput.blur(),i.target.elements.submitTextInput&&i.target.elements.submitTextInput.blur(),i.target.elements.captchaInput&&i.target.elements.captchaInput.blur(),e.subreddit||(e.subreddit=e.mdSelectedItem?e.mdSelectedItem.data.display_name:p),o(s,e.resubmit,e.sendreplies,e.subreddit,e.text,e.title,e.url,e.iden,e.captcha,function(i,o){if(e.showProgress=!1,i){var s=JSON.parse(i.body);if(s.json.errors.length>0)if("RATELIMIT"===s.json.errors[0][0]){e.showSubmit=!1,e.showRatelimit=!0;var n=s.json.ratelimit,a=r(function(){var i=parseInt(n/60,10),o=parseInt(n%60,10);i=10>i?"0"+i:i,o=10>o?"0"+o:o,e.rateLimitTimer=i+":"+o,--n<0&&(t.$emit("reset_captcha"),e.showRatelimit=!1,e.showFeedbackAlert=!1,e.feedbackMessage="Alright, you should be able to post now, give it another go.",e.showSubmit=!0,r.cancel(a))},1e3);e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showButtons=!0}else"QUOTA_FILLED"===s.json.errors[0][0]?(e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showSubmit=!1,e.showButtons=!0):"BAD_CAPTCHA"===s.json.errors[0][0]?(t.$emit("reset_captcha"),e.feedbackMessage="You entered the CAPTCHA incorrectly. Please try again.",e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showButtons=!0):"ALREADY_SUB"===s.json.errors[0][0]?(t.$emit("reset_captcha"),e.resubmit=!0,e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showSubmit=!1,e.showRepost=!0,e.showButtons=!0):(t.$emit("reset_captcha"),e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showSubmit=!0,e.showButtons=!0);else s.json.data.url||(t.$emit("reset_captcha"),e.feedbackMessage="An error occurred trying to post your link.\nPlease check the url, wait a few minutes and try again.",e.showFeedbackLink=!1,e.showFeedbackAlert=!0,e.showFeedback=!0,e.showButtons=!0)}else{var l=/^https?:\/\/www\.reddit\.com\/r\/([\w]+)\/comments\/([\w]+)\/(?:[\w]+)\//i,c=l.exec(o.json.data.url);c&&(e.feedbackLink="/r/"+c[1]+"/comments/"+c[2]),e.feedbackLinkName="Your post",e.feedbackMessage="was submitted successfully.",e.showFeedbackAlert=!1,e.showFeedbackLink=!0,e.showFeedback=!0,e.showRepost=!1,e.showSubmit=!1,e.showAnother=!0,e.showButtons=!0}})},e.closeDialog=function(){e.isDialog?i.hide():s.currentSub?a(null,"/r/"+s.currentSub,"",!0,!1):a(null,"/","",!0,!1)}}]);var rpTabsControllers=angular.module("rpTabsControllers",[]);rpTabsControllers.controller("rpTabsCtrl",["$scope","$timeout","$rootScope",function(e,t,r){e.tabs=[],e.selectedIndex=0,e.tabClick=function(e){t(function(){r.$emit("rp_tab_click",e)},350)};var i=r.$on("rp_tabs_changed",function(t,r){e.selectedIndex=0,e.tabs=r,e.showTabs=!0}),o=r.$on("rp_tabs_selected_index_changed",function(t,r){e.selectedIndex=r});e.$on("$destroy",function(){o(),i()})}]);var rpUserControllers=angular.module("rpUserControllers",[]);rpUserControllers.controller("rpUserCtrl",["$scope","$rootScope","$window","$routeParams","rpUserUtilService","rpTitleChangeService","rpSettingsUtilService","rpUserFilterButtonUtilService","rpPostFilterButtonUtilService","rpSubscribeButtonUtilService","rpLocationUtilService","rpIdentityUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpToolbarShadowUtilService","rpAuthUtilService","rpSidebarButtonUtilService","rpUserSortButtonUtilService",function(e,t,r,i,o,s,n,a,l,c,u,p,d,m,h,g,f,v){function S(){e.posts={},e.havePosts=!1,e.noMorePosts=!1,t.$emit("progressLoading"),o(C,y,U,"",_,w,function(r,i){t.$emit("progressComplete"),r||(i.get.data.children.length<w&&(e.noMorePosts=!0),e.posts=i.get.data.children,e.havePosts=!0)})}var b=[{label:"overview",value:"overview"},{label:"submitted",value:"submitted"},{label:"comments",value:"comments"},{label:"gilded",value:"gilded"}];t.$emit("rp_tabs_changed",b),t.$emit("rp_tabs_show"),l.hide(),c.hide(),d.hide(),m.hide(),h.hide(),f.hide();var $=!1,w=24,C=i.username,y=i.where||"overview",U=i.sort||"new",_=i.t||"none";if("top"===U||"controversial"===U?a.show():a.hide(),s.prepTitleChange("u/"+C),e.commentsDialog=n.settings.commentsDialog,g.isAuthenticated)p.getIdentity(function(r){e.isMe=C===r.name,e.isMe?(b=b.concat([{label:"upvoted",value:"upvoted"},{label:"downvoted",value:"downvoted"},{label:"hidden",value:"hidden"},{label:"saved",value:"saved"}]),t.$emit("rp_tabs_changed",b),t.$emit("rp_tabs_show")):("upvoted"===y||"downvoted"===y||"hidden"===y||"saved"===y)&&(y="overview",u(null,"/u/"+C+"/"+y,"",!1,!0));for(var i=0;i<b.length;i++)if(y===b[i].value){t.$emit("rp_tabs_selected_index_changed",i);break}S()});else{e.isMe=!1,("upvoted"===y||"downvoted"===y||"hidden"===y||"saved"===y)&&(y="overview",u(null,"/u/"+C+"/"+y,"",!1,!0));for(var k=0;k<b.length;k++)if(y===b[k].value){t.$emit("rp_tabs_selected_index_changed",k);break}S()}var M=t.$on("settings_changed",function(t){e.commentsDialog=n.settings.commentsDialog}),R=t.$on("user_sort_click",function(e,t){U=t,u(null,"/u/"+C+"/"+y,"sort="+U,!1,!1),"top"===U||"controversial"===U?a.show():a.hide(),S()}),T=t.$on("user_t_click",function(e,t){_=t,u(null,"/u/"+C+"/"+y,"sort="+U+"&t="+_,!1,!1),S()}),A=t.$on("rp_tab_click",function(r,i){e.posts={},e.noMorePosts=!1,y=i,u(null,"/u/"+C+"/"+y,"",!1,!1),e.havePosts=!1,t.$emit("progressLoading"),o(C,y,U,"",_,w,function(r,i){t.$emit("progressComplete"),r||(i.get.data.children.length<w&&(e.noMorePosts=!0),e.posts=i.get.data.children,e.havePosts=!0)}),"overview"===i||"submitted"===i||"comments"===i?v.show():v.hide()});e.thisController=this,this.completeDeleting=function(t){e.posts.forEach(function(r,i){r.data.name===t&&e.posts.splice(i,1)})},e.morePosts=function(){if(e.posts&&e.posts.length>0){var r=e.posts[e.posts.length-1].data.name;r&&!$&&($=!0,t.$emit("progressLoading"),o(C,y,U,r,_,w,function(r,i){t.$emit("progressComplete"),r||(i.get.data.children.length<w&&(e.noMorePosts=!0),Array.prototype.push.apply(e.posts,i.get.data.children),$=!1)}))}},e.$on("$destroy",function(){T(),R(),M(),A(),t.$emit("rp_tabs_hide")})}]),rpUserControllers.controller("rpUserSortCtrl",["$scope","$rootScope","$routeParams","rpUserFilterButtonUtilService",function(e,t,r,i){var o=t.$on("$routeChangeSuccess",function(){e.userSort=r.sort||"new"});e.selectSort=function(e){"top"===e||"controversial"===e?i.show():i.hide(),t.$emit("user_sort_click",e)},e.$on("$destroy",function(){o()})}]),rpUserControllers.controller("rpUserTimeFilterCtrl",["$scope","$rootScope","$routeParams",function(e,t,r){var i=t.$on("$routeChangeSuccess",function(){e.userTime=r.t||"all"});e.selectTime=function(e){t.$emit("user_t_click",e)},e.$on("$destroy",function(){i()})}]);var rpUtilServices=angular.module("rpUtilServices",[]);rpUtilServices.factory("rpGoogleUrlUtilService",["rpGoogleUrlResourceService",function(e){return function(t,r){e.save({longUrl:t},function(e){typeof e===Error?r(e,null):r(null,e)})}}]),rpUtilServices.factory("rpSearchUtilService",["$rootScope","rpSearchResourceService","rpLocationUtilService","rpToastUtilService",function(e,t,r,i){var o={};return o.params={q:"",sub:"all",type:"sr, link",sort:"relevance",t:"all",after:""},o.search=function(e){o.params.q?t.get({sub:o.params.sub,q:o.params.q,restrict_sub:o.params.restrict_sub,sort:o.params.sort,type:o.params.type,t:o.params.t,after:o.params.after,limit:o.params.limit},function(t){t.responseError?(i("Something went wrong with your search request :/"),e(t,null)):e(null,t)}):e(null,null)},o}]),rpUtilServices.factory("rpLocationUtilService",["$location","$window",function(e,t){return function(r,i,o,s,n){null!==r&&r.ctrlKey?(i=o?i+"?"+o:i,t.open(i)):(e.search(o),e.path(i,s),n&&e.replace())}}]),rpUtilServices.factory("rpSettingsUtilService",["$rootScope","rpSettingsResourceService","rpToastUtilService",function(e,t,r){var i={};return i.settings={over18:!0,composeDialog:!0,commentsDialog:!0,submitDialog:!0,settingsDialog:!0,theme:"default"},i.getSettings=function(){return i.settings},i.setSettings=function(e){i.settings=e,i.saveSettings()},i.retrieveSettings=function(){t.get(function(t){if(t.loadDefaults!==!0)for(var r in t)i.settings[r]=t[r];e.$emit("settings_changed")})},i.saveSettings=function(){t.save(i.settings,function(e){}),r("Setting Saved :)!"),e.$emit("settings_changed")},e.$on("authenticated",function(){i.retrieveSettings()}),i}]),rpUtilServices.factory("rpSearchFormUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("search_form_visibility",!0)},t.hide=function(){t.isVisible=!1,e.$emit("search_form_visibility",!1)},t}]),rpUtilServices.factory("rpSubscribeButtonUtilService",["$rootScope","rpSubredditsUtilService",function(e,t){var r={};return r.isVisible=!1,r.show=function(){r.isVisible=!0,e.$emit("subscribe_visibility")},r.hide=function(){r.isVisible=!1,t.resetSubreddit(),e.$emit("subscribe_visibility")},r}]),rpUtilServices.factory("rpUserSortButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("user_sort_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("user_sort_button_visibility")},t}]),rpUtilServices.factory("rpSidebarButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("rules_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("rules_button_visibility")},t}]),rpUtilServices.factory("rpUserFilterButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("user_filter_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("user_filter_button_visibility")},t}]),rpUtilServices.factory("rpPostFilterButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("post_filter_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("post_filter_button_visibility")},t}]),rpUtilServices.factory("rpSearchFilterButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("search_filter_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("search_filter_button_visibility")},t}]),rpUtilServices.factory("rpIdentityUtilService",["rpIdentityResourceService","rpAuthUtilService",function(e,t){var r={},i=[],o=!1;return r.identity=null,r.reloadIdentity=function(e){r.identity=null,r.getIdentity(e)},r.getIdentity=function(s){t.isAuthenticated?null!==r.identity?s(r.identity):(i.push(s),o===!1&&(o=!0,e.get(function(e){r.identity=e,o=!1;for(var t=0;t<i.length;t++)i[t](r.identity);i=[]}))):s(null)},r}]),rpUtilServices.factory("rpAuthUtilService",["$rootScope","rpSettingsUtilService",function(e,t){var r={};return r.isAuthenticated=!1,r.setIdentity=function(e){r.identity=e},r.setAuthenticated=function(t){r.isAuthenticated=t,e.$emit("authenticated")},r}]),rpUtilServices.factory("rpToastUtilService",["$mdToast",function(e){return function(t){e.show({locals:{toastMessage:t},controller:"rpToastCtrl",templateUrl:"partials/rpToast",hideDelay:2500,position:"top left"})}}]),rpUtilServices.factory("rpGildUtilService",["rpGildResourceService","rpToastUtilService",function(e,t){return function(r,i){e.save({fullname:r},function(e){if(e.responseError){var r=JSON.parse(e.body);t("INSUFFICIENT_CREDDITS"===r.reason?"You aint got no creddits in your reddit account :/":"Something went wrong trying to gild this post :/"),i(e,null)}else t("gilded post is gilded :)"),i(null,e)})}}]),rpUtilServices.factory("rpEditUtilService",["rpEditResourceService","rpToastUtilService",function(e,t){return function(r,i,o){e.save({text:r,thing_id:i},function(e){e.responseError?(t("Something went wrong trying to edit your post :/"),o(e,null)):(t("Post Editted"),o(null,e))})}}]),rpUtilServices.factory("rpDeleteUtilService",["rpAuthUtilService","rpDeleteResourceService","rpToastUtilService",function(e,t,r){return function(e,i){t.save({id:e},function(e){e.responseError?(r("Something went wrong trying to delete your post :/"),i(e,null)):(r("Post deleted"),i(null,e))})}}]),rpUtilServices.factory("rpSaveUtilService",["rpSaveResourceService","rpUnsaveResourceService",function(e,t){return function(r,i,o){var s=i?e:t;s.save({id:r},function(e){e.responseError?o(e,null):o(null,e)})}}]),rpUtilServices.factory("rpVoteUtilService",["rpAuthUtilService","rpToastUtilService","rpVoteResourceService",function(e,t,r){return function(e,t,i){r.save({id:e,dir:t},function(e){e.responseError?i(e,null):i(null,e)})}}]),rpUtilServices.factory("rpCommentUtilService",["rpAuthUtilService","rpCommentResourceService","rpToastUtilService",function(e,t,r){var i=!1;return function(o,s,n){e.isAuthenticated?s&&!i&&(i=!0,t.save({parent_id:o,text:s},function(e){if(i=!1,e.responseError){var t="Something went wrong trying to post you comment :/";if(e.body){var o=JSON.parse(e.body);"TOO_OLD"===o.json.errors[0][0]&&(t=o.json.errors[0][1])}r(t),n(e,null)}else r("Comment Posted :)"),n(null,e)})):r("You've got to log in to post comments")}}]),rpUtilServices.factory("rpMessageComposeUtilService",["rpAuthUtilService","rpMessageComposeResourceService","rpToastUtilService",function(e,t,r){return function(i,o,s,n,a,l){e.isAuthenticated?t.save({subject:i,text:o,to:s,iden:n,captcha:a},function(e){e.responseError?(r("Something went wrong trying to send your message :/"),l(e,null)):l(null,e)}):r("You've got to log in send messages.")}}]),rpUtilServices.factory("rpSubmitUtilService",["rpAuthUtilService","rpSubmitResourceService","rpToastUtilService",function(e,t,r){return function(i,o,s,n,a,l,c,u,p,d){e.isAuthenticated?t.save({kind:i,sendreplies:s,sr:n,text:a,title:l,url:c,resubmit:o,iden:u,captcha:p},function(e){e.responseError?d(e,null):d(null,e)}):r("You've got to log in to submit links.")}}]),rpUtilServices.factory("rpShareEmailUtilService",["rpShareEmailResourceService","rpToastUtilService",function(e,t){return function(r,i,o,s){e.save({to:r,text:i,subject:o},function(e){e.responseError?(t("Something went wrong trying to send your email :/"),s(e,null)):(t("Email Sent :)"),s(null,e))})}}]),rpUtilServices.factory("rpCaptchaUtilService",["rpAuthUtilService","rpToastUtilService","rpNeedsCaptchaResourceService","rpNewCaptchaResourceService","rpCaptchaResourceService",function(e,t,r,i,o){var s={};return s.needsCaptcha=function(e){r.get(function(t){t.responseError?e(t,null):e(null,t)})},s.newCaptcha=function(e){i.save(function(t){t.responseError?e(t,null):e(null,t)})},s.captcha=function(e,t){o.get({iden:e},function(e){e.responseError?t(e,null):t(null,e)})},s}]),rpUtilServices.factory("rpSubredditsUtilService",["$rootScope","rpSubredditsResourceService","rpSubredditsMineResourceService","rpSubbscribeResourceService","rpSubredditAboutResourceService","rpAuthUtilService","rpToastUtilService",function(e,t,r,i,o,s,n){function a(t){r.get({limit:h},function(r){r.responseError?(n("Something went wrong updating your subreddits."),t(r,null)):r.get.data.children.length>0?(m.subs=r.get.data.children,r.get.data.children.length<h?(e.$emit("subreddits_updated"),p(),t(null,r)):l(r.get.data.children[r.get.data.children.length-1].data.name,t)):c(t)})}function l(t,i){r.get({limit:h,after:t},function(t){t.responseError?(n("Something went wrong updating your subreddits."),i(t,null)):(m.subs=m.subs.concat(t.get.data.children),t.get.data.children.length<h?(e.$emit("subreddits_updated"),p(),i(null,t)):l(t.get.data.children[t.get.data.children.length-1].data.name,i))})}function c(r){t.get({limit:h},function(t){t.responseError?(n("Something went wrong updating your subreddits."),r(t,null)):(m.subs=t.get.data.children,e.$emit("subreddits_updated"),p(),r(null,t))})}function u(e){if("undefined"==typeof e&&(e=m.currentSub),m.subs.length>0&&""!==e){for(var t=0;t<m.subs.length;t++)if(m.subs[t].data.display_name.toLowerCase()===e.toLowerCase())return!0;return!1}return null}function p(){var t=m.subscribed;m.subscribed=u(),m.subscribed!==t&&e.$emit("subscription_status_changed",m.subscribed)}function d(){o.get({sub:m.currentSub},function(t){t.responseError||(m.about=t,e.$emit("subreddits_about_updated"))})}var m={};m.subs=[],m.currentSub="",m.about={},m.subscribed=null;var h=100;return m.updateSubreddits=function(e){s.isAuthenticated?a(e):c(e)},m.updateSubreddits(function(){if(s.isAuthenticated){for(var e=!1,t="t5_3cawe",r=0;r<m.subs.length;r++)m.subs[r].data.name===t&&(e=!0);e||m.subscribe("sub",t,function(){})}}),m.resetSubreddit=function(){m.currentSub="",m.subscribed=null,m.about={}},m.setSubreddit=function(e){e&&m.currentSub!==e&&(m.currentSub=e,p(),d())},m.subscribeCurrent=function(e){var t=m.subscribed?"unsub":"sub";i.save({action:t,sr:m.about.data.name},function(t){t.responseError?e(t,null):m.updateSubreddits(function(t,r){t?e(r,null):e(null,r)})})},m.subscribe=function(e,t,r){s.isAuthenticated?i.save({action:e,sr:t},function(e){e.responseError||m.updateSubreddits(function(e,t){e?r(t,null):r(null,t)})}):n("You've got to log in to subscribed to subreddits")},m.isSubscribed=function(e){return u(e)},m}]),rpUtilServices.factory("rpPostsUtilService",["$rootScope","rpPostsResourceService","rpFrontpageResourceService","rpToastUtilService","rpLocationUtilService",function(e,t,r,i,o){return function(e,s,n,a,l,c){e?t.get({sub:e,sort:s,after:n,t:a,limit:l},function(e){if(e.responseError)if(302===e.status){var t=/https:\/\/oauth\.reddit\.com\/r\/([\w]+)*/i,r=t.exec(e.body);r[1]&&o(null,"/r/"+r[1],"",!0,!0)}else i("Something went wrong retrieving posts :/"),o(null,"/error/"+e.status,"",!0,!0);else c(null,e)}):r.get({sort:s,after:n,t:a,limit:l},function(e){e.responseError?(i("Something went wrong retrieving posts :/"),o(null,"/error/"+e.status,"",!0,!0)):c(null,e)})}}]),rpUtilServices.factory("rpMessageUtilService",["rpMessageResourceService","rpToastUtilService",function(e,t){return function(r,i,o,s){e.get({where:r,after:i,limit:o},function(e){e.responseError?(t("Something went wrong retrieving your messages :/"),s(e,null)):s(null,e)})}}]),rpUtilServices.factory("rpCommentsUtilService",["rpCommentsResourceService",function(e){return function(t,r,i,o,s,n){e.get({subreddit:t,article:r,sort:i,comment:o,context:s},function(e){e.responseError?n(e,null):n(null,e)})}}]),rpUtilServices.factory("rpMoreChildrenUtilService",["rpMoreChildrenResourceService",function(e){return function(t,r,i,o){e.get({sort:t,link_id:r,children:i},function(e){e.responseError?o(e,null):o(null,e)})}}]),rpUtilServices.factory("rpUserUtilService",["rpUserResourceService","rpToastUtilService",function(e,t){return function(r,i,o,s,n,a,l){e.get({username:r,where:i,sort:o,after:s,t:n,limit:a},function(e){e.responseError?(t("Something went wrong retrieving the user's posts :/"),l(e,null)):l(null,e)})}}]),rpUtilServices.factory("rpByIdUtilService",["rpByIdResourceService",function(e){return function(t,r){e.get({name:t},function(e){e.responseError?r(e,null):r(null,e)})}}]),rpUtilServices.factory("rpReadAllMessagesUtilService",["$timeout","rpReadAllMessagesResourceService",function(e,t){return function(r){function i(){o>0&&e(t.save({},function(e){e.responseError?(o-=1,i(),r(e,null)):(o=3,r(null,e))}),10*s-o)}var o=9,s=2e3;i()}}]),rpUtilServices.factory("rpReadMessageUtilService",["rpReadMessageResourceService",function(e){return function(t,r){e.save({message:t},function(e){e.responseError?r(e,null):r(null,e)})}}]),rpUtilServices.factory("rpToolbarShadowUtilService",["$rootScope",function(e){var t={};return t.showToolbarShadow=!1,t.show=function(){t.showToolbarShadow=!0,e.$broadcast("show_toolbar_shadow_change")},t.hide=function(){t.showToolbarShadow=!1,e.$broadcast("show_toolbar_shadow_change")},t}]);