"use strict";function insertComment(e,t){for(var r=0;r<t.length;r++)e.data.parent_id===t[r].data.name?t[r].data.replies&&""!==t[r].data.replies?t[r].data.replies.data.children.push(e):t[r].data.replies={data:{children:[e]}}:e.data.name===t[r].data.parent_id?(e.data.replies={data:{children:[t[r]]}},t.splice(r,1),t.push(e)):t[r].data.replies&&""!==t[r].data.replies&&(t[r].data.replies.children=insertComment(e,t[r].data.replies.data.children));return t}var rpArticleControllers=angular.module("rpArticleControllers",[]);rpArticleControllers.controller("rpArticleTabsCtrl",["$scope","$timeout",function(e,t){console.log("[rpArticleTabsCtrl]"),e.tabClick=function(r){console.log("[rpArticleTabsCtrl] tabClick(), tab: "+r),t(function(){e.parentCtrl.tabClick(r)},350)}}]),rpArticleControllers.controller("rpArticleButtonCtrl",["$scope","$rootScope","$filter","$mdDialog","rpSettingsUtilService","rpLocationUtilService",function(e,t,r,o,i,s){e.showArticle=function(t,n){console.log("[rpArticleButtonCtrl] $scope.showArticle(), comment: "+c);var l,a,c,p;if(e.post)console.log("[rpArticleButtonCtrl] $scope.showArticle() post, isComment: "+e.isComment),l=e.isComment?r("rp_name_to_id36")(e.post.data.link_id):e.post.data.id,console.log("[rpArticleButtonCtrl] $scope.showArticle() article: "+l),a=e.post.data.subreddit,console.log("[rpArticleButtonCtrl] $scope.showArticle() subreddit: "+a),c=e.isComment?e.post.data.id:"",p="#"+e.post.data.name;else if(e.message){console.log("[rpArticleButtonCtrl] $scope.showArticle() message.");var u=/^\/r\/([\w]+)\/comments\/([\w]+)\/(?:[\w]+)\/([\w]+)/,d=u.exec(e.message.data.context);d&&(a=d[1],l=d[2],c=d[3]),p="#"+e.message.data.name}if(console.log("[rpArticleButtonCtrl] $scope.showArticle(), comment: "+c),i.settings.commentsDialog&&!t.ctrlKey)console.log("[rpArticleButtonCtrl] anchor: "+p),o.show({controller:"rpArticleDialogCtrl",templateUrl:"partials/rpArticleDialog",targetEvent:t,locals:{post:e.isComment?void 0:e.post,article:l,comment:n?c:"",subreddit:a},clickOutsideToClose:!0,escapeToClose:!1});else{console.log("[rpArticleButtonCtrl] $scope.showArticle() dont open in dialog.");var g="",m="/r/"+a+"/comments/"+l;n&&(m+="/"+c+"/",g="context=8"),s(t,m,g,!0,!1)}}}]),rpArticleControllers.controller("rpArticleDialogCtrl",["$scope","$rootScope","$location","$filter","$mdDialog","post","article","comment","subreddit",function(e,t,r,o,i,s,n,l,a,c){console.log("[rpArticleDialogCtrl]"),e.dialog=!0,e.post=s,e.article=n,e.comment=l,e.subreddit=a,console.log("[rpArticleDialogCtrl] $scope.article: "+e.article),console.log("[rpArticleDialogCtrl] $scope.subreddit: "+e.subreddit),console.log("[rpArticleDialogCtrl] $scope.comment: "+e.comment),angular.isUndefined(e.post)||console.log("[rpArticleDialogCtrl] $scope.post.data.title: "+e.post.data.title);var p=e.$on("$locationChangeSuccess",function(){i.hide()});e.$on("destroy",function(){p()})}]),rpArticleControllers.controller("rpArticleCtrl",["$scope","$rootScope","$routeParams","$timeout","$filter","$q","rpCommentsUtilService","rpTitleChangeService","rpPostFilterButtonUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSubscribeButtonUtilService","rpSubredditsUtilService","rpLocationUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpToolbarShadowUtilService","rpIdentityUtilService","rpAuthUtilService","rpSidebarButtonUtilService",function(e,t,r,o,i,s,n,l,a,c,p,u,d,g,m,h,S,f,b,v){function C(t){e.postLoading=!0,n(e.subreddit,e.article,e.sort,e.cid,e.context,function(r,o){r?console.log("[rpArticleCtrl] err"):(console.log("[rpArticleCtrl] success"),e.post=o.data[0].data.children[0],e.postLoading=!1,e.editing=!1,t&&t())})}function $(){e.comments=[],n(e.subreddit,e.article,e.sort,e.cid,e.context,function(r,i){t.$emit("progressComplete"),e.commentsLoading=!1,r?console.log("[rpArticleCtrl] err"):(e.post=e.post||i.data[0].data.children[0],o(angular.noop,0),console.log("[rpArticleCtrl] $scope.post.data.name: "+e.post.data.name),e.threadLoading=!1,i.data[1].data.children.length>0?e.haveComments=!0:(e.haveComments=!1,e.noMorePosts=!0),e.haveComments&&(b.isAuthenticated?f.getIdentity(function(t){e.identity=t,e.isMine=e.post.data.author===e.identity.name,console.log("[rpArticleCtrl] comments data.length: "+i.data[1].data.children.length),w(i.data[1].data.children,3)}):w(i.data[1].data.children,3)),"[deleted]"===e.post.data.author.toLowerCase()&&(e.deleted=!0))})}function w(t,r){function i(e,t){for(var r=0;r<e.length;r++){var o=e[r];o.depth=t,n(o,u),o.data.replies&&""!==o.data.replies&&o.data.replies.data.children.length>0&&i(o.data.replies.data.children,t+1),p[u]&&p[u].rendered===!1&&(p[u].rendered=!0,u++)}}function n(e,t){if(p[t]){for(var o=p[t].rootComment,i=0,s=p[t].batchSize;o.data.replies&&""!==o.data.replies&&o.data.replies.data.children.length>0&&s>i;)o=o.data.replies.data.children[0],i++;(void 0===o.data.replies||""===o.data.replies||0===o.data.replies.data.children.length)&&(o.data.replies={data:{children:[]}});var n=JSON.parse(JSON.stringify(e));n.data.replies="",o.data.replies.data.children.push(n),p[t].batchSize++}else{var l=JSON.parse(JSON.stringify(e));l.data.replies="",p[t]={rootComment:l,batchSize:0,rendered:!1}}p[t].batchSize===r&&(p[t].rendered=!0,u++)}function l(t){if(console.log("[rpArticleCtrl] renderSuperBatch() loadAll: "+t),t)for(;m<p.length;m++)a(m);else{for(var r=0;h>r;r++)a(m+r);m+=h,console.log("[rpArticleCtrl] renderSuperBatch(), renderedBatch: "+m+", batches.length: "+p.length),m>=p.length&&(e.showLoadAll=!1,console.log("[rpArticleCtrl] renderSuperBatch(), showLoadAll: "+e.showLoadAll),e.noMorePosts=!0)}}function a(e){return console.log("[rpArticleCtrl] addBatchAndRender() batchIndex: "+e),d=angular.bind(null,c,e),g=g.then(d)}function c(t){if(p[t]){var r=p[t].rootComment,i=r.depth;if(0===i)o(function(){e.comments.push(r)},0);else{var s=e.comments[e.comments.length-1],n=0;if(void 0!==s){for(;s.data.replies&&""!==s.data.replies&&s.data.replies.data.children.length>0&&i>n;)s=s.data.replies.data.children[s.data.replies.data.children.length-1],n++;(void 0===s.data.replies||""===s.data.replies||0===s.data.replies.data.children.length)&&(s.data.replies={data:{children:[]}}),o(function(){s.data.replies.data.children.push(r)},0)}}return o(angular.noop,0)}}var p=[],u=0;e.comments=[];var d,g=s.when(),m=0,h=3;console.time("addComments"),i(t,0),l(!1),console.timeEnd("addComments"),o(function(){e.showLoadAll!==!1&&(e.showLoadAll=!0)},1e3),e.morePosts=function(){console.log("[rpArticleCtrl] morePosts()"),l(!1)},e.loadAllComments=function(){e.showLoadAll=!1,l(!0)}}console.log("[rpArticleCtrl] loaded."),console.log("[rpArticleCtrl] load, $scope.article: "+e.article),console.log("[rpArticleCtrl] load, $scope.subreddit: "+e.subreddit),console.log("[rpArticleCtrl] load, $scope.comment: "+e.comment),angular.isUndefined(e.post)||console.log("[rpArticleCtrl] load, $scope.post.data.title: "+e.post.data.title),angular.isUndefined(e.article)&&(e.article=r.article),angular.isUndefined(e.subreddit)&&(e.subreddit=r.subreddit);var y=/^\w{7}$/;angular.isUndefined(e.comment)?r.comment&&y.test(r.comment)?e.cid=r.comment:e.cid="":e.cid=e.comment,r.context?e.context=r.context:angular.isUndefined(e.cid)?e.context=0:e.context=8,e.sort=r.sort||"confidence",console.log("[rpArticleCtrl] $scope.article: "+e.article),console.log("[rpArticleCtrl] $scope.subreddit: "+e.subreddit),console.log("[rpArticleCtrl] $scope.cid: "+e.cid),console.log("[rpArticleCtrl] $scope.context: "+e.context),console.log("[rpArticleCtrl] $scope.sort: "+e.sort),e.isMine=null,e.dialog||(a.hide(),c.hide(),p.hide(),m.hide(),h.hide(),u.show(),S.hide(),v.show(),l.prepTitleChange("r/"+e.subreddit),d.setSubreddit(e.subreddit));var U=e.tabs=[{label:"best",value:"confidence"},{label:"top",value:"top"},{label:"new",value:"new"},{label:"hot",value:"hot"},{label:"controvesial",value:"controversial"},{label:"old",value:"old"},{label:"q&a",value:"qa"}];e.dialog||(t.$emit("rp_tabs_changed",U),t.$emit("rp_tabs_show"));for(var _=0;_<U.length;_++)if(e.sort===U[_].value){e.dialog?e.selectedTab=_:t.$emit("rp_tabs_selected_index_changed",_);break}e.threadLoading=!0,e.commentsLoading=!1,e.post||t.$emit("progressLoading"),$(),e.thisController=this,this.completeReplying=function(t,r){this.isReplying=!1,console.log("[rpArticleCtrl] this.completeReplying(), $scope.comments: "+e.comments),e.comments.unshift(t.json.data.things[0]),e.haveComments===!1&&(e.haveComments=!0)},this.completeDeleting=function(t){console.log("[rpArticleCtrl] this.completeDelete()"),this.isDeleting=!1,e.deleted=!0},this.completeEditing=function(){console.log("[rpArticleCtrl] this.completeEdit()");var e=this;C(function(){e.isEditing=!1})};var k=!1;this.tabClick=function(t){console.log("[rpArticleCtrl] this.tabClick()"),k?(e.sort=t,e.dialog||g(null,"/r/"+e.subreddit+"/comments/"+e.article,"sort="+e.sort,!1,!1),e.commentsLoading=!0,$()):(console.log("[rpArticleCtrl] this.tabClick(), tabClick() ignored"),k=!0)};var A=t.$on("rp_tab_click",function(t,r){console.log("[rpArticleCtrl] this.tabClick()"),e.sort=r,e.dialog||g(null,"/r/"+e.subreddit+"/comments/"+e.article,"sort="+e.sort,!1,!1),e.commentsLoading=!0,$()});e.$on("$destroy",function(){A()})}]);var rpCaptchaControllers=angular.module("rpCaptchaControllers",[]);rpCaptchaControllers.controller("rpCaptchaCtrl",["$scope","$rootScope","rpCaptchaUtilService",function(e,t,r){function o(){r.needsCaptcha(function(t,r){t?console.log("[rpCaptchaCtrl] err"):(console.log("[rpCaptchaCtrl] rpCaptcha needsCaptcha, JSON.stringify(data): "+JSON.stringify(r)),e.needsCaptcha=r.needsCaptcha,e.needsCaptcha&&i())})}function i(){e.iden="",e.captcha="",e.showCaptchaProgress=!0,r.newCaptcha(function(t,r){t?console.log("[rpCaptchaCtrl] err"):(e.iden=r.json.data.iden,e.captchaImage="http://www.reddit.com/captcha/"+e.iden+".png",e.showCaptchaProgress=!1)})}console.log("[rpCaptchaCtrl] rpCaptcha loaded"),e.needsCaptcha=!1,e.captchaImage="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",o(),e.reloadCaptcha=function(){e.showCaptchaProgress=!0,o(),console.log("[rpCaptchaCtrl] reloadCaptcha, $scope.$parent.captcha: "+e.captcha)};var s=t.$on("successful_captcha",function(){e.showBadCaptcha=!1,e.needsCaptcha=!1}),n=t.$on("reset_captcha",function(){o()});e.$on("$destroy",function(){s(),n()})}]);var rpCommentControllers=angular.module("rpCommentControllers",[]);rpCommentControllers.controller("rpCommentCtrl",["$scope","$rootScope","$element","$compile","$filter","$timeout","rpMoreChildrenUtilService","rpIdentityUtilService","rpAuthUtilService","rpCommentsUtilService",function(e,t,r,o,i,s,n,l,a,c){function p(t){console.log("[rpCommentCtrl] reloadComment()"),c(e.comment.data.subreddit,i("rp_name_to_id36")(e.comment.data.link_id),"hot",e.comment.data.id,0,function(r,o){r?console.log("[rpCommentCtrl] err"):(e.comment=o.data[1].data.children[0],e.isEditing=!1,t&&t())})}e.thisController=this,e.isDeleted=e.comment&&void 0!==e.comment.data.author&&void 0!==e.comment.data.body&&"[deleted]"===e.comment.data.author&&"[deleted]"===e.comment.data.body,e.childDepth=e.depth+1,e.isChildrenCollapsed=!1,e.isLoadingMoreChildren=!1,e.isMine=e.identity?e.comment.data.author===e.identity.name:!1,e.isFocussed=e.cid===e.comment.data.id,e.isOp=e.post?e.comment.data.author===e.post.data.author:!1,e.isComment="t1"===e.comment.kind,e.isShowMore="more"===e.comment.kind&&e.comment.data.count>0,e.isContinueThread="more"===e.comment.kind&&0===e.comment.data.count&&e.comment.data.children.length>0,e.currentComment=e.comment,e.hasChildren=function(){return void 0!==e.comment.data.replies&&""!==e.comment.data.replies&&0!==e.comment.data.replies.data.children.length},e.thisController=this,this.completeReplying=function(t,r){this.isReplying=!1,console.log("[rpCommentCtrl] this.completeReplying()"),e.comment.data.replies?(e.isChildrenCollapsed===!0&&e.expandChildren(),e.comment.data.replies.data.children.unshift(t.json.data.things[0])):(e.childDepth=e.depth+1,e.comment.data.replies={data:{children:t.json.data.things}},e.hasChildren=!0)},this.completeDeleting=function(t){console.log("[rpCommentCtrl] this.completeDelete()"),this.isDeleting=!1,e.isDeleted=!0},this.completeEditing=function(){console.log("[rpCommentCtrl] this.completeEdit()");var e=this;p(function(){e.isEditing=!1})},e.collapseChildren=function(){s(function(){e.isChildrenCollapsed=!0},300)},e.expandChildren=function(){s(function(){e.isChildrenCollapsed=!1},300)},e.showMore=function(){e.isLoadingMoreChildren=!0,e.sort||(e.sort="confidence"),n(e.sort,e.post.data.name,e.comment.data.children.join(","),function(t,r){if(e.isLoadingMoreChildren=!1,t)console.log("[rpCommentCtrl] err loading more children.");else if(r.json.data.things.length>0){var o=new Array(0);o[0]=r.json.data.things[0],console.log("[rpCommentCtrl] showmore, data: "+JSON.stringify(r)),console.log("[rpCommentCtrl] showmore, children[0].length: "+o[0].length);for(var i=1;i<r.json.data.things.length;i++)console.log("[rpCommentCtrl] do you even for loop bro: "+i),o=insertComment(r.json.data.things[i],o),r.json.data.things[i].data.parent_id===e.comment.data.parent_id&&o.push(r.json.data.things[i]);if(e.parent.data&&e.parent.data.replies&&""!==e.parent.data.replies&&e.parent.data.replies.data.children.length>1){console.log("[rpCommentCtrl] replcae showmore and add showmore children tree to parent");for(var s=0;s<e.parent.data.replies.data.children.length&&(console.log("[rpCommentCtrl] showmore, replacing showmore, $scope.parent.data.replies.data.children[index].data.name: "+e.parent.data.replies.data.children[s].data.name),console.log("[rpCommentCtrl] showmore, replacing showmore, $scope.comment.data.name: "+e.comment.data.name),e.parent.data.replies.data.children[s].data.name!==e.comment.data.name);s++);console.log("[rpCommentCtrl] showmore, replacing showmore, index: "+s),e.parent.data.replies.data.children.splice.apply(e.parent.data.replies.data.children,[s,1].concat(o))}else console.log("[rpCommentCtrl] replace parent children with showmore children tree"),e.parent.data.replies={data:{children:o}}}else console.log("[rpCommentCtrl] showmore, no comments returned, pop the showmore"),e.parent.data.replies.data.children.pop()})}}]);var rpControllers=angular.module("rpControllers",[]);rpControllers.controller("rpAppCtrl",["$scope","$rootScope","$timeout","$mdSidenav","$mdMedia","$log","rpTitleChangeService","rpAuthUtilService",function(e,t,r,o,i,s,n,l){console.log("[rpAppCtrl] $scope.authenticated: "+e.authenticated),e.isDocked=!0;var a=e.$on("handleTitleChange",function(t,r){e.appTitle=n.title});e.setAuthentication=function(t){console.log("[rpAppCtrl] setAuthentication(), $scope.authenticated: "+t),e.authenticated=t,l.setAuthenticated(t)},e.sidenavIsOpen=function(){return o("left").isOpen()},e.toggleLeft=function(){o("left").toggle()},e.close=function(){o("left").close()},e.isOpenRules=function(){return o("right").isOpen()},e.toggleRules=function(){o("right").toggle()},e.suspendWatchers=function(){t.$emit("rp_suspendable_suspend")},e.restoreWatchers=function(){t.$emit("rp_suspendable_resume")},e.simpleSuspendWatchers=function(){t.$emit("rp_simple_suspendable_suspend")},e.simpleRestoreWatchers=function(){t.$emit("rp_simple_suspendable_restore")};var c=e.$on("$locationChangeSuccess",function(){o("left").isOpen()&&o("left").toggle(),o("right").isOpen()&&o("right").toggle()});e.$on("$destroy",function(){a(),c()})}]),rpControllers.controller("rpIdentitySidenavCtrl",["$scope","rpIdentityUtilService","rpAuthUtilService",function(e,t,r){e.loading=!0,t.getIdentity(function(t){console.log("[rpIdentityCtrl] identity: "+JSON.stringify(t)),e.identity=t,e.loading=!1})}]),rpControllers.controller("rpLoginSidenavCtrl",["$scope","$location",function(e,t){e.safePath=encodeURIComponent(t.path()),console.log("[rpLoginCtrl] $scope.safePath: "+e.safePath);var r=e.$on("$locationChangeSuccess",function(){e.safePath=encodeURIComponent(t.path()),console.log("[rpLoginCtrl] onLocationChangeSuccess, $scope.safePath: "+e.safePath)});e.$on("$destroy",function(){r()})}]),rpControllers.controller("rpSubredditsSidenavCtrl",["$scope","$rootScope","$timeout","$q","$mdSidenav","rpSubredditsUtilService","rpLocationUtilService","$compile",function(e,t,r,o,i,s,n,l){e.subs=[],e.isOpen=!1,e.toggleOpen=function(){r(function(){e.isOpen=!e.isOpen},250)},e.pinnedSubs=[{name:"frontpage",url:"/"},{name:"all",url:"/r/all/"},{name:"random",url:"/r/random/"},{name:"reddupco",url:"/r/reddupco"}];var a=t.$on("subreddits_updated",function(){e.subs=s.subs});e.openSubreddit=function(e,t){console.log("[rpSubredditsCtrl] openSubreddit, url: "+t),r(function(){n(e,t,"",!0,!1)},350)},e.$on("$destroy",function(){a()})}]),rpControllers.controller("rpToastCtrl",["$scope","$rootScope","$mdToast","toastMessage",function(e,t,r,o){e.toastMessage=o,e.closeToast=function(){r.close()}}]),rpControllers.controller("rpToolbarCtrl",["$scope","$rootScope","$log","$element","rpTitleChangeService","rpPostFilterButtonUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpSidebarButtonUtilService","rpToolbarShadowUtilService",function(e,t,r,o,i,s,n,l,a,c,p,u){e.linkTitle=!1,e.isOpen=!1,e.count=0,e.showToolbarShadow=u.showToolbarShadow;var d=/r\/[\w]+/,g=/u\/[\w]+/,m=e.$on("show_toolbar_shadow_change",function(){e.showToolbarShadow=u.showToolbarShadow}),h=e.$on("handleTitleChange",function(t,r){console.log("[rpToolbarCtrl] handleTitleChange(), rpTitleChangeService.title: "+i.title),e.toolbarTitle=i.title,e.linkTitle=d.test(i.title)||g.test(i.title),console.log("[rpToolbarCtrl] handleTitleChange(), $scope.linkTitle: "+e.linkTitle)});e.showPostFilter=s.isVisible;var S=t.$on("post_filter_button_visibility",function(){e.showPostFilter=s.isVisible});e.showUserFilter=n.isVisible;var f=t.$on("user_filter_button_visibility",function(){e.showUserFilter=n.isVisible});e.showUserSort=l.isVisible;var b=t.$on("user_sort_button_visibility",function(){e.showUserSort=l.isVisible});e.showSearchFilter=c.isVisible;var v=t.$on("search_filter_button_visibility",function(){e.showSearchFilter=c.isVisible});e.showRules=p.isVisible;var C=t.$on("rules_button_visibility",function(){e.showRules=p.isVisible});e.toggleSearchForm=function(){e.showSearchForm=!e.showSearchForm},e.showSearchForm=a.isVisible;var $=t.$on("search_form_visibility",function(){});e.$on("$destroy",function(){m(),$(),S(),f(),b(),v(),C(),h()})}]),rpControllers.controller("rpSubscribeCtrl",["$scope","$rootScope","rpSubredditsUtilService","rpSubscribeButtonUtilService",function(e,t,r,o){console.log("[rpSubscribeCtrl] loaded"),e.subscribed=r.subscribed,e.loadingSubscription=!1,e.toggleSubscription=function(){console.log("[rpSubscribeCtrl] toggleSubscription"),e.loadingSubscription=!0,r.subscribeCurrent(function(e,t){e&&console.log("[rpSubscribeCtrl] err")})},e.showSubscribe=o.isVisible;var i=t.$on("subscribe_visibility",function(){e.showSubscribe=o.isVisible}),s=t.$on("subscription_status_changed",function(t,r){console.log("[rpSubscribeCtrl] on subscription_status_changed, subscribed: "+r),e.loadingSubscription&&(e.loadingSubscription=!1),e.subscribed=r});e.$on("$destroy",function(){s(),i()})}]),rpControllers.controller("rpErrorCtrl",["$scope","$rootScope","$routeParams","rpSubscribeButtonUtilService","rpTitleChangeService",function(e,t,r,o,i){t.$emit("progressComplete"),o.hide(),i.prepTitleChange("oops"),e.errorCode=parseInt(r.errorcode)||404,console.log("[rpErrorCtrl] $scope.errorCode: "+e.errorCode),404===e.errorCode?e.message="Did not find the page you're looking four-oh-four.":403===e.errorCode?e.message="Page is forbidden :/ Maybe you have to message the mods for permission.":e.message="Oops an error occurred."}]),rpControllers.controller("rpSidebarCtrl",["$scope","$rootScope","rpSubredditsUtilService",function(e,t,r){e.about=r.about.data;var o=t.$on("subreddits_about_updated",function(){console.log("[rpSidebarCtrl] subreddits_about_updated"),e.about=r.about.data});e.$on("$destroy",function(){o()})}]),rpControllers.controller("rpFormattingCtrl",["$scope",function(e){e.formattingIsOpen=!1,e.toggleFormatting=function(t){console.log("[rpFormattingCtrl] toggleFormatting()"),e.formattingIsOpen=!e.formattingIsOpen}}]);var rpDeleteControllers=angular.module("rpDeleteControllers",[]);rpDeleteControllers.controller("rpDeleteButtonCtrl",["$scope",function(e){e.parentCtrl.isDeleting=!1,e.toggleDeleting=function(t){console.log("[rpDeleteButtonCtrl] toggleDeleting()"),e.parentCtrl.isDeleting=!e.parentCtrl.isDeleting}}]),rpDeleteControllers.controller("rpDeleteFormCtrl",["$scope","rpDeleteUtilService",function(e,t){console.log("[rpDeleteFormCtrl] $scope.$id: "+e.$id),e.isDeleteInProgress=!1,e.submit=function(){console.log("[rpDeleteFormCtrl] confirmDelete(), $scope.redditId: "+e.redditId),e.isDeleteInProgress=!0,t(e.redditId,function(t,r){e.isDeleteInProgress=!1,t?console.log("[rpDeleteCtrl] err"):e.parentCtrl.completeDeleting(e.redditId)})}}]);var rpDirectives=angular.module("rpDirectives",[]);rpDirectives.directive("rpSidenavContent",function(){return{restrict:"E",replace:!0,templateUrl:"partials/rpSidenavContent"}}),rpDirectives.directive("rpToolbar",function(){return{restrict:"E",templateUrl:"partials/rpToolbar",controller:"rpToolbarCtrl"}}),rpDirectives.directive("rpSearchForm",function(){return{restrict:"E",templateUrl:"partials/rpSearchForm",replace:!0}}),rpDirectives.directive("rpSearchSidenavForm",function(){return{restrict:"E",templateUrl:"partials/rpSearchSidenavForm",replace:!0}}),rpDirectives.directive("rpGilded",function(){return{restrict:"E",templateUrl:"partials/rpGilded",scope:{parentCtrl:"=",author:"=",gilded:"="}}}),rpDirectives.directive("rpArticleContextButton",function(){return{restrict:"E",templateUrl:"partials/rpArticleContextButton",controller:"rpArticleButtonCtrl",scope:{parentCtrl:"=",post:"=",isComment:"=",message:"="}}}),rpDirectives.directive("rpArticleButton",function(){return{restrict:"E",templateUrl:"partials/rpArticleButton",controller:"rpArticleButtonCtrl",scope:{parentCtrl:"=",post:"=",isComment:"=",message:"="}}}),rpDirectives.directive("rpTabs",[function(){return{restrict:"E",templateUrl:"partials/rpTabs",controller:"rpTabsCtrl",replace:!0}}]),rpDirectives.directive("rpArticleTabs",function(){return{restrict:"E",templateUrl:"partials/rpArticleTabs",controller:"rpArticleTabsCtrl",replace:!0,scope:{parentCtrl:"=",tabs:"=",selectedIndex:"="}}}),rpDirectives.directive("rpShareButton",function(){return{restrict:"E",templateUrl:"partials/rpShareButton",controller:"rpShareButtonCtrl",scope:{post:"="}}}),rpDirectives.directive("rpGildButton",function(){return{restrict:"E",templateUrl:"partials/rpGildButton",controller:"rpGildButtonCtrl",scope:{redditId:"=",gilded:"="}}}),rpDirectives.directive("rpSaveButton",function(){return{restrict:"E",templateUrl:"partials/rpSaveButton",controller:"rpSaveButtonCtrl",scope:{redditId:"=",saved:"="}}}),rpDirectives.directive("rpReplyButton",function(){return{restrict:"E",templateUrl:"partials/rpReplyButton",controller:"rpReplyButtonCtrl",scope:{parentCtrl:"="}}}),rpDirectives.directive("rpEditButton",function(){return{restrict:"E",templateUrl:"partials/rpEditButton",controller:"rpEditButtonCtrl",scope:{parentCtrl:"="}}}),rpDirectives.directive("rpDeleteButton",function(){return{restrict:"E",templateUrl:"partials/rpDeleteButton",controller:"rpDeleteButtonCtrl",scope:{parentCtrl:"="}}}),rpDirectives.directive("rpEditForm",function(){return{restrict:"E",templateUrl:"partials/rpEditForm",controller:"rpEditFormCtrl",scope:{redditId:"=",parentCtrl:"=",editText:"="}}}),rpDirectives.directive("rpDeleteForm",function(){return{restrict:"E",templateUrl:"partials/rpDeleteForm",controller:"rpDeleteFormCtrl",scope:{redditId:"=",parentCtrl:"=",type:"="}}}),rpDirectives.directive("rpReplyForm",function(){return{restrict:"E",templateUrl:"partials/rpReplyForm",controller:"rpReplyFormCtrl",scope:{redditId:"=",parentCtrl:"=",post:"="}}}),rpDirectives.directive("rpScore",function(){return{restrict:"E",templateUrl:"partials/rpScore",controller:"rpScoreCtrl",scope:{score:"=",redditId:"=",likes:"="}}}),rpDirectives.directive("rpLink",function(){return{restrict:"E",templateUrl:"partials/rpLink",controller:"rpLinkCtrl",scope:{post:"=",parentCtrl:"=",identity:"=",showSub:"="}}}),rpDirectives.directive("rpSearchPost",function(){return{restrict:"E",templateUrl:"partials/rpSearchPost"}}),rpDirectives.directive("rpSearchLink",function(){return{restrict:"E",templateUrl:"partials/rpSearchLink"}}),rpDirectives.directive("rpSearchSub",function(){return{restrict:"E",templateUrl:"partials/rpSearchSub"}}),rpDirectives.directive("rpArticle",function(){return{restrict:"C",templateUrl:"partials/rpArticle",controller:"rpArticleCtrl",scope:{dialog:"=",post:"=",article:"=",subreddit:"=",comment:"="}}}),rpDirectives.directive("rpSettings",function(){return{restrict:"C",templateUrl:"partials/rpSettings",controller:"rpSettingsCtrl"}}),rpDirectives.directive("rpSubmitText",function(){return{restrict:"C",templateUrl:"partials/rpSubmitText"}}),rpDirectives.directive("rpSubmitLink",function(){return{restrict:"C",templateUrl:"partials/rpSubmitLink"}}),rpDirectives.directive("rpMessageCompose",function(){return{restrict:"C",templateUrl:"partials/rpMessageCompose",controller:"rpMessageComposeCtrl"}}),rpDirectives.directive("rpCaptcha",function(){return{restrict:"E",templateUrl:"partials/rpCaptcha",controller:"rpCaptchaCtrl"}}),rpDirectives.directive("rpFormatting",function(){return{restrict:"E",templateUrl:"partials/rpFormatting",controller:"rpFormattingCtrl"}}),rpDirectives.directive("rpComment",["$compile","$rootScope","RecursionHelper",function(e,t,r){return{restrict:"E",replace:!0,scope:{comment:"=",cid:"=",depth:"=",post:"=",sort:"=",parent:"=",identity:"="},templateUrl:"partials/rpComment",controller:"rpCommentCtrl",compile:function(e){return r.compile(e,function(e,t,r,o,i){})}}}]),rpDirectives.directive("rpMessageComment",["$compile","$rootScope","RecursionHelper",function(e,t,r){return{restrict:"E",replace:!0,scope:{parentCtrl:"=",message:"=",depth:"=",identity:"="},templateUrl:"partials/rpMessageComment",compile:function(e){return r.compile(e,function(e,t,r,o,i){})},controller:"rpMessageCommentCtrl"}}]),rpDirectives.directive("rpCommentMedia",function(){return{restrict:"C",scope:{href:"@"},transclude:!0,replace:!0,templateUrl:"partials/rpCommentMedia"}}),rpDirectives.directive("compile",["$compile","$sce",function(e,t){return{link:function(r,o,i){var s=r.$watch(function(e){return t.parseAsHtml(i.compile)(e)},function(t){o.html(t),e(o.contents())(r),s()})}}}]),rpDirectives.directive("rpContentScroll",["$rootScope",function(e){return{restrict:"C",scope:{scroll:"="},link:function(t,r,o){var i=!1;console.log("[rpContentScroll] attrs.rpContentScroll: "+t.scroll),console.log("[rpContentScroll] typeof attrs.rpContentScroll: "+typeof t.scroll),i=void 0===t.scroll?!0:t.scroll;var s=0;r.on("scroll",function(){if(console.log("[rpContentScroll] onScroll, scroll: "+i),i){var e=r.scrollTop();s=e}});e.$on("rp_content_scroll_enable",function(){console.log("[rpContentScroll] rp_content_scroll_enable"),i=!0}),e.$on("rp_content_scroll_disable",function(){console.log("[rpContentScroll] rp_content_scroll_disable"),i=!1})}}}]),rpDirectives.directive("rpFab",["$rootScope",function(e){return{restrict:"C",link:function(t,r,o){var i=e.$on("scroll_down",function(){parseInt(r.children("ul").css("bottom"))>-100?r.children("ul").css("bottom","-=25"):r.children("ul").css("bottom","-100px")}),s=e.$on("scroll_up",function(){parseInt(r.children("ul").css("bottom"))<0?r.children("ul").css("bottom","+=25"):r.children("ul").css("bottom","0px")});t.$on("$destroy",function(){i(),s()})}}}]),rpDirectives.directive("rpFocusMe",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(r,o,i){var s=t(i.rpFocusMe);console.log("[rpFocusMe] link function load, model: "+s),r.$watch(s,function(t){console.log("[rpFocusMe] $watch, value: "+t),t===!0&&e(function(){o[0].focus()})}),o.bind("blur",function(){console.log("[rpFocusMe] blur"),r.$apply(s.assign(r,!1))})}}}]),rpDirectives.directive("rpToolbarSelectButton",[function(){return{restrict:"A",link:function(e,t,r){var o=r.rpToolbarSelectButton;console.log("[rpToolbarSelectButton] select: "+o),t.click(function(){console.log("[rpToolbarSelectButton] click()"),console.log("[rpToolbarSelectButton] click(), select: "+o),angular.element(o).trigger("click")})}}}]),rpDirectives.directive("rpInfiniteScroll",["$rootScope",function(e){return{restrict:"A",link:function(e,t,r){console.log("[rpInfiniteScroll] link()");var o=r.rpInfiniteScrollDiv,i=r.rpInfiniteScrollDistance;console.log("[rpInfiniteScroll] loaded, element.height(): "+t.height()+" scrollDiv: "+o+", scrollDistance: "+i),t.on("scroll",function(){(void 0===e.noMorePosts||e.noMorePosts===!1)&&angular.element(o).outerHeight()-t.scrollTop()<=t.outerHeight()*i&&(console.log("[rpInfiniteScroll] call loadMorePosts"),e.morePosts())})}}}]),rpDirectives.directive("rpColumnResize",["$window",function(e){return{restrict:"A",link:function(t,r,o){function i(){if(!s()){var r=e.innerWidth;r>1700?t.columns=[1,2,3,4]:r>1550?t.columns=[1,2,3]:r>960?t.columns=[1,2]:t.columns=[1]}}function s(){return console.log("[rpColumnResize] isFullscreen(): "+window.innerWidth===screen.width&&window.innerHeight===screen.height),window.innerWidth===screen.width&&window.innerHeight===screen.height}i(),angular.element(e).bind("resize",function(){i()})}}}]),rpDirectives.directive("rpSuspendable",["$rootScope",function(e){return{link:function(t){function r(e,t){console.log("[rpSuspendable] removeWatchers scope.$id: "+e.$id+", depth: "+t),i[e.$id]=e.$$watchers,e.$$watchers=[],void 0!==e.$$childHead&&null!==e.$$childHead&&(console.log("[rpSuspendable] recurse children"),r(e.$$childHead,++t)),void 0!==e.$$nextSibling&&null!==e.$$nextSibling&&(console.log("[rpSuspendable] recurse siblings"),r(e.$$nextSibling,++t))}function o(e,t){console.log("[rpSuspendable] restoreWatchers scope.$id: "+e.$id+", depth: "+t),e.$$watchers&&0!==e.$$watchers.length?e.$$wactchers=e.$$watchers.concat(i[e.$id]):e.$$watchers=i[e.$id],i[e.id]=void 0,void 0!==e.$$childHead&&null!==e.$$childHead&&(console.log("[rpSuspendable] restoreWatchers() recurse children"),o(e.$$childHead,++t)),void 0!==e.$$nextSibling&&null!==e.$$nextSibling&&(console.log("[rpSuspendable] restoreWatchers() recurse siblings"),o(e.$$nextSibling,++t))}var i={},s=e.$on("rp_suspendable_suspend",function(){console.log("[rpSuspendable] rp_suspendable_suspend"),i={},r(t,0)}),n=e.$on("rp_suspendable_resume",function(){console.log("[rpSuspendable] rp_suspendable_resume"),o(t,0),i=void 0});t.$on("$destroy",function(){s(),n()})}}}]),rpDirectives.directive("rpTabToolbar",["$rootScope",function(e){return{restrict:"C",link:function(t,r,o){function i(){parseInt(r.css("top"))<0&&r.css("top","+="+a)}function s(){parseInt(r.css("top"))>-48&&r.css("top","-="+a)}function n(){parseInt(r.css("top"))<0&&r.css("top",0)}function l(){parseInt(r.css("top"))>-48&&r.css("top",-48)}var a=16,c=e.$on("scroll_down",function(){s()}),p=e.$on("scroll_up",function(){i()}),u=e.$on("rp_tabs_show",function(){n()}),d=e.$on("rp_tabs_hide",function(){l()});t.$on("$destroy",function(){c(),p(),d(),u()})}}}]),rpDirectives.directive("rpPageContent",["$rootScope",function(e){return{restrict:"C",link:function(t,r,o){function i(){parseInt(r.css("top"))<0&&r.css("top","+="+a)}function s(){parseInt(r.css("top"))>-48&&r.css("top","-="+a)}function n(){parseInt(r.css("top"))<0&&r.css("top",0)}function l(){parseInt(r.css("top"))>-48&&r.css("top",-48)}var a=16,c=e.$on("scroll_down",function(){s()}),p=e.$on("scroll_up",function(){i()}),u=e.$on("rp_tabs_show",function(){n()}),d=e.$on("rp_tabs_hide",function(){l()});t.$on("$destroy",function(){c(),p(),u(),d()})}}}]),rpDirectives.directive("rpSidenavFooter",["$rootScope",function(e){return{restrict:"C",link:function(t,r,o){function i(){parseInt(r.css("margin-bottom"))<48&&r.css("margin-bottom","+="+a);
}function s(){0!==parseInt(r.css("margin-bottom"))&&r.css("margin-bottom","-="+a)}function n(){parseInt(r.css("margin-bottom"))<48&&r.css("margin-bottom",48)}function l(){0!==parseInt(r.css("margin-bottom"))&&r.css("margin-bottom",0)}var a=16,c=e.$on("scroll_up",function(){console.log("[rpSidenavFooter] onScrollUp()"),i()}),p=e.$on("scroll_down",function(){s()}),u=e.$on("rp_tabs_show",function(){n()}),d=e.$on("rp_tabs_hide",function(){l()});t.$on("$destroy",function(){c(),p(),d(),u()})}}}]),rpDirectives.directive("img",function(){return{restrict:"E",link:function(e,t){t.load(function(){t.parents("rp-link").length>0&&(console.log("[masonry img] loaded: "+t.attr("src")),e.$emit("angular_masonry_directive_update"))})}}});var rpEditFormControllers=angular.module("rpEditFormControllers",[]);rpEditFormControllers.controller("rpEditButtonCtrl",["$scope",function(e){console.log("[rpEditButtonCtrl]"),e.parentCtrl.isEditing=!1,e.toggleEditing=function(){e.parentCtrl.isEditing=!e.parentCtrl.isEditing}}]),rpEditFormControllers.controller("rpEditFormCtrl",["$scope","rpEditUtilService",function(e,t){e.submit=function(){console.log("[rpEditFormCtrl] submit(), $scope.editText: "+e.editText),e.inputIsDisabled=!0,e.isSubmitting=!0,t(e.editText,e.redditId,function(t,r){t?console.log("[rpEditFormCtrl] err"):e.parentCtrl.completeEditing()})}}]);var rpFilters=angular.module("rpFilters",[]);rpFilters.filter("rp_open_link_new_window",[function(){return function(e){return e?e.replace(/&lt;a/g,'&lt;a target="_blank"'):void 0}}]),rpFilters.filter("rp_youtube_time_to_seconds",[function(){return function(e){var t=/^(?:([\d]+)h)?(?:([\d]+)m)?(?:([\d]+)s)?$/i,r=t.exec(e);if(r){var o=parseInt(r[1])||0,i=parseInt(r[2])||0,s=parseInt(r[3])||0;return 60*o*60+60*i+s}return 0}}]),rpFilters.filter("rp_hijack_reddit_link",[function(){return function(e){var t=/^(?:https?:\/\/)?(?:www\.)?(?:np\.)?(?:(?:reddit\.com)|(\/?r\/)|(\/?u\/)){1,2}([\S]+)?$/i,r=t.test(e);if(r){for(var o=t.exec(e),i="",s=1;s<o.length;s++)void 0!==o[s]&&(i+=o[s]);return i}return e}}]),rpFilters.filter("rp_link_id",[function(){return function(e){if(e){var t=/^\/r\/(?:[\w]+)\/comments\/([\w]+)/i,r=t.exec(e);return r[1]}return 0}}]),rpFilters.filter("rp_is_comment",[function(){return function(e){return"t1_"===e.substr(0,3)}}]),rpFilters.filter("rp_name_to_id36",[function(){return function(e){return e.substr(3)}}]),rpFilters.filter("rp_load_comment_media",[function(){return function(e){return e.replace(/<a/g,'<a class="rp-comment-media"')}}]),rpFilters.filter("rp_clean_title",["$log",function(e){return function(e){return e&&(e=e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/gi," ")),e}}]),rpFilters.filter("rp_unescape_embed",["$sce",function(e){return function(t){if("undefined"!=typeof t&&""!==t){var r=angular.element("<div>"+t+"</div>").text();return e.trustAsHtml(r)}}}]),rpFilters.filter("rp_unescape_html",["$sce",function(e){return function(t){return angular.element("<div>"+e.trustAsHtml(t)+"</div>").text()}}]),rpFilters.filter("rp_trusted",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]),rpFilters.filter("rp_media_type",[function(){return function(e){var t=/^https?:\/\/(?:i\.|m\.|edge\.|www\.)*imgur\.com\/(?:r\/[\w]+\/)*(?!gallery)(?!removalrequest)(?!random)(?!memegen)([\w]{5,7}(?:[&,][\w]{5,7})*)(?:#\d+)?[sbtmlh]?(\.(?:jpe?g|gif|png|gifv|webm))?(\?.*)?$/i,r=/^https?:\/\/(?:www\.)?(?:i\.|m\.)?imgur\.com\/(?:a|gallery)\/([\w]+)(\..+)?(?:\/)?(?:#?\w*)?(?:\?\_[\w]+\=[\w]+)?$/i,o=/^https?:\/\/(?:www\.|m\.)?youtube\.com\/watch\?.*v=([\w\-]+)/i,i=/^https?:\/\/(?:www\.)?youtu\.be\/([\w\-]+)/i,s=/^https?:\/\/(?:mobile\.)?twitter\.com\/(?:#!\/)?[\w]+\/status(?:es)?\/([\d]+)/i,n=/^https?:\/\/(?:[\w]+.)?gfycat\.com\/(\w+)(?:\.gif)?/i,l=/^http:\/\/(?:www\.)?giphy\.com\/gifs\/(.*?)(\/html5)?$/i,a=/^http:\/\/(?:www\.)?(?:i\.)?giphy\.com\/([\w]+)(?:.gif)?/i,c=/^https?:\/\/(?:www\.)?(?:media[0-9]?\.)?(?:i\.)?giphy\.com\/(?:media\/)?([\w]+)(?:.gif)?/i;return t.test(e)?"imgur":r.test(e)?"imgurAlbum":o.test(e)||i.test(e)?"youtube":s.test(e)?"twitter":n.test(e)?"gfycat":l.test(e)||a.test(e)||c.test(e)?"giphy":null}}]);var rpGildControllers=angular.module("rpGildControllers",[]);rpGildControllers.controller("rpGildButtonCtrl",["$scope","rpGildUtilService","rpAuthUtilService","rpToastUtilService",function(e,t,r,o){e.gild=function(){r.isAuthenticated?t(e.redditId,function(t,r){t?console.log("[rpGildButtonCtrl] err"):(console.log("[rpGildButtonCtrl] success"),e.gilded++)}):o("You've got to log in to gild posts")}}]);var rpImgurUtilServices=angular.module("rpImgurUtilServices",[]);rpImgurUtilServices.factory("rpImgurPreloaderUtilService",["$q","$rootScope",function(e,t){function r(t){this.imageLocations=t,this.imageCount=this.imageLocations.length,this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.state=this.states.PENDING,this.deferred=e.defer(),this.promise=this.deferred.promise}return r.preloadImages=function(e){var t=new r(e);return t.load()},r.prototype={constructor:r,isInitiated:function(){return this.state!==this.states.PENDING},isRejected:function(){return this.state===this.states.REJECTED},isResolved:function(){return this.state===this.states.RESOLVED},load:function(){if(this.isInitiated())return this.promise;this.state=this.states.LOADING;for(var e=0;e<this.imageCount;e++)this.loadImageLocation(this.imageLocations[e]);return this.promise},handleImageError:function(e){this.errorCount++,this.isRejected()||(this.state=this.states.REJECTED,this.deferred.reject(e))},handleImageLoad:function(e){this.loadCount++,this.isRejected()||(this.deferred.notify({percent:Math.ceil(this.loadCount/this.imageCount*100),imageLocation:e}),this.loadCount===this.imageCount&&(this.state=this.states.RESOLVED,this.deferred.resolve(this.imageLocations)))},loadImageLocation:function(e){var r=this,o=$(new Image).load(function(e){t.$apply(function(){r.handleImageLoad(e.target.src),r=o=e=null})}).error(function(e){t.$apply(function(){r.handleImageError(e.target.src),r=o=e=null})}).prop("src",e)}},r}]);var rpLinkControllers=angular.module("rpLinkControllers",[]);rpLinkControllers.controller("rpLinkCtrl",["$scope","$filter","$mdDialog","rpLocationUtilService",function(e,t,r,o){e.isComment=t("rp_is_comment")(e.post.data.name),e.isMine=e.identity?e.post.data.author===e.identity.name:!1,e.thisController=this,this.completeDeleting=function(t){console.log("[rpLinkCtrl] completeDeleting()"),e.parentCtrl.completeDeleting(t)},this.completeReplying=function(t){console.log("[rpLinkCtrl] completeReplying()"),e.postComment=t.json.data.things[0],e.post.data.num_comments++}}]);var rpMediaControllers=angular.module("rpMediaControllers",[]);rpMediaControllers.controller("rpMediaCtrl",["$scope","$timeout","rpSettingsUtilService",function(e,t,r){e.post&&(e.post.data.title.toLowerCase().indexOf("nsfw")>0&&(e.showWarning=!0,e.warningText="nsfw"),e.post.data.title.toLowerCase().indexOf("nsfl")>0&&(e.showWarning=!0,e.warningText="nsfl"),e.post.data.title.toLowerCase().indexOf("gore")>0&&(e.showWarning=!0,e.warningText="gore"),!e.warningText&&e.post.data.link_flair_text&&(e.warningText=e.post.data.link_flair_text),e.post.data.over_18&&(e.showWarning=!0,e.showWarning=r.settings.over18,e.warningText||(e.warningText="over 18"))),e.showMedia=function(){e.showWarning=!1,t(function(){e.$emit("angular_masonry_directive_update")},2e3)}}]),rpMediaControllers.controller("rpMediaDefaultCtrl",["$scope",function(e){".jpg"===e.url.substr(e.url.length-4)||".jpeg"===e.url.substr(e.url.length-5)||".png"===e.url.substr(e.url.length-4)||".bmp"===e.url.substr(e.url.length-4)?(e.playable=!1,e.imageUrl=e.url):".gif"===e.url.substr(e.url.length-4)||e.url.length-5===".gifv"?(e.defaultType="gif",e.gifUrl=e.url,e.playable=!0):".webm"===e.url.substr(e.url.length-5)?(e.defaultType="video",e.webmUrl=e.url,e.playable=!0):".mp4"===e.url.substr(e.url.length-4)?(e.defaultType="video",e.mp4Url=e.url,e.playable=!0):e.post&&(e.post.data.media?"video"===e.post.data.media.oembed.type&&(e.defaultType="embed",e.playable=!0):e.post.data.thumbnail&&(e.playable=!1,e.imageUrl=e.post.data.thumbnail)),e.playable&&e.post&&e.post.data.thumbnail&&(e.thumbnailUrl=e.post.data.thumbnail),e.showPlayable=!1,e.show=function(){e.showPlayable=!0},e.hide=function(){e.showPlayable=!1}}]),rpMediaControllers.controller("rpMediaGiphyCtrl",["$scope",function(e){var t,r=/^http:\/\/(?:www\.)?giphy\.com\/gifs\/(.*?)(\/html5)?$/i,o=/^http:\/\/(?:www\.)?(?:i\.)?giphy\.com\/([\w]+)(?:.gif)?/i,i=/^https?:\/\/(?:www\.)?(?:media[0-9]?\.)?(?:i\.)?giphy\.com\/(?:media\/)?([\w]+)(?:.gif)?/i;r.test(e.url)?t=r.exec(e.url):o.test(e.url)?t=o.exec(e.url):i.test(e.url)&&(t=i.exec(e.url)),e.giphyType=t[2]?"video":"image",t&&(e.thumbnailUrl="http://media.giphy.com/media/"+t[1]+"/200_s.gif","image"===e.giphyType?e.imageUrl="http://media.giphy.com/media/"+t[1]+"/giphy.gif":"video"===e.giphyType&&(e.videoUrl="http://media.giphy.com/media/"+t[1]+"/giphy.mp4")),e.show=function(){e.showGif=!0},e.hide=function(){e.showGif=!1}}]),rpMediaControllers.controller("rpMediaGfycatCtrl",["$scope",function(e){var t=/(^https?:\/\/[\w]?\.?)?gfycat\.com\/(\w+)(\.gif)?/i,r=t.exec(e.url);r[3]&&".gif"==r[3]?e.gfycatType="image":e.gfycatType="video",e.showGif=!1;var o="https://";r&&(e.dataId=r[2],e.thumbnailUrl="http://thumbs.gfycat.com/"+r[2]+"-poster.jpg","image"===e.gfycatType?e.imageUrl=o+"gfycat.com/"+r[2]+".gif":"video"===e.gfycatType&&(e.zippyVideoUrl="http://zippy.gfycat.com/"+r[2]+".webm",e.fatVideoUrl="http://fat.gfycat.com/"+r[2]+".webm",e.giantVideoUrl="http://giant.gfycat.com/"+r[2]+".webm")),e.show=function(){e.showGif=!0},e.hide=function(){e.showGif=!1}}]),rpMediaControllers.controller("rpMediaTwitterCtrl",["$scope","$sce","rpTweetResourceService",function(e,t,r){e.tweet="";var o=/^https?:\/\/(?:mobile\.)?twitter\.com\/(?:#!\/)?[\w]+\/status(?:es)?\/([\d]+)/i,i=o.exec(e.url);if(i){r.get({id:i[1]},function(r){e.tweet=t.trustAsHtml(r.html)})}}]),rpMediaControllers.controller("rpMediaYoutubeCtrl",["$scope","$sce","$filter",function(e,t,r){var o,i=/^https?:\/\/(?:www\.|m\.)?youtube\.com\/watch\?.*v=([\w\-]+)/i,s=/^https?:\/\/(?:www\.)?youtu\.be\/([\w\-]+)(\?t=[\w]+)?/i,n=/\?t\=[\w+]+/i;if(o=i.exec(e.url),o||(o=s.exec(e.url)),o){console.log("[rpMediaYoutubeCtrl] groups: "+o),e.thumbnailUrl="https://img.youtube.com/vi/"+o[1]+"/default.jpg";var l="http://www.youtube.com/embed/"+o[1]+"?autoplay=1";if(o[2]&&n.test(o[2])){console.log("[rpMediaYoutubeCtrl] groups[2]: "+o[2]);var a=r("rp_youtube_time_to_seconds")(o[2].replace("?t=",""));l+="&start="+a}console.log("[rpMediaYoutubeCtrl] embedUrl: "+l),e.embedUrl=t.trustAsResourceUrl(l)}e.showYoutubeVideo=!1,e.show=function(){e.showYoutubeVideo=!0},e.hide=function(){e.showYoutubeVideo=!1}}]),rpMediaControllers.controller("rpMediaImgurCtrl",["$scope",function(e){var t=/^https?:\/\/(?:i\.|m\.|edge\.|www\.)*imgur\.com\/(?:r\/[\w]+\/)*(?!gallery)(?!removalrequest)(?!random)(?!memegen)([\w]{5,7}(?:[&,][\w]{5,7})*)(?:#\d+)?[sbtmlh]?(\.(?:jpe?g|gif|png|gifv|webm))?(\?.*)?$/i,r=t.exec(e.url),o=r[2]||".jpg";".gif"==o||".gifv"==o||".webm"==o?e.imgurType="video":e.imgurType="image",r&&(e.thumbnailUrl="http://i.imgur.com/"+r[1]+"t.jpg","image"===e.imgurType?e.imageUrl=r[1]?"http://i.imgur.com/"+r[1]+o:e.url:"video"===e.imgurType&&(e.webmUrl="http://i.imgur.com/"+r[1]+".webm",e.mp4Url="http://i.imgur.com/"+r[1]+".mp4")),e.showGif=!1,e.show=function(){e.showGif=!0},e.hide=function(){e.showGif=!1}}]),rpMediaControllers.controller("rpMediaImgurAlbumCtrl",["$scope","$log","$filter","$routeParams","rpImgurAlbumResourceService","rpImgurGalleryResourceService","rpImgurPreloaderUtilService",function(e,t,r,o,i,s,n){function l(){console.log("[rpMediaImgurAlbumCtrl] setCurrentImage()"),e.currentImageUrl=e.album.data.images[p].link,e.imageDescription=e.album.data.images[p].description,e.imageDescriptionLinky=r("linky")(e.album.data.images[p].description,"_blank"),e.imageTitle=e.album.data.images[p].title,e.currentImage=p+1}function a(e,t){for(var r=0;r<t.length;r++)if(t[r].id==e)return r}function c(e){if(e&&"undefined"!==e){console.log("[rpMediaImgurAlbumCtrl] preloadImages, images: "+e);var t=[];e.forEach(function(e,r){t.push(e.link)}),console.log("[rpMediaImgurAlbumCtrl] preloadImages, imageLocations: "+t),n.preloadImages(t).then(function(e){console.log("[rpMediaImgurAlbumCtrl] handleResolve, images load successful.")},function(e){console.log("[rpMediaImgurAlbumCtrl] handleReject, images load failed.")},function(e){})}}var p=0,u="",d=3;e.currentImage=0,e.currentImageUrl="",e.imageDescription="",e.imageTitle="";var g=/^https?:\/\/(?:i\.|m\.)?imgur\.com\/(?:a|gallery)\/([\w]+)(\..+)?(?:\/)?(?:#?\w*)?(?:\?\_[\w]+\=[\w]+)?$/i,m=g.exec(e.url),h=m[1];if(h.indexOf(",")>0){console.log("[rpMediaImgurAlbumCtrl] implicit album");var S=[],f=h.split(",");f.forEach(function(e,t){S.push({link:"http://i.imgur.com/"+e+".jpg"})}),e.album={data:{images_count:f.length,images:S}},l(),c(e.album.data.images.slice(1,d))}else e.url.indexOf("/gallery/")>0?(console.log("[rpMediaImgurAlbumCtrl] gallery"),s.get({id:h},function(t){if(t.data.is_album)e.album=t,u&&(p=a(u,e.album.data.images)),l(),c(e.album.data.images.slice(1,d));else{var r=[];r[0]={link:t.data.link},e.album={data:{images_count:1,images:r}},l(),c(e.album.data.images.slice(1,d))}},function(e){t.log("Error retrieving Gallery data, "+h),t.log(e)})):(console.log("[rpMediaImgurAlbumCtrl] album"),i.get({id:h},function(t){e.album=t,u&&(p=a(u,e.album.data.images)),l(),c(e.album.data.images.slice(1,d))},function(t){var r=[];r[0]={link:"http://i.imgur.com/"+h+".jpg"},e.album={data:{images_count:1,images:r}},l(),c(e.album.data.images.slice(1,d))}));e.prev=function(t){e.$emit("album_image_change"),--p<0&&(p=t-1),l()},e.next=function(t){console.log("[rpMediaImgurAlbumCtrl] next()"),e.$emit("album_image_change"),++p==t&&(p=0),console.log("[rpMediaImgurAlbumCtrl] next(), imageIndex: "+p),c(e.album.data.images.slice(p+d-1,p+d)),l()}}]);var rpMediaDirectives=angular.module("rpMediaDirectives",[]);rpMediaDirectives.directive("rpMedia",function(){return{restrict:"E",templateUrl:"partials/rpMedia",scope:{url:"=",post:"="},controller:"rpMediaCtrl"}}),rpMediaDirectives.directive("rpMediaImgur",function(){return{restrict:"E",templateUrl:"partials/rpMediaImgur",controller:"rpMediaImgurCtrl"}}),rpMediaDirectives.directive("rpMediaImgurAlbum",function(){return{restrict:"E",templateUrl:"partials/rpMediaImgurAlbum",controller:"rpMediaImgurAlbumCtrl"}}),rpMediaDirectives.directive("rpMediaYoutube",function(){return{restrict:"E",templateUrl:"partials/rpMediaYoutube",controller:"rpMediaYoutubeCtrl"}}),rpMediaDirectives.directive("rpMediaTwitter",function(){return{restrict:"E",templateUrl:"partials/rpMediaTwitter",controller:"rpMediaTwitterCtrl"}}),rpMediaDirectives.directive("rpMediaGfycat",function(){return{restrict:"E",templateUrl:"partials/rpMediaGfycat",controller:"rpMediaGfycatCtrl"}}),rpMediaDirectives.directive("rpMediaGiphy",function(){return{restrict:"E",templateUrl:"partials/rpMediaGiphy",controller:"rpMediaGiphyCtrl"}}),rpMediaDirectives.directive("rpMediaDefault",function(){return{restrict:"E",templateUrl:"partials/rpMediaDefault",controller:"rpMediaDefaultCtrl"}}),rpMediaDirectives.directive("rpMediaImgurAlbumWrapper",function(){return{restrict:"C",link:function(e,t,r){t.children("img").load(function(){t.children(".rp-media-imgur-album-progress").hide()}),e.$on("album_image_change",function(){t.children(".rp-media-imgur-album-progress").show()})}}});var rpMessageControllers=angular.module("rpMessageControllers",[]);rpMessageControllers.controller("rpMessageCtrl",["$scope","$rootScope","$routeParams","rpMessageUtilService","rpIdentityUtilService","rpTitleChangeService","rpPostFilterButtonUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSubscribeButtonUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpToolbarShadowUtilService","rpReadAllMessagesUtilService","rpLocationUtilService","rpSidebarButtonUtilService","rpSettingsUtilService","rpReadMessageUtilService",function(e,t,r,o,i,s,n,l,a,c,p,u,d,g,m,h,S,f){function b(){e.messages={},e.havePosts=!1,e.hasMail=!1,e.noMorePosts=!1,t.$emit("progressLoading"),o($,"",C,function(r,o){if(t.$emit("progressComplete"),console.log("[rpMessageCtrl] received message data, data.get.data.children.length: "+o.get.data.children.length),r)console.log("[rpMessageUtilService] err");else if(e.noMorePosts=o.get.data.children.length<C,e.messages=o.get.data.children,e.havePosts=!0,"unread"===$){for(var i=[],s=0;s<e.messages.length;s++)console.log("[rpMessageCtrl] read_message, $scope.messages[i].data.name: "+e.messages[s].data.name),i.push(e.messages[s].data.name);var n=i.join(", ");console.log("[rpMessageCtrl] message: "+n),f(n,function(o){r?console.log("[rpMessageCtrl] err"):(console.log("[rpMessageCtrl] all messages read."),e.hasMail=!1,t.$emit("rp_messages_read"))})}})}n.hide(),c.hide(),l.hide(),a.hide(),p.hide(),u.hide(),d.hide(),h.hide();var v=!1;e.noMorePosts=!1;var C=25;s.prepTitleChange("Messages");var $=r.where||"inbox",w=[{label:"all",value:"inbox"},{label:"unread",value:"unread"},{label:"messages",value:"messages"},{label:"comment replies",value:"comments"},{label:"post replies",value:"selfreply"},{label:"username mentions",value:"mentions"}];t.$emit("rp_tabs_changed",w),t.$emit("rp_tabs_show"),console.log("[rpMessageCtrl] where: "+$),i.reloadIdentity(function(r){e.identity=r,e.hasMail=e.identity.has_mail,console.log("[rpMessageCtrl] $scope.identity: "+JSON.stringify(e.identity)),console.log("[rpMessageCtrl] $scope.hasMail: "+e.hasMail),e.hasMail&&"unread"!==$&&($="unread",m(null,"/message/"+$,"",!1,!0)),console.log("[rpMessageCtrl] where: "+$);for(var o=0;o<w.length;o++)if($===w[o].value){t.$emit("rp_tabs_selected_index_changed",o);break}b()});var y=t.$on("rp_tab_click",function(e,t){console.log("[rpMessageCtrl] on rp_tab_click, tab: "+t),$=t,m(null,"/message/"+$,"",!1,!1),b(),console.log("[rpMessageCtrl] this.tabClick, ignored first tab click...")});e.thisController=this,e.morePosts=function(){if(console.log("[rpMessageCtrl] morePosts()"),e.messages&&e.messages.length>0){var r=e.messages[e.messages.length-1].data.name;r&&!v&&(v=!0,t.$emit("progressLoading"),o($,r,C,function(r,o){t.$emit("progressComplete"),r?console.log("[rpMessageUtilService] err"):(e.noMorePosts=o.get.data.children.length<25,Array.prototype.push.apply(e.messages,o.get.data.children),v=!1)}))}},e.$on("$destroy",function(){console.log("[rpMessageCtrl] $destroy()"),y(),t.$emit("rp_tabs_hide")})}]),rpMessageControllers.controller("rpMessageCommentCtrl",["$scope","$filter","$mdDialog","rpIdentityUtilService","rpByIdUtilService","rpLocationUtilService",function(e,t,r,o,i,s){e.identity&&console.log("[rpMessageCommentCtrl] $scope.identity.name: "+e.identity.name),e.childDepth=e.depth+1,e.isReplying=!1,e.thisController=this,this.completeReplying=function(t,r){console.log("[rpMessageCommentCtrl] this.completeReplying(), $scope.message.kind: "+e.message.kind),this.isReplying=!1,"t1"===e.message.kind?e.comments=t.json.data.things:"t4"===e.message.kind&&(e.message.data.replies?e.message.data.replies.data.children.push(t.json.data.things[0]):e.message.data.replies={data:{children:t.json.data.things}})}}]),rpMessageControllers.controller("rpMessageSidenavCtrl",["$scope","$rootScope","$mdDialog","rpSettingsUtilService","rpLocationUtilService","rpIdentityUtilService",function(e,t,r,o,i,s){e.isOpen=!1,e.toggleOpen=function(){e.isOpen=!e.isOpen},e.hasMail=!1,s.getIdentity(function(t){e.hasMail=t.has_mail}),e.showCompose=function(e){o.settings.composeDialog?r.show({controller:"rpMessageComposeDialogCtrl",templateUrl:"partials/rpMessageComposeDialog",targetEvent:e,clickOutsideToClose:!1,escapeToClose:!1,locals:{shareLink:null,shareTitle:null}}):i(e,"/message/compose","",!0,!1)},e.showInbox=function(e){i(e,"/message/inbox","",!0,!1)},e.showSent=function(e){i(e,"/message/sent","",!0,!1)};var n=t.$on("rp_messages_read",function(){e.hasMail=!1});e.$on("$destroy",function(){n()})}]),rpMessageControllers.controller("rpMessageComposeCtrl",["$scope","$mdDialog","rpLocationUtilService","rpSubredditsUtilService",function(e,t,r,o){null!==e.shareLink&&void 0!==e.shareLink?e.title="Share a link with a reddit user":e.title="Send a message"}]),rpMessageControllers.controller("rpMessageComposeDialogCtrl",["$scope","$location","$mdDialog","shareLink","shareTitle",function(e,t,r,o,i){console.log("[rpMessageComposeDialogCtrl] shareLink: "+o),e.shareLink=o||null,e.shareTitle=i||null,e.dialog=!0;var s=e.$on("$locationChangeSuccess",function(){r.hide()});e.$on("$destroy",function(){s()})}]),rpMessageControllers.controller("rpMessageComposeFormCtrl",["$scope","$rootScope","$mdDialog","rpMessageComposeUtilService","rpLocationUtilService",function(e,t,r,o,i){function s(){e.subject="",e.text="",e.to="",e.rpMessageComposeForm.$setUntouched()}e.messageSending=!1,e.showSend=!0,console.log("[rpMessageComposeFormCtrl] $scope.shareLink: "+e.shareLink),null!==e.shareLink&&void 0!==e.shareLink&&(e.text="Check this out, ["+e.shareTitle+"]("+e.shareLink+")"),e.closeDialog=function(t){console.log("[rpMessageComposeFormCtrl] closeDialog(), $scope.dialog: "+e.dialog),e.dialog?(console.log("[rpMessageComposeFormCtrl] closeDialog: Dialog."),s(),r.hide()):(console.log("[rpMessageComposeFormCtrl] closeDialog: Window."),i(t,"/","",!0,!1))},e.sendMessage=function(){console.log("[rpMessageComposeFormCtrl] sendMessage(), $scope.iden: "+e.iden),console.log("[rpMessageComposeFormCtrl] sendMessage(), $scope.captcha: "+e.captcha),e.messageSending=!0,o(e.subject,e.text,e.to,e.iden,e.captcha,function(r,o){e.messageSending=!1,r?(console.log("[rpMessageComposeFormCtrl] err"),"BAD_CAPTCHA"===r.json.errors[0][0]?(t.$emit("reset_captcha"),e.feedbackMessage="You entered the CAPTCHA incorrectly. Please try again.",e.showFeedbackAlert=!0,e.showFeedback=!0,e.showButtons=!0):(t.$emit("reset_captcha"),e.feedbackMessage=r.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedback=!0)):(e.feedbackMessage="Your message was sent successfully :)",e.showFeedbackAlert=!1,e.showFeedback=!0,e.showSendAnother=!0,e.showSend=!1)})},e.sendAnother=function(){s(),t.$emit("reset_captcha"),e.showFeedback=!1,e.showSendAnother=!1,e.showSend=!0}}]);var rpPostControllers=angular.module("rpPostControllers",[]);rpPostControllers.controller("rpPostsCtrl",["$scope","$rootScope","$routeParams","$window","$filter","$timeout","$q","rpPostsUtilService","rpTitleChangeService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpSubscribeButtonUtilService","rpSettingsUtilService","rpSubredditsUtilService","rpLocationUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpSidebarButtonUtilService","rpToolbarShadowUtilService","rpAuthUtilService","rpIdentityUtilService","rpPostFilterButtonUtilService",function(e,t,r,o,i,s,n,l,a,c,p,u,d,g,m,h,S,f,b,v,C,$){function w(){e.posts={},e.havePosts=!1,e.noMorePosts=!1,t.$emit("progressLoading"),l(k,e.sort,"",A,T,function(r,o){t.$emit("progressComplete"),r?console.log("[rpPostsCtrl] err.status: "+JSON.stringify(r.status)):(e.havePosts=!0,console.log("[rpPostsCtrl] data.length: "+o.get.data.children.length),o.get.data.children.length<T&&(e.noMorePosts=!0),e.posts=o.get.data.children)})}function y(t,r,o){return console.log("[rpPostCtrl] addBatch(), first: "+t+", last: "+r+", $scope.posts.length: "+e.posts.length),e.posts.length>0?e.posts=Array.prototype.concat.apply(e.posts,o.slice(t,r)):e.posts=o.slice(t,r),s(angular.noop,0)}function U(e,t){console.log("[rpPostCtrl] addPostsInBatches(), posts.length: "+e.length+", batchSize: "+t);for(var r,o=n.when(),i=0;i<e.length;i+=t)r=angular.bind(null,y,i,Math.min(i+t,e.length),e),o=o.then(r);return o}console.log("[rpPostsCtrl] Loaded.");var _=[{label:"hot",value:"hot"},{label:"new",value:"new"},{label:"rising",value:"rising"},{label:"controversial",value:"controversial"},{label:"top",value:"top"},{label:"gilded",value:"gilded"}];console.log("[rpPostCtrl] about to emit rp_tabs_changed, tabs: "+_),t.$emit("rp_tabs_changed",_),t.$emit("rp_tabs_show"),c.hide(),p.hide(),h.hide(),S.hide(),b.hide();var k=e.subreddit=r.sub;console.log("[rpPostsCtrl] sub: "+k),e.sort=r.sort?r.sort:"hot",console.log("[rpPostsCtrl] $scope.sort: "+e.sort);var A=r.t?r.t:"week",M=!1;e.showSub=!0;for(var D=12,T=18,F=0;F<_.length;F++)if(e.sort===_[F].value){t.$emit("rp_tabs_selected_index_changed",F),3===F||4===F?$.show():$.hide();break}k&&"all"!==k&&"random"!==k?(e.showSub=!1,a.prepTitleChange("r/"+k),g.setSubreddit(k),u.show(),f.show(),console.log("[rpPostsCtrl] rpSubredditsUtilService.currentSub: "+g.currentSub)):(u.hide(),f.hide(),e.showSub=!0,a.prepTitleChange("frontpage"),console.log("[rpPostsCtrl] (no sub)rpSubredditsUtilService.currentSub: "+g.currentSub)),v.isAuthenticated&&C.getIdentity(function(t){e.identity=t}),w();var P=t.$on("t_click",function(t,r){A=r,k?m(null,"/r/"+k+"/"+e.sort,"t="+A,!1,!1):m(null,e.sort,"t="+A,!1,!1),w()});e.thisController=this,this.completeDeleting=function(t){console.log("[rpPostCtrl] this.completeDeleting()"),e.posts.forEach(function(r,o){r.data.name===t&&e.posts.splice(o,1)})};var R=t.$on("rp_tab_click",function(t,r){console.log("[rpPostsCtrl] onTabClick(), tab: "+r),e.posts={},e.noMorePosts=!1,e.sort=r,k?m(null,"/r/"+k+"/"+e.sort,"",!1,!1):m(null,e.sort,"",!1,!1),"top"===r||"controversial"===r?$.show():$.hide(),w()});e.morePosts=function(){if(console.log("[rpPostsCtrl] morePosts() loadingMore: "+M),e.posts&&e.posts.length>0){var r=e.posts[e.posts.length-1].data.name;r&&!M&&(M=!0,t.$emit("progressLoading"),l(k,e.sort,r,A,D,function(r,o){t.$emit("progressComplete"),r?console.log("[rpPostsCtrl] err"):(console.log("[rpPostsCtrl] morePosts(), data.length: "+o.get.data.children.length),o.get.data.children.length<D&&(e.noMorePosts=!0),U(o.get.data.children,6),M=!1)}))}},e.showContext=function(e,t){console.log("[rpPostsCtrl] showContext()"),m(e,"/r/"+t.data.subreddit+"/comments/"+i("rp_name_to_id36")(t.data.link_id)+"/"+t.data.id+"/","context=8",!0,!1)},e.$on("$destroy",function(){console.log("[rpPostsCtrl] $destroy, $scope.subreddit: "+e.subreddit),P(),R(),t.$emit("rp_tabs_hide")})}]),rpPostControllers.controller("rpPostsTimeFilterCtrl",["$scope","$rootScope","$routeParams",function(e,t,r){var o=t.$on("$routeChangeSuccess",function(){console.log("[rpPostsTimeFilterCtrl] onRouteChangeSuccess, $routeParams: "+JSON.stringify(r)),e.postTime=r.t||"week"});console.log("[rpPostsTimeFilterCtrl] $scope.postTime: "+e.postTime),e.selectTime=function(e){t.$emit("t_click",e)},e.$on("$destroy",function(){o()})}]),rpPostControllers.controller("rpPostFabCtrl",["$scope","$rootScope","$mdDialog","rpAuthUtilService","rpToastUtilService","rpSettingsUtilService","rpLocationUtilService",function(e,t,r,o,i,s,n){console.log("[rpPostFabCtrl] $scope.subreddit: "+e.subreddit),e.fabState="closed",e.newLink=function(t){o.isAuthenticated?(s.settings.submitDialog?r.show({controller:"rpSubmitDialogCtrl",templateUrl:"partials/rpSubmitLinkDialog",targetEvent:t,locals:{subreddit:e.subreddit},clickOutsideToClose:!0,escapeToClose:!1}):(console.log("[rpPostFabCtrl] submit link page"),n(null,"/submitLink","",!0,!1)),e.fabState="closed"):(e.fabState="closed",i("You've got to log in to submit a link"))},e.newText=function(t){o.isAuthenticated?(s.settings.submitDialog?r.show({controller:"rpSubmitDialogCtrl",templateUrl:"partials/rpSubmitTextDialog",targetEvent:t,locals:{subreddit:e.subreddit},clickOutsideToClose:!0,escapeToClose:!1}):(console.log("[rpPostFabCtrl] submit text page"),n(null,"/submitText","",!0,!1)),e.fabState="closed"):(e.fabState="closed",i("You've got to log in to submit a self post"))},e.$on("$destroy",function(){})}]);var rpProgressControllers=angular.module("rpProgressControllers",[]);rpProgressControllers.controller("rpIndeterminateProgressCtrl",["$scope","$rootScope","$log","$timeout",function(e,t,r,o){e.loading=!1;var i=t.$on("progressLoading",function(t,r){e.loading=!0}),s=t.$on("progressComplete",function(t,r){e.loading=!1});t.$on("$locationChangeStart",function(){e.loading=!0}),t.$on("$locationChangeSuccess",function(){e.loading=!1}),e.$on("$destroy",function(){i(),s()})}]),rpProgressControllers.controller("rpDeterminateProgressCtrl",["$scope","$rootScope","$log","$timeout","$interval",function(e,t,r,o,i){function s(t){e.loading!==!1&&e.value<t&&(e.value=t)}function n(){var t=0,r=e.value/100;t=r>=0&&.25>r?20*Math.random()/100:r>=.25&&.65>r?10*Math.random()/100:r>=.65&&.9>r?5*Math.random()/100:0,s(e.value+100*t)}e.value=0,e.loading=!1;var l,a=t.$on("progressLoading",function(t,r){e.loading===!1&&(e.loading=!0),i(function(){e.value<100&&e.value<90&&n()},125,40,!0)}),c=t.$on("progress",function(e,t){s(t.value)}),p=t.$on("progressComplete",function(t,r){l=i(function(){e.value<100?e.value+=1:(o(function(){e.loading=!1,e.value=0},500),i.cancel(l))},75,100,!1)});e.$on("$destroy",function(){a(),c(),p()})}]);var rpReplyFormControllers=angular.module("rpReplyFormControllers",[]);rpReplyFormControllers.controller("rpReplyButtonCtrl",["$scope",function(e){e.parentCtrl.isReplying=!1,e.toggleReplying=function(){console.log("[rpReplyButtonCtrl], toggleReplying()"),e.parentCtrl.isReplying=!e.parentCtrl.isReplying}}]),rpReplyFormControllers.controller("rpReplyFormCtrl",["$scope","rpCommentUtilService",function(e,t){e.submit=function(){console.log("[rpReplyFormCtrl] submit()"),t(e.redditId,e.reply,function(t,r){t?console.log("[rpReplyFormCtrl] err."):(e.reply="",e.replyForm.$setUntouched(),e.replyForm.$setPristine(),e.parentCtrl.completeReplying&&e.parentCtrl.completeReplying(r,e.post))})}}]);var rpResourceServices=angular.module("rpResourceServices",["ngResource"]);rpResourceServices.factory("rpSubredditAboutResourceService",["$resource",function(e){return e("/api/about/:sub")}]),rpResourceServices.factory("rpReadAllMessagesResourceService",["$resource",function(e){return e("/api/uauth/read_all_messages")}]),rpResourceServices.factory("rpReadMessageResourceService",["$resource",function(e){return e("/api/uauth/read_message")}]),rpResourceServices.factory("rpSubbscribeResourceService",["$resource",function(e){return e("/api/uauth/subscribe")}]),rpResourceServices.factory("rpIdentityResourceService",["$resource",function(e){return e("/api/uauth/me")}]),rpResourceServices.factory("rpByIdResourceService",["$resource",function(e){return e("/api/by_id/:name")}]),rpResourceServices.factory("rpSubredditsResourceService",["$resource",function(e){return e("/api/subreddits/:where",{where:"default",limit:50})}]),rpResourceServices.factory("rpSubredditsMineResourceService",["$resource",function(e){return e("/api/uauth/subreddits/mine/:where",{where:"subscriber",limit:50,after:""})}]),rpResourceServices.factory("rpPostsResourceService",["$resource",function(e){return e("/api/subreddit/:sub/:sort")}]),rpResourceServices.factory("rpFrontpageResourceService",["$resource",function(e){return e("/api/:sort",{sort:"hot",after:"none",t:"none",limit:"limit"})}]),rpResourceServices.factory("rpUserResourceService",["$resource",function(e){return e("/api/user/:username/:where",{username:"",where:"overview",sort:"new",after:"none",t:"none"})}]),rpResourceServices.factory("rpCommentsResourceService",["$resource",function(e){return e("/api/comments/:subreddit/:article",{sort:"confidence"})}]),rpResourceServices.factory("rpMoreChildrenResourceService",["$resource",function(e){return e("/api/morechildren",{sort:"confidence"})}]),rpResourceServices.factory("rpMessageResourceService",["$resource",function(e){return e("/api/uauth/message/:where",{after:"none"})}]),rpResourceServices.factory("rpGildResourceService",["$resource",function(e){return e("/api/uauth/gild")}]),rpResourceServices.factory("rpVoteResourceService",["$resource",function(e){return e("/api/uauth/vote/")}]),rpResourceServices.factory("rpDeleteResourceService",["$resource",function(e){return e("/api/uauth/del/")}]),rpResourceServices.factory("rpEditResourceService",["$resource",function(e){
return e("/api/uauth/editusertext")}]),rpResourceServices.factory("rpSaveResourceService",["$resource",function(e){return e("/api/uauth/save/")}]),rpResourceServices.factory("rpUnsaveResourceService",["$resource",function(e){return e("/api/uauth/unsave/")}]),rpResourceServices.factory("rpCommentResourceService",["$resource",function(e){return e("/api/uauth/comment")}]),rpResourceServices.factory("rpMessageComposeResourceService",["$resource",function(e){return e("/api/uauth/compose")}]),rpResourceServices.factory("rpSubmitResourceService",["$resource",function(e){return e("/api/uauth/submit")}]),rpResourceServices.factory("rpNeedsCaptchaResourceService",["$resource",function(e){return e("/api/uauth/needs_captcha")}]),rpResourceServices.factory("rpNewCaptchaResourceService",["$resource",function(e){return e("/api/uauth/new_captcha")}]),rpResourceServices.factory("rpCaptchaResourceService",["$resource",function(e){return e("/api/uauth/captcha/:iden")}]),rpResourceServices.factory("rpSearchResourceService",["$resource",function(e){return e("/api/search/:sub",{sub:"all",sort:"relevance",after:"",before:"",restrict_sr:!0,t:"all",type:"sr",limit:24})}]),rpResourceServices.factory("rpSettingsResourceService",["$resource",function(e){return e("/settings")}]),rpResourceServices.factory("rpShareEmailResourceService",["$resource",function(e){return e("/share")}]),rpResourceServices.factory("rpImgurAlbumResourceService",["$resource",function(e){return e("https://api.imgur.com/3/album/:id",{},{get:{headers:{Authorization:"Client-ID a912803498adcd4"}}})}]),rpResourceServices.factory("rpImgurGalleryResourceService",["$resource",function(e){return e(" https://api.imgur.com/3/gallery/:id",{},{get:{headers:{Authorization:"Client-ID a912803498adcd4"}}})}]),rpResourceServices.factory("rpTweetResourceService",["$resource",function(e){return e("/twitter/status/:id")}]),rpResourceServices.factory("rpGoogleUrlResourceService",["$resource",function(e){return e("https://www.googleapis.com/urlshortener/v1/url",{key:"AIzaSyCie8StCg7EAAOECOjLa3qEMocvi7YhQfU"})}]);var rpSaveControllers=angular.module("rpSaveControllers",[]);rpSaveControllers.controller("rpSaveButtonCtrl",["$scope","rpSaveUtilService","rpAuthUtilService","rpToastUtilService",function(e,t,r,o){e.save=function(){r.isAuthenticated?(e.saved=!e.saved,t(e.redditId,e.saved,function(e,t){e?console.log("[rpSaveButtonCtrl] err"):console.log("[rpSaveButtonCtrl] success")})):o("You've got to log in to save posts")}}]);var rpScoreControllers=angular.module("rpScoreControllers",[]);rpScoreControllers.controller("rpScoreCtrl",["$scope","rpAuthUtilService","rpToastUtilService","rpVoteUtilService",function(e,t,r,o){e.upvote=function(){if(console.log("[rpScoreCtrl] upvote()"),t.isAuthenticated){var i,s=e.score,n=e.likes;switch(e.likes){case!0:i=0,e.score=e.score-1,e.likes=null;break;case!1:i=1,e.score=e.score+2,e.likes=!0;break;default:i=1,e.score=e.score+1,e.likes=!0}o(e.redditId,i,function(t,o){t?(console.log("[rpScoreCtrl] upvote() err."),e.score=s,e.likes=n,r("Something went wrong trying to upvotes.")):console.log("[rpScoreCtrl] upvote() success.")})}else r("You must log in to vote")},e.downvote=function(){if(console.log("[rpScoreCtrl] downvote()"),t.isAuthenticated){var i,s=e.score,n=e.likes;switch(e.likes){case!0:i=-1,e.score=e.score-2,e.likes=!1;break;case!1:i=0,e.score=e.score+1,e.likes=null;break;default:i=-1,e.score=e.score-1,e.likes=!1}o(e.redditId,i,function(t,o){t?(r("Something went wrong tring to downvote."),e.score=s,e.lieks=n):console.log("[rpScoreCtrl] downvote() success.")})}else r("You must log in to vote")}}]);var rpSearchControllers=angular.module("rpSearchControllers",[]);rpSearchControllers.controller("rpSearchSidenavCtrl",["$scope","$rootScope",function(e,t){e.isOpen=!1,e.toggleOpen=function(){e.isOpen=!e.isOpen};var r=t.$on("search_form_visibility",function(t,r){e.isOpen=r});e.$on("$destroy",function(){r()})}]),rpSearchControllers.controller("rpSearchFormCtrl",["$scope","$rootScope","$location","$routeParams","$timeout","rpSearchUtilService","rpSubredditsUtilService","rpLocationUtilService",function(e,t,r,o,i,s,n,l){function a(){e.searchSubreddits&&e.searchLinks?e.params.type="sr, link":e.searchSubreddits?e.params.type="sr":e.searchLinks&&(e.params.type="link")}function c(e){var t=angular.lowercase(e);return function(e){return 0===e.data.display_name.indexOf(t)}}console.log("[rpSearchFormCtrl] loaded, $scope.$id: "+e.$id),e.params=s.params,n.currentSub&&""!==n.currentSub?(console.log("[rpSearchFormCtrl] rpSubredditsUtilService.currentSub: "+n.currentSub),e.params.sub=n.currentSub):e.params.sub="all","all"!==e.params.sub&&(e.params.type=e.params.formType="link");var p=/\/search.*/,u=p.test(r.path());console.log("[rpSearchFormCtrl] $onSearchPage: "+u),console.log("[rpSearchFormCtrl] $scope.params: "+JSON.stringify(e.params)),e.focusInput=!0,e.searchSubreddits="sr"===e.params.type||"sr, link"===e.params.type,e.searchLinks="link"===e.params.type||"sr, link"===e.params.type,e.toggleSearchSubreddits=function(){console.log("[rpSearchFormCtrl] toggleSearchSubreddits"),e.searchSubreddits=!e.searchSubreddits,e.searchLinks||(e.searchLinks=!0),a()},e.toggleSearchLinks=function(){console.log("[rpSearchFormCtrl] toggleSearchLinks"),e.searchLinks=!e.searchLinks,e.searchSubreddits||(e.searchSubreddits=!0),a()},e.subSearch=function(){e.subs=n.subs,console.log("[rpSearchFormCtrl] subSearch(), $scope.subs.length: "+e.subs.length);var t=e.params.sub?e.subs.filter(c(e.params.sub)):[];return t};var d=t.$on("search_params_changed",function(){e.params=s.params});e.submitSearchForm=function(){u=p.test(r.path()),console.log("[rpSearchFormCtrl] submitSearchForm, onSearchPage: "+u),console.log("[rpSearchFormCtrl] submitSearchForm, $scope.params: "+e.params),console.log("[rpSearchFormCtrl] submitSearchForm, rpSubredditsUtilService.currentSub"+n.currentSub),e.subSelectedItem&&(e.params.sub=e.subSelectedItem.data.display_name,console.log("[rpSearchFormCtrl] submitSearchForm, $scope.subSelectedItem: "+e.subSelectedItem.data.display_name)),""===e.params.sub&&(n.currentSub&&""!==n.currentSub?e.params.sub=n.currentSub:e.params.sub="all"),e.params.sub&&""!==e.params.sub||(e.params.sub="all"),"all"!==e.params.sub&&"link"!==e.params.type&&(e.params.type="link"),"all"===e.params.sub?e.params.restrict_sr=!1:e.params.restrict_sr=!0,e.params.after="",console.log("[rpSearchFormCtrl] submitSearchForm, $scope.params: "+JSON.stringify(e.params)),i(function(){l(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!u,!1),u&&t.$emit("search_form_submitted")},250)},e.resetSearchForm=function(){},e.$on("$destroy",function(){d()})}]),rpSearchControllers.controller("rpSearchCtrl",["$scope","$rootScope","$routeParams","$location","$window","$mdDialog","$mdBottomSheet","rpSubredditsUtilService","rpSearchUtilService","rpSearchFormUtilService","rpUserFilterButtonUtilService","rpUserSortButtonUtilService","rpPostFilterButtonUtilService","rpSubscribeButtonUtilService","rpSearchFilterButtonUtilService","rpByIdUtilService","rpLocationUtilService","rpSettingsUtilService","rpToolbarShadowUtilService","rpTitleChangeService","rpAuthUtilService","rpIdentityUtilService",function(e,t,r,o,i,s,n,l,a,c,p,u,d,g,m,h,S,f,b,v,C,$){function w(){if(console.log("[rpSearchCtrl] initTabs()"),"link"===e.params.type){t.$emit("rp_tabs_changed",k),t.$emit("rp_tabs_show"),t.$emit("rp_content_scroll_enable"),e.scroll=!0;for(var r=0;r<k.length;r++)if(e.params.sort===k[r].value){t.$emit("rp_tabs_selected_index_changed",r);break}}else t.$emit("rp_tabs_hide"),console.log("[rpSearchCtrl] emit rp_content_scroll_disable"),t.$emit("rp_content_scroll_disable"),e.scroll=!1}console.log("[rpSearchCtrl] loaded, $scope.$id: "+e.$id),p.hide(),u.hide(),d.hide(),g.hide(),console.log("[rpSearchCtrl] rpSubredditsUtilService.currentSub: "+l.currentSub),e.posts={},e.links={},e.subs={},e.haveSubs=e.haveLinks=e.havePosts=!1;var y=!1;e.nothingPosts=!1,e.nothingSubs=!1,e.nothingLinks=!1,e.noMorePosts=!1;var U=24;e.params=a.params,C.isAuthenticated&&$.getIdentity(function(t){e.identity=t}),e.showSub=!0,r.q&&(e.params.q=r.q,v.prepTitleChange("search: "+e.params.q)),r.sub?e.params.sub=r.sub:l.currentSub&&(e.params.sub=l.currentSub),"all"===e.params.sub||""===e.params.sub?(r.type&&(e.params.type=r.type),console.log("[rpSearchCtrl] set type, $scope.params.type: "+e.params.type),e.type=e.params.formType=e.params.type):e.type=e.params.formType=e.params.type="link";var _=/[.]*(author\:)[,]*/;_.test(e.params.q)&&(e.type=e.params.type="link",console.log("[rpSearchCtrl] rpSearchUtilService, author test inside.")),"link"!==e.params.type&&b.show(),r.restrict_sr&&(e.params.restrict_sr=r.restrict_sr),r.t&&(e.params.t=r.t),r.sort&&(e.params.sort=r.sort),r.after?e.params.after=r.after:e.params.after="",c.show();var k=[{label:"relevance",value:"relevance"},{label:"top",value:"top"},{label:"new",value:"new"},{label:"comments",value:"comments"}];w(),t.$emit("progressLoading"),console.log("[rpSearchCtrl] rpSearchUtilService, author test after."),"sr, link"===e.params.type?(console.log("[rpSearchCtrl] load sr and link"),e.params.type="sr",e.params.limit=4,console.log("[rpSearchCtrl] rpSearchUtilService.params.limit: "+a.params.limit),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(console.log("[rpSearchCtrl] sr, data.data.children.length: "+o.data.children.length),o&&o.data.children.length>0?(e.noMorePosts=o.data.children.length<e.params.limit,console.log("[rpSearchCtrl] sr + link search(sr), data.data.children.length: "+o.data.children.length),e.subs=o.data.children,e.haveSubs=!0):e.nothingSubs=!0,(e.haveLinks||e.nothingLinks)&&(t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))}),e.params.type="link",e.params.limit=4,a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(o&&o.data.children.length>0?(e.noMorePosts=o.data.children.length<e.params.limit,console.log("[rpSearchCtrl] sr + link search(link), data.data.children.length: "+o.data.children.length),e.links=o.data.children,e.haveLinks=!0):e.nothingLinks=!0,(e.haveSubs||e.nothingSubs)&&(console.log("[rpSearchCtrl] sr + link search(link) over, this should only run once."),t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))}),e.params.type="sr, link"):(console.log("[rpSearchCtrl] load sr or link"),a.search(function(r,o){t.$emit("progressComplete"),r?console.log("[rpSearchCtrl] err"):(console.log("[rpSearchCtrl] sr + link search(sr), data.data.children.length: "+o.data.children.length),o&&o.data.children.length>0?(e.noMorePosts=o.data.children.length<U,e.posts=o.data.children,e.havePosts=!0):e.nothingPosts=!0)})),e.thisController=this,this.completeDeleting=function(t){console.log("[rpSearchControllers] this.completeDeleting(), id:"+t);var r;"link"===e.params.type?r=e.posts:"sr, link"===e.params.type&&(r=e.links),r.forEach(function(e,o){e.data.name===t&&r.splice(o,1)})};var A=t.$on("rp_tab_click",function(r,o){console.log("[rpSearchCtrl] this.tabClick(), tab: "+o),e.params.sort=o,e.params.after="",S(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!0),e.posts={},e.havePosts=!1,e.noMorePosts=!1,t.$emit("progressLoading"),a.search(function(r,o){r?console.log("[rpSearchCtrl] this.tabClick(), err"):(e.noMorePosts=o.data.children.length<U,t.$emit("progressComplete"),e.posts=o.data.children,e.havePosts=!0)})});e.morePosts=function(){if(console.log("[rpSearchCtrl] morePost()"),e.posts&&e.posts.length>0){var r=e.posts[e.posts.length-1].data.name;console.log("[rpSearchCtrl] morePosts(), lastPostName: "+r),console.log("[rpSearchCtrl] morePosts(), loadingMore: "+y),r&&!y&&(y=!0,e.params.after=r,S(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!0),t.$emit("progressLoading"),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(console.log("[rpSearchCtrl] morePosts() data.length: "+o.length+", $scope.params.limit: "+e.params.limit),e.noMorePosts=o.data.children.length<U,t.$emit("progressComplete"),Array.prototype.push.apply(e.posts,o.data.children),e.havePosts=!0,y=!1)}))}},e.searchSub=function(r,o){console.log("[rpSearchCtrl] searchSub, post.data.display_name: "+o.data.display_name),console.log("[rpSearchCtrl] searchSub, e.ctrlKey: "+r.ctrlKey),r.ctrlKey?S(r,"/search","q="+e.params.q+"&sub="+o.data.display_name+"&type=link&restrict_sr=true&sort=relevance&after=&t=all",!0,!0):(e.params.sub=o.data.display_name,e.type=e.params.formType=e.params.type="link",e.params.restrict_sr=!0,e.params.after="",e.params.sort="relevance",e.params.t="all",S(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!1),e.posts={},e.havePosts=!1,e.nothingPosts=!1,e.nothingSubs=!1,e.nothingLinks=!1,e.noMorePosts=!1,t.$emit("progressLoading"),b.hide(),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(e.noMorePosts=o.data.children.length<U,t.$emit("progressComplete"),e.posts=o.data.children,e.havePosts=!0)}))},e.moreSubs=function(r){console.log("[rpSearchCtrl] moreSubs()"),w(),r.ctrlKey?S(r,"/search","q="+e.params.q+"&sub=all&type=sr&restrict_sr=false&sort=relevance&after=&t=all",!0,!0):(e.params.sub="all",e.type=e.params.formType=e.params.type="sr",e.params.restrict_sr=!1,e.params.after="",e.params.sort="relevance",e.params.t="all",S(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!1),e.posts={},e.subs={},e.links={},e.havePosts=!1,e.haveLinks=!1,e.haveSubs=!1,e.noMorePosts=!1,t.$emit("progressLoading"),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(e.noMorePosts=o.data.children.length<U,t.$emit("progressComplete"),e.posts=o.data.children,e.havePosts=!0)}))},e.moreLinks=function(r){console.log("[rpSearchCtrl] moreSubs()"),w(),r.ctrlKey?S(r,"/search","q="+e.params.q+"&sub=all&type=link&restrict_sr=false&sort=relevance&after=&t=all",!0,!0):(e.params.sub="all",e.type=e.params.formType=e.params.type="link",e.params.restrict_sr=!1,e.params.after="",e.params.sort="relevance",e.params.t="all",S(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!1),e.posts={},e.subs={},e.links={},e.havePosts=!1,e.haveLinks=!1,e.haveSubs=!1,e.noMorePosts=!1,t.$emit("progressLoading"),b.hide(),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(e.noMorePosts=o.data.children.length<U,t.$emit("progressComplete"),e.posts=o.data.children,e.havePosts=!0)}))},e.sharePost=function(e,t){console.log("[rpSearchCtrl] sharePost(), post.data.url: "+t.data.url),t.bottomSheet=!0;n.show({templateUrl:"partials/rpShareBottomSheet",controller:"rpShareCtrl",targetEvent:e,parent:".rp-view",disbaleParentScroll:!0,locals:{post:t}}).then(function(){console.log("[rpSearchCtrl] bottomSheet Resolved: remove rp-bottom-sheet class"),t.bottomSheet=!1})["catch"](function(){console.log("[rpSearchCtrl] bottomSheet Rejected: remove rp-bottom-sheet class"),t.bottomSheet=!1})};var M=t.$on("search_time_click",function(r,o){console.log("[rpSearchCtrl] search_time_click, time: "+o),e.posts={},e.havePosts=!1,e.noMorePosts=!1,e.params.t=o,e.params.after="",S(null,"/search","q="+e.params.q+"&sub="+e.params.sub+"&type="+e.params.type+"&restrict_sr="+e.params.restrict_sr+"&sort="+e.params.sort+"&after="+e.params.after+"&t="+e.params.t,!1,!0),e.posts={},e.havePosts=!1,t.$emit("progressLoading"),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(e.noMorePosts=o.data.children.length<U,t.$emit("progressComplete"),e.posts=o.data.children,e.havePosts=!0)})}),D=t.$on("search_form_submitted",function(){e.posts={},e.havePosts=!1,e.nothingPosts=!1,e.nothingSubs=!1,e.nothingLinks=!1,e.noMorePosts=!1,t.$emit("progressLoading");var r=/[.]*(author\:)[,]*/;r.test(e.params.q)&&(e.type=e.params.type="link"),e.type=e.params.type,"link"!==e.params.type?b.show():b.hide(),w(),"sr, link"===e.params.type?(console.log("[rpSearchCtrl] load sr and link"),e.subs={},e.haveSubs=!1,e.params.type="sr",e.params.limit=4,console.log("[rpSearchCtrl] rpSearchUtilService.params.limit: "+a.params.limit),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(o&&o.data.children.length>0?(e.subs=o.data.children,e.haveSubs=!0,console.log("[rpSearchCtrl] sr + link, subs loaded, $scope.links.length: "+e.links.length+", $scope.subs.length: "+e.subs.length)):(console.log("[rpSearchCtrl] submitSearchForm, no subs found."),e.nothingSubs=!0),(e.haveLinks||e.nothingLinks)&&(t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))}),e.links={},e.haveLinks=!1,e.params.type="link",e.params.limit=4,a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(o&&o.data.children.length>0?(e.links=o.data.children,e.haveLinks=!0,console.log("[rpSearchCtrl] sr + link, links loaded, $scope.links.length: "+e.links.length+", $scope.subs.length: "+e.subs.length)):(console.log("[rpSearchCtrl] submitSearchForm, no links found."),e.nothingLinks=!0),(e.haveSubs||e.nothingSubs)&&(t.$emit("progressComplete"),e.params.limit=24,e.params.type="sr, link"))})):(console.log("[rpSearchCtrl] load sr or link"),a.search(function(r,o){r?console.log("[rpSearchCtrl] err"):(t.$emit("progressComplete"),o&&o.data.children.length>0?(e.noMorePosts=o.data.children.length<U,e.posts=o.data.children,e.havePosts=!0,e.type=e.params.type):(console.log("[rpSearchCtrl] submitSearchForm, no posts found."),e.nothingPosts=!0))}))});e.$on("$destroy",function(){console.log("[rpSearchCtrl] destroy()"),D(),M(),A()})}]),rpSearchControllers.controller("rpSearchTimeFilterCtrl",["$scope","$rootScope","rpSearchUtilService",function(e,t,r){e.type=r.params.type,console.log("[rpSearchTimeFilterCtrl] $scope.type: "+e.type),e.selectTime=function(e){t.$emit("search_time_click",e)}}]),rpSearchControllers.controller("rpSearchSubscriptionCtrl",["$scope","$rootScope","rpSubredditsUtilService",function(e,t,r){console.log("[rpSearchSubscriptionCtrl] loaded."),e.loadingSubscription=!1,e.subscribed=r.isSubscribed(e.post.data.display_name),e.toggleSubscription=function(){e.loadingSubscription=!0;var t=e.subscribed?"unsub":"sub";console.log("[rpSearchSubscriptionCtrl] toggleSubscription(), $scope.post.data.title: "+e.post.data.display_name+", subscribed: "+e.subscribed),r.subscribe(t,e.post.data.name,function(t,r){console.log("[rpSearchSubscriptionCtrl] callback, $scope.post.data.title: "+e.post.data.title),t?console.log("[rpSearchSubscriptionCtrl] err"):(console.log("[rpSearchSubscriptionCtrl] callback, subscribed: "+e.subscribed),e.loadingSubscription=!1,console.log("[rpSearchSubscriptionCtrl] callback, subscribed: "+e.subscribed))})};var o=t.$on("subreddits_updated",function(){e.subscribed=r.isSubscribed(e.post.data.display_name)});e.$on("$destroy",function(){o()})}]);var rpServices=angular.module("rpServices",[]);rpServices.factory("rpTitleChangeService",["$rootScope",function(e){var t={};return t.title="frontpage",t.prepTitleChange=function(r){t.title=r,e.$broadcast("handleTitleChange")},t}]);var rpSettingsControllers=angular.module("rpSettingsControllers",[]);rpSettingsControllers.controller("rpSettingsDialogCtrl",["$scope","$rootScope","$location","$mdDialog","rpSettingsUtilService",function(e,t,r,o,i){e.isDialog=!0;var s=e.$on("$locationChangeSuccess",function(){o.hide()});e.$on("$destroy",function(){s()})}]),rpSettingsControllers.controller("rpSettingsCtrl",["$scope","$rootScope","rpSettingsUtilService","rpTitleChangeService",function(e,t,r,o){console.log("[rpSettingsCtrl]"),e.settings=r.getSettings(),e.isDialog||o.prepTitleChange("Settings"),e.settingChanged=function(){r.setSettings(e.settings)};var i=t.$on("settings_changed",function(){e.settings=r.getSettings()});e.$on("$destroy",function(){i()})}]),rpSettingsControllers.controller("rpSettingsSidenavCtrl",["$scope","$rootScope","$mdDialog","rpSettingsUtilService","rpLocationUtilService",function(e,t,r,o,i){e.showSettings=function(e){o.settings.settingsDialog?r.show({controller:"rpSettingsDialogCtrl",templateUrl:"partials/rpSettingsDialog",targetEvent:e,clickOutsideToClose:!0,escapeToClose:!0}):i(null,"/settings","",!0,!1)},e.$on("$destroy",function(){})}]);var rpShareControllers=angular.module("rpShareControllers",[]);rpShareControllers.controller("rpShareButtonCtrl",["$scope","$rootScope","$mdBottomSheet",function(e,t,r){var o=!1;e.share=function(i){parseInt(angular.element(".rp-tab-toolbar").css("top"))>=0&&(t.$emit("rp_tabs_hide",!0),o=!0),r.show({templateUrl:"partials/rpShareBottomSheet",controller:"rpShareCtrl",targetEvent:i,parent:".rp-bottom-sheet-parent",disbaleParentScroll:!0,locals:{post:e.post}}).then(function(){},function(){o&&t.$emit("rp_tabs_show",!0)})["catch"](function(){})}}]),rpShareControllers.controller("rpShareCtrl",["$scope","$window","$filter","$mdBottomSheet","$mdDialog","rpLocationUtilService","rpSettingsUtilService","rpGoogleUrlUtilService","post",function(e,t,r,o,i,s,n,l,a){console.log("[rpShareCtrl] shareLink: "+a.data.url);var c=a?"http://www.reddup.com"+a.data.permalink:"http://www.reddup.com",p=a?a.data.title:"reddup.com",u="http://reddup.co/logo";a&&""!==a.data.thumbnail&&"self"!==a.data.thumbnail&&(u=a.data.thumbnail),e.items=[{name:"reddit user",icon:"/icons/reddit-square.svg"},{name:"email",icon:"/icons/ic_email_black_48px.svg"},{name:"facebook",icon:"/icons/facebook-box.svg"},{name:"twitter",icon:"/icons/twitter-box.svg"}],e.listItemClicked=function(e,r){switch(console.log("[rpShareCtrl] listItemClicked, $index: "+r),o.hide(),r){case 0:i.show({controller:"rpMessageComposeDialogCtrl",templateUrl:"partials/rpMessageComposeDialog",clickOutsideToClose:!1,escapeToClose:!1,locals:{shareLink:c,shareTitle:p}});break;case 1:console.log("[rpShareCtrl] email"),i.show({controller:"rpShareEmailDialogCtrl",templateUrl:"partials/rpShareEmailDialog",clickOutsideToClose:!1,escapeToClose:!1,locals:{shareLink:c,shareTitle:p}});break;case 2:console.log("[rpShareCtrl] facebook"),console.log("[rpShareCtrl] facebook, shareThumb: "+u);var s="https://www.facebook.com/dialog/feed?app_id=868953203169873&name=";s+=encodeURIComponent(p),s+="&link=",s+=encodeURIComponent(c),s+="&redirect_uri=",s+=encodeURIComponent("http://reddup.co/facebookComplete"),s+="&picture=",s+=u,s+="&display=popup",t.open(s,"Share with facebook","height=500,width=500");break;case 3:console.log("[rpShareCtrl] twitter, shareTitle: "+p);var n;p.length+c.length<127?(n=p+", "+c+" via @reddup",t.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(n)+" via @reddup","Share with twitter","height=500,width=500")):l(c,function(e,r){if(e)console.log("[rp_twitter_message] error occurred shortening url.");else{if(console.log("[rp_twitter_message] data.id: "+r.id),console.log("[rp_twitter_message] shareTitle.length: "+p.length),console.log("[rp_twitter_message] data.id.length: "+r.id.length),p.length+r.id.length<123)n=p+", "+r.id+" via @reddup";else{console.log("[rp_twitter_message] use short title");var o=p.substr(0,123-r.id.length);n=o+".. "+r.id+" via @reddup"}t.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(n),"Share with twitter","height=500,width=500")}})}}}]),rpShareControllers.controller("rpShareEmailDialogCtrl",["$scope","$location","$mdDialog","shareLink","shareTitle",function(e,t,r,o,i){console.log("[rpShareEmailDialogCtrl] shareLink: "+o),console.log("[rpShareEmailDialogCtrl] shareTitle: "+i),e.shareLink=o,e.shareTitle=i;var s=e.$on("$locationChangeSuccess",function(){r.hide()});e.$on("$destroy",function(){s()})}]),rpShareControllers.controller("rpShareEmailFormCtrl",["$scope","$mdDialog","rpShareEmailUtilService",function(e,t,r){function o(){e.to="",e.text="Check this out, ["+e.shareTitle+"]("+e.shareLink+")",e.showAnother=!1,e.showButtons=!0,e.showSubmit=!0,angular.element("#share-to").focus()}console.log("[rpShareEmailFormCtrl]"),o(),e.submitForm=function(){e.showProgress=!0,e.showButtons=!1;var t="reddup shared link: "+e.shareTitle;r(e.to,e.text,t,function(t,r){t?console.log("[rpShareEmailFormCtrl] err"):(e.feedbackMessage="Email sent :).",e.showProgress=!1,e.showAnother=!0,e.showSubmit=!1,e.showButtons=!0)})},e.resetForm=function(){o()},e.closeDialog=function(){t.hide()}}]);var rpSubmitControllers=angular.module("rpSubmitControllers",[]);rpSubmitControllers.controller("rpSubmitDialogCtrl",["$scope","$location","$mdDialog","subreddit",function(e,t,r,o){e.isDialog=!0,o&&"all"===o||(e.subreddit=o);var i=e.$on("$locationChangeSuccess",function(){r.hide()});e.$on("$destroy",function(){i()})}]),rpSubmitControllers.controller("rpSubmitFormCtrl",["$scope","$rootScope","$interval","$mdDialog","rpSubmitUtilService","rpSubredditsUtilService","rpSidebarButtonUtilService","rpLocationUtilService",function(e,t,r,o,i,s,n,l){function a(e){var t=angular.lowercase(e);return function(e){return 0===e.data.display_name.indexOf(t)}}function c(){e.title="",e.url="",e.text="",e.sendreplies=!0,e.iden="",e.cpatcha="",p&&(e.subreddit=""),e.showSubmit=!0,e.showRatelimit=!1,e.showAnother=!1,e.showRepost=!1,e.showMessage=!1,e.showButtons=!0,e.rpSubmitNewLinkForm&&e.rpSubmitNewLinkForm.$setUntouched()}e.subreddit||(e.subreddit=s.currentSub),!e.isDialog&&e.subreddit&&n.show();var p=!1;e.subreddit||(p=!0),c();var u;e.subs=s.subs,e.subSearch=function(t){u=t;var r=t?e.subs.filter(a(t)):[];return r},e.resetForm=function(){c(),t.$emit("reset_captcha")},e.submitLink=function(o){e.showProgress=!0,e.showButtons=!1,e.showFeedback=!1;var s=e.url?"link":"self";console.log("[rpSubmitFormCtrl] e.target.elements: "+o.target.elements),o.target.elements.submitTitleInput.blur(),o.target.elements.submitSubredditInput&&o.target.elements.submitSubredditInput.blur(),o.target.elements.submitUrlInput&&o.target.elements.submitUrlInput.blur(),o.target.elements.submitTextInput&&o.target.elements.submitTextInput.blur(),o.target.elements.captchaInput&&o.target.elements.captchaInput.blur(),e.subreddit||(e.subreddit=e.mdSelectedItem?e.mdSelectedItem.data.display_name:u),i(s,e.resubmit,e.sendreplies,e.subreddit,e.text,e.title,e.url,e.iden,e.captcha,function(o,i){if(e.showProgress=!1,o){var s=JSON.parse(o.body);if(console.log("[rpSubmitFormCtrl] err"),s.json.errors.length>0)if("RATELIMIT"===s.json.errors[0][0]){e.showSubmit=!1,e.showRatelimit=!0;var n=s.json.ratelimit,l=r(function(){var o=parseInt(n/60,10),i=parseInt(n%60,10);o=10>o?"0"+o:o,i=10>i?"0"+i:i,e.rateLimitTimer=o+":"+i,--n<0&&(t.$emit("reset_captcha"),e.showRatelimit=!1,e.showFeedbackAlert=!1,e.feedbackMessage="Alright, you should be able to post now, give it another go.",e.showSubmit=!0,r.cancel(l))},1e3);e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showButtons=!0}else"QUOTA_FILLED"===s.json.errors[0][0]?(e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showSubmit=!1,e.showButtons=!0):"BAD_CAPTCHA"===s.json.errors[0][0]?(t.$emit("reset_captcha"),e.feedbackMessage="You entered the CAPTCHA incorrectly. Please try again.",e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showButtons=!0):"ALREADY_SUB"===s.json.errors[0][0]?(t.$emit("reset_captcha"),e.resubmit=!0,e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showSubmit=!1,e.showRepost=!0,e.showButtons=!0):(console.log("[rpSubmitFormCtrl] error catchall: "+JSON.stringify(s)),t.$emit("reset_captcha"),e.feedbackMessage=s.json.errors[0][1],e.showFeedbackAlert=!0,e.showFeedbackLink=!1,e.showFeedback=!0,e.showSubmit=!0,e.showButtons=!0);else s.json.data.url||(t.$emit("reset_captcha"),e.feedbackMessage="An error occurred trying to post your link.\nPlease check the url, wait a few minutes and try again.",e.showFeedbackLink=!1,e.showFeedbackAlert=!0,e.showFeedback=!0,e.showButtons=!0)}else{var a=/^https?:\/\/www\.reddit\.com\/r\/([\w]+)\/comments\/([\w]+)\/(?:[\w]+)\//i,c=a.exec(i.json.data.url);c&&(e.feedbackLink="/r/"+c[1]+"/comments/"+c[2]),e.feedbackLinkName="Your post",e.feedbackMessage="was submitted successfully.",e.showFeedbackAlert=!1,e.showFeedbackLink=!0,e.showFeedback=!0,e.showRepost=!1,e.showSubmit=!1,e.showAnother=!0,e.showButtons=!0}})},e.closeDialog=function(){console.log("[rpSubmitFormCtrl] closeDialog(), $scope.isDialog: "+e.isDialog),e.isDialog?o.hide():(console.log("[rpSubmitFormCtrl] closeDialog in page"),s.currentSub?l(null,"/r/"+s.currentSub,"",!0,!1):l(null,"/","",!0,!1))}}]);var rpTabsControllers=angular.module("rpTabsControllers",[]);rpTabsControllers.controller("rpTabsCtrl",["$scope","$timeout","$rootScope",function(e,t,r){console.log("[rpTabsCtrl]"),e.tabs=[],e.selectedIndex=0,e.tabClick=function(e){console.log("[rpTabsCtrl] tabClick(), tab: "+e),t(function(){r.$emit("rp_tab_click",e)},350)};var o=r.$on("rp_tabs_changed",function(t,r){console.log("[rpTabsControllers] onTabsChanged(), tabs: "+r),console.log("[rpTabsControllers] onTabsChanged(), tabs.length: "+r.length),e.selectedIndex=0,e.tabs=r,e.showTabs=!0}),i=r.$on("rp_tabs_selected_index_changed",function(t,r){console.log("[rpTabsControllers] rpTabsSelectedIndexChanged, selectedIndex: "+r),e.selectedIndex=r});e.$on("$destroy",function(){i(),o()})}]);var rpUserControllers=angular.module("rpUserControllers",[]);rpUserControllers.controller("rpUserCtrl",["$scope","$rootScope","$window","$routeParams","rpUserUtilService","rpTitleChangeService","rpSettingsUtilService","rpUserFilterButtonUtilService","rpPostFilterButtonUtilService","rpSubscribeButtonUtilService","rpLocationUtilService","rpIdentityUtilService","rpSearchFormUtilService","rpSearchFilterButtonUtilService","rpToolbarShadowUtilService","rpAuthUtilService","rpSidebarButtonUtilService","rpUserSortButtonUtilService",function(e,t,r,o,i,s,n,l,a,c,p,u,d,g,m,h,S,f){function b(){console.log("[rpUserCtrl] loadPosts()"),e.posts={},e.havePosts=!1,e.noMorePosts=!1,t.$emit("progressLoading"),i(w,y,U,"",_,$,function(r,o){t.$emit("progressComplete"),r?console.log("[rpUserCtrl] err"):(console.log("[rpUserCtrl] data.length: "+o.get.data.children.length),o.get.data.children.length<$&&(e.noMorePosts=!0),e.posts=o.get.data.children,e.havePosts=!0)})}console.log("[rpUserCtrl] loaded."),console.log("[rpUserCtrl] $routeParams: "+JSON.stringify(o));var v=[{label:"overview",value:"overview"},{label:"submitted",value:"submitted"},{label:"comments",value:"comments"},{label:"gilded",value:"gilded"}];t.$emit("rp_tabs_changed",v),a.hide(),c.hide(),d.hide(),g.hide(),m.hide(),S.hide();var C=!1,$=24,w=o.username,y=o.where||"overview",U=o.sort||"new",_=o.t||"none";if("top"===U||"controversial"===U?l.show():l.hide(),s.prepTitleChange("u/"+w),e.commentsDialog=n.settings.commentsDialog,h.isAuthenticated)u.getIdentity(function(r){e.isMe=w===r.name,e.isMe?(v=v.concat([{label:"upvoted",value:"upvoted"},{label:"downvoted",value:"downvoted"},{label:"hidden",value:"hidden"},{label:"saved",value:"saved"}]),t.$emit("rp_tabs_changed",v),t.$emit("rp_tabs_show")):("upvoted"===y||"downvoted"===y||"hidden"===y||"saved"===y)&&(y="overview",p(null,"/u/"+w+"/"+y,"",!1,!0)),console.log("[rpUserCtrl] $scope.isMe: "+e.isMe),console.log("[rpUserCtrl] where: "+y);for(var o=0;o<v.length;o++)if(y===v[o].value){t.$emit("rp_tabs_selected_index_changed",o);break}b()});else{console.log("[rpUserCtrl] where: "+y),e.isMe=!1,("upvoted"===y||"downvoted"===y||"hidden"===y||"saved"===y)&&(y="overview",p(null,"/u/"+w+"/"+y,"",!1,!0));for(var k=0;k<v.length;k++)if(y===v[k].value){t.$emit("rp_tabs_selected_index_changed",k);break}b()}var A=t.$on("settings_changed",function(t){e.commentsDialog=n.settings.commentsDialog;
}),M=t.$on("user_sort_click",function(e,t){console.log("[rpUserCtrl] user_sort_click"),U=t,p(null,"/u/"+w+"/"+y,"sort="+U,!1,!1),"top"===U||"controversial"===U?l.show():l.hide(),b()}),D=t.$on("user_t_click",function(e,t){console.log("[rpUserCtrl] user_t_click"),_=t,p(null,"/u/"+w+"/"+y,"sort="+U+"&t="+_,!1,!1),b()}),T=t.$on("rp_tab_click",function(r,o){console.log("[rpUserCtrl] this.tabClick(), tab: "+o),e.posts={},e.noMorePosts=!1,y=o,p(null,"/u/"+w+"/"+y,"",!1,!1),e.havePosts=!1,t.$emit("progressLoading"),i(w,y,U,"",_,$,function(r,o){t.$emit("progressComplete"),r?console.log("[rpUserCtrl] err"):(o.get.data.children.length<$&&(e.noMorePosts=!0),e.posts=o.get.data.children,e.havePosts=!0)}),"overview"===o||"submitted"===o||"comments"===o?f.show():f.hide()});e.thisController=this,this.completeDeleting=function(t){console.log("[rpUserCtrl] completeDeleting()"),e.posts.forEach(function(r,o){r.data.name===t&&e.posts.splice(o,1)})},e.morePosts=function(){if(console.log("[rpUserCtrl] morePosts()"),e.posts&&e.posts.length>0){var r=e.posts[e.posts.length-1].data.name;r&&!C&&(C=!0,t.$emit("progressLoading"),i(w,y,U,r,_,$,function(r,o){t.$emit("progressComplete"),r?console.log("[rpUserCtrl] err"):(o.get.data.children.length<$&&(e.noMorePosts=!0),Array.prototype.push.apply(e.posts,o.get.data.children),C=!1)}))}},e.$on("$destroy",function(){D(),M(),A(),T(),t.$emit("rp_tabs_hide")})}]),rpUserControllers.controller("rpUserSortCtrl",["$scope","$rootScope","$routeParams","rpUserFilterButtonUtilService",function(e,t,r,o){var i=t.$on("$routeChangeSuccess",function(){console.log("[rpUserSortCtrl] onRouteChangeSuccess, $routeParams: "+JSON.stringify(r)),e.userSort=r.sort||"new"});e.selectSort=function(e){console.log("[rpUserSortCtrl] selectSort()"),"top"===e||"controversial"===e?o.show():o.hide(),t.$emit("user_sort_click",e)},e.$on("$destroy",function(){i()})}]),rpUserControllers.controller("rpUserTimeFilterCtrl",["$scope","$rootScope","$routeParams",function(e,t,r){var o=t.$on("$routeChangeSuccess",function(){console.log("[rpUserTimeFilterCtrl] onRouteChangeSuccess, $routeParams: "+JSON.stringify(r)),e.userTime=r.t||"all"});e.selectTime=function(e){console.log("[rpUserTimeFilterCtrl] selectTime()"),t.$emit("user_t_click",e)},e.$on("$destroy",function(){o()})}]);var rpUtilServices=angular.module("rpUtilServices",[]);rpUtilServices.factory("rpGoogleUrlUtilService",["rpGoogleUrlResourceService",function(e){return function(t,r){console.log("[rpGoogleUrlUtilService] longUrl: "+t),e.save({longUrl:t},function(e){typeof e===Error?r(e,null):(console.log("[rpGoogleUrlUtilService] data: "+console.log(JSON.stringify(e))),r(null,e))})}}]),rpUtilServices.factory("rpSearchUtilService",["$rootScope","rpSearchResourceService","rpLocationUtilService","rpToastUtilService",function(e,t,r,o){var i={};return i.params={q:"",sub:"all",type:"sr, link",sort:"relevance",t:"all",after:""},i.search=function(e){console.log("[rpSearchUtilService] search()"),i.params.q?t.get({sub:i.params.sub,q:i.params.q,restrict_sub:i.params.restrict_sub,sort:i.params.sort,type:i.params.type,t:i.params.t,after:i.params.after,limit:i.params.limit},function(t){t.responseError?(o("Something went wrong with your search request :/"),e(t,null)):e(null,t)}):e(null,null)},i}]),rpUtilServices.factory("rpLocationUtilService",["$location","$window",function(e,t){return function(r,o,i,s,n){null!==r&&r.ctrlKey?(o=i?o+"?"+i:o,console.log("[rpLocationUtilService] search: "+i),console.log("[rpLocationUtilService] url: "+o),t.open(o)):(console.log("[rpLocationUtilService] url: "+o),console.log("[rpLocationUtilService] search: "+i),console.log("[rpLocationUtilService] reload: "+s),console.log("[rpLocationUtilService] replace: "+n),e.search(i),e.path(o,s),n&&e.replace())}}]),rpUtilServices.factory("rpSettingsUtilService",["$rootScope","rpSettingsResourceService","rpToastUtilService",function(e,t,r){var o={};return o.settings={over18:!0,composeDialog:!0,commentsDialog:!0,submitDialog:!0,settingsDialog:!0},o.getSettings=function(){return console.log("[rpSettingsUtilService] getSetting, settings: "+JSON.stringify(o.settings)),o.settings},o.setSettings=function(e){console.log("[rpSettingsUtilService] setSetting, settings: "+JSON.stringify(o.settings)),o.settings=e,o.saveSettings()},o.retrieveSettings=function(){t.get(function(t){if(console.log("[rpSettingsUtilService] retrieveSettings, data: "+JSON.stringify(t)),console.log("[rpSettingsUtilService] retrieveSettings, data.loadDefaults: "+JSON.stringify(t)),t.loadDefaults!==!0){console.log("[rpSettingsUtilService] retrieveSettings, using server settings");for(var r in t)o.settings[r]=t[r]}console.log("[rpSettingsUtilService] emit settings_changed"),e.$emit("settings_changed")})},o.saveSettings=function(){t.save(o.settings,function(e){console.log("[rpSettingsUtilService] saveSettings, data: "+JSON.stringify(e))}),r("Setting Saved :)!"),e.$emit("settings_changed")},e.$on("authenticated",function(){o.retrieveSettings()}),o}]),rpUtilServices.factory("rpSearchFormUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("search_form_visibility",!0)},t.hide=function(){t.isVisible=!1,e.$emit("search_form_visibility",!1)},t}]),rpUtilServices.factory("rpSubscribeButtonUtilService",["$rootScope","rpSubredditsUtilService",function(e,t){var r={};return r.isVisible=!1,r.show=function(){r.isVisible=!0,e.$emit("subscribe_visibility")},r.hide=function(){console.log("[rpSubscribeButtonUtilService] hide(), rpSubredditsUtilService.resetSubreddit() called."),r.isVisible=!1,t.resetSubreddit(),e.$emit("subscribe_visibility")},r}]),rpUtilServices.factory("rpUserSortButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("user_sort_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("user_sort_button_visibility")},t}]),rpUtilServices.factory("rpSidebarButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("rules_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("rules_button_visibility")},t}]),rpUtilServices.factory("rpUserFilterButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("user_filter_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("user_filter_button_visibility")},t}]),rpUtilServices.factory("rpPostFilterButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("post_filter_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("post_filter_button_visibility")},t}]),rpUtilServices.factory("rpSearchFilterButtonUtilService",["$rootScope",function(e){var t={};return t.isVisible=!1,t.show=function(){t.isVisible=!0,e.$emit("search_filter_button_visibility")},t.hide=function(){t.isVisible=!1,e.$emit("search_filter_button_visibility")},t}]),rpUtilServices.factory("rpIdentityUtilService",["rpIdentityResourceService","rpAuthUtilService",function(e,t){var r={},o=[],i=!1;return r.identity=null,r.reloadIdentity=function(e){r.identity=null,r.getIdentity(e)},r.getIdentity=function(s){console.log("[rpIdentityUtilService] getIdentity()"),t.isAuthenticated?null!==r.identity?(console.log("[rpIdentityUtilService] getIdentity(), have identity"),s(r.identity)):(o.push(s),i===!1&&(i=!0,console.log("[rpIdentityUtilService] getIdentity(), requesting identity"),e.get(function(e){r.identity=e,i=!1;for(var t=0;t<o.length;t++)o[t](r.identity);o=[]}))):s(null)},r}]),rpUtilServices.factory("rpAuthUtilService",["$rootScope","rpSettingsUtilService",function(e,t){var r={};return r.isAuthenticated=!1,r.setIdentity=function(e){r.identity=e},r.setAuthenticated=function(t){console.log("[rpAuthUtilService] setAuthenticated: "+t),r.isAuthenticated=t,e.$emit("authenticated")},r}]),rpUtilServices.factory("rpToastUtilService",["$mdToast",function(e){return function(t){e.show({locals:{toastMessage:t},controller:"rpToastCtrl",templateUrl:"partials/rpToast",hideDelay:2500,position:"top left"})}}]),rpUtilServices.factory("rpGildUtilService",["rpGildResourceService","rpToastUtilService",function(e,t){return function(r,o){e.save({fullname:r},function(e){if(e.responseError){var r=JSON.parse(e.body);console.log("[rpGildUtilService] body.reason: "+r.reason),t("INSUFFICIENT_CREDDITS"===r.reason?"You aint got no creddits in your reddit account :/":"Something went wrong trying to gild this post :/"),o(e,null)}else t("gilded post is gilded :)"),o(null,e)})}}]),rpUtilServices.factory("rpEditUtilService",["rpEditResourceService","rpToastUtilService",function(e,t){return function(r,o,i){console.log("[rpEditUtilService]"),e.save({text:r,thing_id:o},function(e){e.responseError?(t("Something went wrong trying to edit your post :/"),i(e,null)):(t("Post Editted"),i(null,e))})}}]),rpUtilServices.factory("rpDeleteUtilService",["rpAuthUtilService","rpDeleteResourceService","rpToastUtilService",function(e,t,r){return function(e,o){console.log("[rpDeleteUtilService] name: "+e),t.save({id:e},function(e){e.responseError?(r("Something went wrong trying to delete your post :/"),o(e,null)):(r("Post deleted"),o(null,e))})}}]),rpUtilServices.factory("rpSaveUtilService",["rpSaveResourceService","rpUnsaveResourceService",function(e,t){return function(r,o,i){var s=o?e:t;s.save({id:r},function(e){e.responseError?i(e,null):i(null,e)})}}]),rpUtilServices.factory("rpVoteUtilService",["rpAuthUtilService","rpToastUtilService","rpVoteResourceService",function(e,t,r){return function(e,t,o){r.save({id:e,dir:t},function(e){e.responseError?o(e,null):o(null,e)})}}]),rpUtilServices.factory("rpCommentUtilService",["rpAuthUtilService","rpCommentResourceService","rpToastUtilService",function(e,t,r){var o=!1;return function(i,s,n){console.log("[rpCommentUtilService]"),e.isAuthenticated?s&&!o&&(o=!0,t.save({parent_id:i,text:s},function(e){if(o=!1,e.responseError){console.log("[rpCommentUtilService] responseError: "+JSON.stringify(e));var t="Something went wrong trying to post you comment :/";if(e.body){var i=JSON.parse(e.body);console.log("[rpCommentUtilService] responseError, data.body.json: "+JSON.stringify(i.json)),"TOO_OLD"===i.json.errors[0][0]&&(t=i.json.errors[0][1])}r(t),n(e,null)}else r("Comment Posted :)"),n(null,e)})):r("You've got to log in to post comments")}}]),rpUtilServices.factory("rpMessageComposeUtilService",["rpAuthUtilService","rpMessageComposeResourceService","rpToastUtilService",function(e,t,r){return function(o,i,s,n,l,a){e.isAuthenticated?t.save({subject:o,text:i,to:s,iden:n,captcha:l},function(e){e.responseError?(r("Something went wrong trying to send your message :/"),a(e,null)):(console.log("[rpMessageComposeUtilService] data: "+JSON.stringify(e)),a(null,e))}):r("You've got to log in send messages.")}}]),rpUtilServices.factory("rpSubmitUtilService",["rpAuthUtilService","rpSubmitResourceService","rpToastUtilService",function(e,t,r){return function(o,i,s,n,l,a,c,p,u,d){e.isAuthenticated?t.save({kind:o,sendreplies:s,sr:n,text:l,title:a,url:c,resubmit:i,iden:p,captcha:u},function(e){console.log("[rpSubmitUtilService] data.constructor.name: "+e.constructor.name),console.log("[rpSubmitUtilService] data: "+JSON.stringify(e)),e.responseError?d(e,null):(console.log("[rpSubmitUtilService] data: "+JSON.stringify(e)),d(null,e))}):r("You've got to log in to submit links.")}}]),rpUtilServices.factory("rpShareEmailUtilService",["rpShareEmailResourceService","rpToastUtilService",function(e,t){return function(r,o,i,s){e.save({to:r,text:o,subject:i},function(e){e.responseError?(t("Something went wrong trying to send your email :/"),s(e,null)):(console.log("[rpShareEmailUtilService] data: "+e),t("Email Sent :)"),s(null,e))})}}]),rpUtilServices.factory("rpCaptchaUtilService",["rpAuthUtilService","rpToastUtilService","rpNeedsCaptchaResourceService","rpNewCaptchaResourceService","rpCaptchaResourceService",function(e,t,r,o,i){var s={};return s.needsCaptcha=function(e){r.get(function(t){console.log("[rpCaptchaUtilService] needsCaptcha, data: "+JSON.stringify(t)),t.responseError?e(t,null):e(null,t)})},s.newCaptcha=function(e){o.save(function(t){console.log("[rpCaptchaUtilService] newCaptcha, data: "+JSON.stringify(t)),t.responseError?e(t,null):e(null,t)})},s.captcha=function(e,t){i.get({iden:e},function(e){e.responseError?t(e,null):t(null,e)})},s}]),rpUtilServices.factory("rpSubredditsUtilService",["$rootScope","rpSubredditsResourceService","rpSubredditsMineResourceService","rpSubbscribeResourceService","rpSubredditAboutResourceService","rpAuthUtilService","rpToastUtilService",function(e,t,r,o,i,s,n){function l(t){console.log("[rpSubredditsUtilService] loadUserSubreddits()"),r.get({limit:m},function(r){r.responseError?(n("Something went wrong updating your subreddits."),t(r,null)):(console.log("[rpSubredditsUtilService] loadUserSubreddits(), data.get.data.children.length: "+r.get.data.children.length),console.log("[rpSubredditsUtilService] loadUserSubreddits(), data.allChildren.length: "+r.allChildren.length),r.get.data.children.length>0?(g.subs=r.get.data.children,r.get.data.children.length<m?(e.$emit("subreddits_updated"),u(),t(null,r)):a(r.get.data.children[r.get.data.children.length-1].data.name,t)):c(t))})}function a(t,o){console.log("[rpSubredditsUtilService] loadMoreUserSubreddits(), after: "+t),r.get({limit:m,after:t},function(t){t.responseError?(n("Something went wrong updating your subreddits."),o(t,null)):(console.log("[rpSubredditsUtilService] loadMoreUserSubreddits(), data.get.data.children.length: "+t.get.data.children.length+", limit: "+m),g.subs=g.subs.concat(t.get.data.children),t.get.data.children.length<m?(e.$emit("subreddits_updated"),u(),o(null,t)):(console.log("[rpSubredditsUtilService] loadMoreUserSubreddits() calling loadMoreUserSubreddits"),a(t.get.data.children[t.get.data.children.length-1].data.name,o)))})}function c(r){console.log("[rpSubredditsUtilService] loadDefaultSubreddits()"),t.get({limit:m},function(t){t.responseError?(n("Something went wrong updating your subreddits."),r(t,null)):(console.log("[rpSubredditsUtilService] loadDefaultSubreddits(), data.get.data.children.length: "+t.get.data.children.length),g.subs=t.get.data.children,e.$emit("subreddits_updated"),u(),r(null,t))})}function p(e){if("undefined"==typeof e&&(e=g.currentSub),console.log("[rpSubredditsUtilService] isSubscribed, rpSubredditsUtilService.subs.length: "+g.subs.length),g.subs.length>0&&""!==e){for(var t=0;t<g.subs.length;t++)if(g.subs[t].data.display_name.toLowerCase()===e.toLowerCase())return console.log("[rpSubredditsUtilService] isSubscribed(), true"),!0;return console.log("[rpSubredditsUtilService] isSubscribed(), false"),!1}return console.log("[rpSubredditsUtilService] isSubscribed(), returning null, rpSubredditsUtilService.subs.length: "+g.subs.length+", sub: "+e),null}function u(){console.log("[rpSubredditsUtilService] updateSubscriptionStatus(), "+g.subs.length+", "+g.currentSub);var t=g.subscribed;g.subscribed=p(),g.subscribed!==t&&(console.log("[rpSubredditsUtilService] updateSubscriptionStatus(), subscription status changed, emit subscription_status_changed, rpSubredditsUtilService.subscribed: "+g.subscribed),e.$emit("subscription_status_changed",g.subscribed))}function d(){console.log("[rpSubredditsUtilService] loadSubredditAbout()"),i.get({sub:g.currentSub},function(t){t.responseError?console.log("[rpSubredditsUtilService] loadSubredditsAbout(), err"):(console.log("[rpSubredditsUtilService] loadSubredditsAbout, data.data.name: "+t.data.name),g.about=t,e.$emit("subreddits_about_updated"))})}var g={};g.subs=[],g.currentSub="",g.about={},g.subscribed=null;var m=100;return g.updateSubreddits=function(e){console.log("[rpSubredditsUtilService] updateSubreddits(), rpAuthUtilService.isAuthenticated: "+s.isAuthenticated),s.isAuthenticated?l(e):c(e)},g.updateSubreddits(function(){if(s.isAuthenticated){for(var e=!1,t="t5_3cawe",r=0;r<g.subs.length;r++)g.subs[r].data.name===t&&(e=!0);e||g.subscribe("sub",t,function(){console.log("[rpSubredditsUtilService] subscribed user to r/reddupco")})}}),g.resetSubreddit=function(){g.currentSub="",g.subscribed=null,g.about={}},g.setSubreddit=function(e){console.log("[rpSubredditsUtilService] setSubreddit, sub: "+e),e&&g.currentSub!==e&&(g.currentSub=e,u(),d())},g.subscribeCurrent=function(e){console.log("[rpSubredditsUtilService] subscribeCurrent(), currentSub: "+g.currentSub);var t=g.subscribed?"unsub":"sub";o.save({action:t,sr:g.about.data.name},function(t){t.responseError?(console.log("[rpSubredditsUtilService] err"),e(t,null)):g.updateSubreddits(function(t,r){t?(console.log("[rpSubredditsUtilService] err"),e(r,null)):e(null,r)})})},g.subscribe=function(e,t,r){console.log("[rpSubredditsUtilService], subscribe(), action: "+e+", name: "+t),s.isAuthenticated?o.save({action:e,sr:t},function(e){e.responseError?console.log("[rpSubredditsUtilService] err"):g.updateSubreddits(function(e,t){e?(console.log("[rpSubredditsUtilService] err"),r(t,null)):r(null,t)})}):n("You've got to log in to subscribed to subreddits")},g.isSubscribed=function(e){return console.log("[rpSubredditsUtilService] isSubscribed(), sub: "+e),p(e)},g}]),rpUtilServices.factory("rpPostsUtilService",["$rootScope","rpPostsResourceService","rpFrontpageResourceService","rpToastUtilService","rpLocationUtilService",function(e,t,r,o,i){return function(e,s,n,l,a,c){console.log("[rpPostsUtilService] request posts."),e?t.get({sub:e,sort:s,after:n,t:l,limit:a},function(e){if(console.log("[rpPostsUtilService] data: "+e),e.responseError)if(console.log("[rpPostsUtilService] error data: "+JSON.stringify(e)),302===e.status){var t=/https:\/\/oauth\.reddit\.com\/r\/([\w]+)*/i,r=t.exec(e.body);r[1]&&i(null,"/r/"+r[1],"",!0,!0)}else o("Something went wrong retrieving posts :/"),i(null,"/error/"+e.status,"",!0,!0);else c(null,e)}):r.get({sort:s,after:n,t:l,limit:a},function(e){e.responseError?(o("Something went wrong retrieving posts :/"),i(null,"/error/"+e.status,"",!0,!0)):c(null,e)})}}]),rpUtilServices.factory("rpMessageUtilService",["rpMessageResourceService","rpToastUtilService",function(e,t){return function(r,o,i,s){console.log("[rpMessageUtilService] request messages."),e.get({where:r,after:o,limit:i},function(e){e.responseError?(t("Something went wrong retrieving your messages :/"),s(e,null)):s(null,e)})}}]),rpUtilServices.factory("rpCommentsUtilService",["rpCommentsResourceService",function(e){return function(t,r,o,i,s,n){console.log("[rpCommentsUtilService] request comments"),e.get({subreddit:t,article:r,sort:o,comment:i,context:s},function(e){e.responseError?n(e,null):n(null,e)})}}]),rpUtilServices.factory("rpMoreChildrenUtilService",["rpMoreChildrenResourceService",function(e){return function(t,r,o,i){console.log("[rpMoreChildrenUtilService] request more children"),e.get({sort:t,link_id:r,children:o},function(e){e.responseError?i(e,null):i(null,e)})}}]),rpUtilServices.factory("rpUserUtilService",["rpUserResourceService","rpToastUtilService",function(e,t){return function(r,o,i,s,n,l,a){console.log("[rpUserUtilService] request user"),e.get({username:r,where:o,sort:i,after:s,t:n,limit:l},function(e){e.responseError?(t("Something went wrong retrieving the user's posts :/"),a(e,null)):a(null,e)})}}]),rpUtilServices.factory("rpByIdUtilService",["rpByIdResourceService",function(e){return function(t,r){e.get({name:t},function(e){e.responseError?r(e,null):r(null,e)})}}]),rpUtilServices.factory("rpReadAllMessagesUtilService",["$timeout","rpReadAllMessagesResourceService",function(e,t){return function(r){function o(){i>0&&e(t.save({},function(e){e.responseError?(i-=1,o(),r(e,null)):(i=3,r(null,e))}),10*s-i)}var i=9,s=2e3;o()}}]),rpUtilServices.factory("rpReadMessageUtilService",["rpReadMessageResourceService",function(e){return function(t,r){e.save({message:t},function(e){e.responseError?(console.log("[rpReadMessageUtilService] err"),r(e,null)):r(null,e)})}}]),rpUtilServices.factory("rpToolbarShadowUtilService",["$rootScope",function(e){var t={};return t.showToolbarShadow=!1,t.show=function(){console.log("[rpToolbarShadowUtilService] show()"),t.showToolbarShadow=!0,e.$broadcast("show_toolbar_shadow_change")},t.hide=function(){console.log("[rpToolbarShadowUtilService] hide()"),t.showToolbarShadow=!1,e.$broadcast("show_toolbar_shadow_change")},t}]);